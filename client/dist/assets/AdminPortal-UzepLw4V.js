import{r as i,j as e,R as Ys,k as Js,f as Ks,h as he}from"./vendor-react-DZU2lOjX.js";import{s as xt,D as Xs,a as Zs,E as er,A as tr,G as sr,C as rr}from"./Portal-B5LUEaqQ.js";import{A as hs,T as ir,S as ar}from"./LiveMonitoring-CDtMJqc6.js";import{e as oe,X as le,ay as Ae,E as Mt,al as ve,T as pe,au as At,I as Re,an as Le,af as Ze,C as Dt,x as De,ae as Ct,ab as re,F as Be,u as $t,D as Qe,ad as Ue,ax as Fe,c as I,ai as Te,b as is,f as Ce,aA as as,aB as Oe,aC as nr,aD as bs,aE as lr,d as Me,a9 as Se,i as fs,j as Tt,J as $e,P as or,a8 as ys,ac as It,aF as dr,aG as cr,av as mr,K as ns,B as Xe,S as Ve,o as ls,p as pr,aH as xr,g as Ne,aI as os,t as ds,$ as gr,O as ur,a0 as hr,aJ as br,aK as fr,V as ht,a3 as yr,_ as Pt,H as jr,aL as qt,aM as js,U as cs,aN as Et,ag as vr,a6 as wt,ah as rt,l as et,z as mt,aw as Sr,aa as Vt,M as Cr,h as Gt,am as Nt,s as ms,aO as vs,aP as ps,as as wr}from"./vendor-misc-D7KlG0WG.js";import{R as it,B as Ot,C as bt,X as ft,Y as yt,T as at,b as St,A as Ss,a as Cs,P as ws,c as ks,d as zs,L as kr}from"./vendor-charts-DyrUJrah.js";import{a as zr}from"./SkillSubmissions-Dd-6kOYN.js";import{u as As,a as Ts}from"./index-Dce4qVRW.js";function Ar({initialTestCases:t=[],onUpdate:j,onClose:W,title:N="Coding Problem",inputLabel:y="Sample Input",outputLabel:b="Sample Output"}){const[x,k]=i.useState([]),[f,u]=i.useState({input:"",expectedOutput:"",isHidden:!1,points:10,description:""}),[c,d]=i.useState(!1),[n,E]=i.useState(null),[D,g]=i.useState({});i.useEffect(()=>{const w=t.map((L,$)=>({...L,_id:L._id||L.id||`temp-${Date.now()}-${$}`}));k(w)},[t]);const S=w=>{k(w),j(w)},A=()=>{if(!f.input&&!f.expectedOutput)return;const w={...f,_id:`temp-${Date.now()}`},L=[...x,w];S(L),u({input:"",expectedOutput:"",isHidden:!1,points:10,description:""}),d(!1)},C=w=>{const L=x.map($=>$._id===w?{...$,...D}:$);S(L),E(null)},o=w=>{if(window.confirm("Delete this test case?")){const L=x.filter($=>$._id!==w);S(L)}},M=w=>{E(w._id),g({input:w.input||"",expectedOutput:w.expectedOutput||"",isHidden:w.isHidden||!1,points:w.points||10,description:w.description||""})};return e.jsx("div",{className:"modal-overlay",onClick:W,style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0,0,0,0.5)",backdropFilter:"blur(5px)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:2e3},children:e.jsxs("div",{className:"modal-content",onClick:w=>w.stopPropagation(),style:{width:"900px",maxWidth:"95vw",maxHeight:"85vh",background:"#1e293b",borderRadius:"16px",border:"1px solid rgba(139,92,246,0.2)",display:"flex",flexDirection:"column",overflow:"hidden",boxShadow:"0 25px 50px rgba(0,0,0,0.5)"},children:[e.jsxs("div",{className:"modal-header",style:{padding:"1.5rem",background:"rgba(15, 23, 42, 0.95)",borderBottom:"1px solid rgba(255,255,255,0.05)",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"1rem"},children:[e.jsx("div",{style:{width:"40px",height:"40px",borderRadius:"10px",background:"linear-gradient(135deg, #10b981, #059669)",display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsx(oe,{size:20,color:"white"})}),e.jsxs("div",{children:[e.jsx("h2",{style:{margin:0,fontSize:"1.2rem",color:"white"},children:"Test Cases Manager"}),e.jsx("p",{style:{margin:"0.25rem 0 0",fontSize:"0.85rem",color:"rgba(255,255,255,0.5)"},children:N})]})]}),e.jsx("button",{onClick:W,style:{background:"transparent",border:"none",color:"rgba(255,255,255,0.5)",cursor:"pointer"},children:e.jsx(le,{size:24})})]}),e.jsxs("div",{className:"modal-body",style:{flex:1,overflowY:"auto",padding:"1.5rem",color:"white"},children:[e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(3, 1fr)",gap:"1rem",marginBottom:"1.5rem"},children:[e.jsxs("div",{style:{background:"rgba(59, 130, 246, 0.1)",padding:"1rem",borderRadius:"10px",textAlign:"center"},children:[e.jsx("div",{style:{fontSize:"1.5rem",fontWeight:700,color:"#3b82f6"},children:x.length}),e.jsx("div",{style:{fontSize:"0.8rem",color:"rgba(255,255,255,0.6)"},children:"Total Test Cases"})]}),e.jsxs("div",{style:{background:"rgba(16, 185, 129, 0.1)",padding:"1rem",borderRadius:"10px",textAlign:"center"},children:[e.jsx("div",{style:{fontSize:"1.5rem",fontWeight:700,color:"#10b981"},children:x.filter(w=>!w.isHidden).length}),e.jsx("div",{style:{fontSize:"0.8rem",color:"rgba(255,255,255,0.6)"},children:"Visible"})]}),e.jsxs("div",{style:{background:"rgba(239, 68, 68, 0.1)",padding:"1rem",borderRadius:"10px",textAlign:"center"},children:[e.jsx("div",{style:{fontSize:"1.5rem",fontWeight:700,color:"#ef4444"},children:x.filter(w=>w.isHidden).length}),e.jsx("div",{style:{fontSize:"0.8rem",color:"rgba(255,255,255,0.6)"},children:"Hidden"})]})]}),!c&&e.jsxs("button",{onClick:()=>d(!0),style:{width:"100%",padding:"1rem",background:"rgba(59, 130, 246, 0.1)",border:"2px dashed rgba(59, 130, 246, 0.3)",borderRadius:"10px",color:"#3b82f6",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",gap:"0.5rem",fontSize:"0.9rem",fontWeight:600,marginBottom:"1.5rem"},children:[e.jsx(Ae,{size:18})," Add Test Case"]}),c&&e.jsxs("div",{style:{background:"rgba(0,0,0,0.2)",border:"1px solid rgba(255,255,255,0.1)",borderRadius:"12px",padding:"1.5rem",marginBottom:"1.5rem"},children:[e.jsxs("h4",{style:{margin:"0 0 1rem",display:"flex",alignItems:"center",gap:"0.5rem",color:"white"},children:[e.jsx(Ae,{size:16})," New Test Case"]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"1rem",marginBottom:"1rem"},children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",style:{display:"block",marginBottom:"0.5rem",fontSize:"0.85rem",color:"rgba(255,255,255,0.7)"},children:y}),e.jsx("textarea",{rows:"3",placeholder:"Enter test input...",value:f.input,onChange:w=>u({...f,input:w.target.value}),style:{width:"100%",padding:"0.5rem",background:"#0f172a",border:"1px solid rgba(255,255,255,0.1)",borderRadius:"6px",color:"white",fontFamily:"monospace",fontSize:"0.85rem"}})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",style:{display:"block",marginBottom:"0.5rem",fontSize:"0.85rem",color:"rgba(255,255,255,0.7)"},children:b}),e.jsx("textarea",{rows:"3",placeholder:"Enter expected output...",value:f.expectedOutput,onChange:w=>u({...f,expectedOutput:w.target.value}),style:{width:"100%",padding:"0.5rem",background:"#0f172a",border:"1px solid rgba(255,255,255,0.1)",borderRadius:"6px",color:"white",fontFamily:"monospace",fontSize:"0.85rem"}})]})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"2fr 1fr 1fr",gap:"1rem",marginBottom:"1rem"},children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",style:{display:"block",marginBottom:"0.5rem",fontSize:"0.85rem",color:"rgba(255,255,255,0.7)"},children:"Description (optional)"}),e.jsx("input",{type:"text",placeholder:"e.g., Edge case with empty array",value:f.description,onChange:w=>u({...f,description:w.target.value}),style:{width:"100%",padding:"0.5rem",background:"#0f172a",border:"1px solid rgba(255,255,255,0.1)",borderRadius:"6px",color:"white"}})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",style:{display:"block",marginBottom:"0.5rem",fontSize:"0.85rem",color:"rgba(255,255,255,0.7)"},children:"Points"}),e.jsx("input",{type:"number",min:"1",max:"100",value:f.points,onChange:w=>u({...f,points:parseInt(w.target.value)||10}),style:{width:"100%",padding:"0.5rem",background:"#0f172a",border:"1px solid rgba(255,255,255,0.1)",borderRadius:"6px",color:"white"}})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",style:{display:"block",marginBottom:"0.5rem",fontSize:"0.85rem",color:"rgba(255,255,255,0.7)"},children:"Visibility"}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.75rem",marginTop:"0.5rem"},children:[e.jsx("input",{type:"checkbox",id:"isHidden",checked:f.isHidden,onChange:w=>u({...f,isHidden:w.target.checked}),style:{width:"18px",height:"18px",accentColor:"#ef4444"}}),e.jsxs("label",{htmlFor:"isHidden",style:{cursor:"pointer",fontSize:"0.9rem",display:"flex",alignItems:"center",gap:"0.5rem",color:"white"},children:[f.isHidden?e.jsx(Mt,{size:16,color:"#ef4444"}):e.jsx(ve,{size:16,color:"#10b981"}),f.isHidden?"Hidden":"Visible"]})]})]})]}),e.jsxs("div",{style:{display:"flex",gap:"0.75rem",justifyContent:"flex-end"},children:[e.jsx("button",{onClick:()=>d(!1),style:{padding:"0.5rem 1rem",background:"rgba(255,255,255,0.1)",border:"none",borderRadius:"6px",color:"rgba(255,255,255,0.6)",cursor:"pointer"},children:"Cancel"}),e.jsxs("button",{onClick:A,style:{padding:"0.5rem 1rem",background:"#8b5cf6",border:"none",borderRadius:"6px",color:"white",cursor:"pointer",display:"flex",alignItems:"center",gap:"0.5rem"},children:[e.jsx(Ae,{size:16})," Add Test Case"]})]})]}),x.length===0?e.jsxs("div",{style:{textAlign:"center",padding:"3rem",color:"rgba(255,255,255,0.4)"},children:[e.jsx(pe,{size:48,style:{marginBottom:"1rem",opacity:.5}}),e.jsx("h3",{children:"No Test Cases"}),e.jsx("p",{children:"Add test cases to enable automated grading"})]}):e.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"1rem"},children:x.map((w,L)=>e.jsx("div",{style:{background:"rgba(0,0,0,0.2)",border:`1px solid ${w.isHidden?"rgba(239, 68, 68, 0.3)":"rgba(255,255,255,0.1)"}`,borderRadius:"10px",padding:"1rem",position:"relative"},children:n===w._id?e.jsxs("div",{children:[e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"1rem",marginBottom:"1rem"},children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",style:{display:"block",marginBottom:"0.5rem",fontSize:"0.85rem",color:"rgba(255,255,255,0.7)"},children:y}),e.jsx("textarea",{rows:"3",value:D.input,onChange:$=>g({...D,input:$.target.value}),style:{width:"100%",padding:"0.5rem",background:"#0f172a",border:"1px solid rgba(255,255,255,0.1)",borderRadius:"6px",color:"white",fontFamily:"monospace",fontSize:"0.85rem"}})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",style:{display:"block",marginBottom:"0.5rem",fontSize:"0.85rem",color:"rgba(255,255,255,0.7)"},children:b}),e.jsx("textarea",{rows:"3",value:D.expectedOutput,onChange:$=>g({...D,expectedOutput:$.target.value}),style:{width:"100%",padding:"0.5rem",background:"#0f172a",border:"1px solid rgba(255,255,255,0.1)",borderRadius:"6px",color:"white",fontFamily:"monospace",fontSize:"0.85rem"}})]})]}),e.jsxs("div",{style:{display:"flex",gap:"0.75rem",justifyContent:"flex-end"},children:[e.jsx("button",{onClick:()=>E(null),style:{padding:"0.4rem 0.75rem",background:"rgba(255,255,255,0.1)",border:"none",borderRadius:"6px",color:"rgba(255,255,255,0.6)",cursor:"pointer"},children:"Cancel"}),e.jsxs("button",{onClick:()=>C(w._id),style:{padding:"0.4rem 0.75rem",background:"#10b981",border:"none",borderRadius:"6px",color:"white",cursor:"pointer",display:"flex",alignItems:"center",gap:"0.5rem"},children:[e.jsx(At,{size:14})," Save"]})]})]}):e.jsxs("div",{children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"0.75rem"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.75rem"},children:[e.jsx("span",{style:{width:"24px",height:"24px",background:"rgba(139,92,246,0.2)",color:"#a78bfa",borderRadius:"50%",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"0.75rem",fontWeight:700},children:L+1}),e.jsx("span",{style:{fontWeight:600,color:"white"},children:w.description||`Test Case ${L+1}`}),e.jsxs("span",{style:{padding:"2px 8px",borderRadius:"12px",fontSize:"0.7rem",fontWeight:600,background:w.isHidden?"rgba(239, 68, 68, 0.15)":"rgba(16, 185, 129, 0.15)",color:w.isHidden?"#ef4444":"#10b981",display:"flex",alignItems:"center",gap:"4px"},children:[w.isHidden?e.jsx(Mt,{size:10}):e.jsx(ve,{size:10}),w.isHidden?"Hidden":"Visible"]}),e.jsxs("span",{style:{padding:"2px 8px",borderRadius:"12px",fontSize:"0.7rem",fontWeight:600,background:"rgba(251, 191, 36, 0.15)",color:"#fbbf24"},children:[w.points," pts"]})]}),e.jsxs("div",{style:{display:"flex",gap:"0.5rem"},children:[e.jsx("button",{onClick:()=>M(w),style:{padding:"0.4rem",background:"rgba(59, 130, 246, 0.1)",border:"none",borderRadius:"6px",color:"#3b82f6",cursor:"pointer"},children:e.jsx(Re,{size:14})}),e.jsx("button",{onClick:()=>o(w._id),style:{padding:"0.4rem",background:"rgba(239, 68, 68, 0.1)",border:"none",borderRadius:"6px",color:"#ef4444",cursor:"pointer"},children:e.jsx(Le,{size:14})})]})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"1rem"},children:[e.jsxs("div",{children:[e.jsxs("div",{style:{fontSize:"0.75rem",color:"rgba(255,255,255,0.5)",marginBottom:"0.25rem"},children:[y,":"]}),e.jsx("code",{style:{display:"block",padding:"0.5rem",background:"#0f172a",borderRadius:"6px",fontSize:"0.8rem",whiteSpace:"pre-wrap",maxHeight:"80px",overflow:"auto",color:"rgba(255,255,255,0.9)"},children:w.input||"(empty)"})]}),e.jsxs("div",{children:[e.jsxs("div",{style:{fontSize:"0.75rem",color:"rgba(255,255,255,0.5)",marginBottom:"0.25rem"},children:[b,":"]}),e.jsx("code",{style:{display:"block",padding:"0.5rem",background:"#0f172a",borderRadius:"6px",fontSize:"0.8rem",color:"#4ade80",whiteSpace:"pre-wrap",maxHeight:"80px",overflow:"auto"},children:w.expectedOutput})]})]})]})},w._id))})]})]})})}function Tr({user:t}){const[j,W]=i.useState([]),[N,y]=i.useState([]),[b,x]=i.useState({totalStudentsActive:[],totalMentorsActive:[],activeSubmissions:[],totalAlerts:0,criticalAlerts:0}),[k,f]=i.useState(!1);i.useEffect(()=>(xt.joinMonitoring(t.id,"admin"),f(!0),xt.onMonitoringConnected(d=>{console.log("âœ… Admin joined global monitoring:",d)}),xt.onLiveUpdate(d=>{W(n=>[d,...n.slice(0,99)]),x(n=>{const E=n.totalStudentsActive.includes(d.studentId)?n.totalStudentsActive:[...n.totalStudentsActive,d.studentId],D=d.mentorId&&!n.totalMentorsActive.includes(d.mentorId)?[...n.totalMentorsActive,d.mentorId]:n.totalMentorsActive;let g=n.activeSubmissions;return d.type==="submission_started"&&!n.activeSubmissions.includes(d.studentId)?g=[...n.activeSubmissions,d.studentId]:d.type==="submission_completed"&&(g=n.activeSubmissions.filter(S=>S!==d.studentId)),{...n,totalStudentsActive:E,totalMentorsActive:D,activeSubmissions:g}})}),xt.onLiveAlert(d=>{y(n=>[d,...n.slice(0,49)]),x(n=>({...n,totalAlerts:n.totalAlerts+1,criticalAlerts:n.criticalAlerts+(d.severity==="critical"?1:0)}))}),()=>{xt.disconnect(),f(!1)}),[t.id]);const u=d=>{switch(d){case"submission_started":return e.jsx(De,{className:"w-4 h-4 text-blue-500"});case"submission_completed":return"âœ…";case"progress_update":return"â±ï¸";case"test_failed":return"âŒ";default:return"ðŸ“Š"}},c=d=>new Date(d).toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit",second:"2-digit"});return e.jsxs("div",{className:"live-monitoring-container",children:[e.jsx("h2",{className:"text-2xl font-bold mb-6",children:"ðŸ›¡ï¸ Global Live Monitoring Dashboard"}),e.jsxs("div",{className:"status-bar",children:[e.jsxs("div",{className:`status-item ${k?"active":"inactive"}`,children:[e.jsx("div",{className:"status-dot"}),e.jsx("span",{children:k?"Global Monitoring Active":"Not Monitoring"})]}),e.jsxs("div",{className:"status-item",children:[e.jsx(Ze,{size:16,className:"text-blue-500"}),e.jsx("span",{className:"font-semibold text-blue-600",children:b.activeSubmissions.length}),e.jsx("span",{className:"ml-1",children:"Students Working"})]}),e.jsxs("div",{className:"status-item",children:[e.jsx(Dt,{size:16,className:"text-cyan-500"}),e.jsx("span",{className:"font-semibold text-cyan-600",children:b.totalStudentsActive.length}),e.jsx("span",{className:"ml-1",children:"Total Visited"})]}),e.jsxs("div",{className:"status-item",children:[e.jsx(Dt,{size:16,className:"text-purple-500"}),e.jsx("span",{className:"font-semibold text-purple-600",children:b.totalMentorsActive.length}),e.jsx("span",{className:"ml-1",children:"Active Mentors"})]}),e.jsxs("div",{className:"status-item",children:[e.jsx(pe,{size:16,className:"text-red-500"}),e.jsx("span",{className:"font-semibold text-red-600",children:b.totalAlerts}),e.jsx("span",{className:"ml-1",children:"Total Alerts"})]}),e.jsxs("div",{className:"status-item",children:[e.jsx(pe,{size:16,className:"text-orange-600"}),e.jsx("span",{className:"font-semibold text-orange-600",children:b.criticalAlerts}),e.jsx("span",{className:"ml-1",children:"Critical"})]})]}),e.jsxs("div",{className:"flex gap-6 mt-6",children:[e.jsxs("div",{className:"flex-1 max-w-lg",children:[e.jsxs("h3",{className:"text-lg font-semibold mb-4 flex items-center gap-2",children:[e.jsx(pe,{size:20,className:"text-red-500"}),"Critical Alerts (",b.criticalAlerts,")"]}),e.jsx("div",{className:"alerts-list admin-alerts",children:N.filter(d=>d.severity==="critical").length===0?e.jsx("div",{className:"empty-state",children:"No critical alerts"}):N.filter(d=>d.severity==="critical").map((d,n)=>e.jsxs("div",{className:"alert-item severity-critical",children:[e.jsx("div",{className:"alert-header",children:e.jsxs("span",{className:"font-semibold text-red-900",children:["ðŸš¨ ",d.studentName||`Student ${d.studentId}`," - ",(d.violationType||"unknown").replace(/_/g," ")]})}),e.jsx("div",{className:"alert-time",children:c(d.timestamp)})]},n))})]}),e.jsxs("div",{className:"flex-1 max-w-lg",children:[e.jsxs("h3",{className:"text-lg font-semibold mb-4 flex items-center gap-2",children:[e.jsx(pe,{size:20,className:"text-orange-500"}),"All Alerts (",N.length,")"]}),e.jsx("div",{className:"alerts-list admin-alerts",children:N.length===0?e.jsx("div",{className:"empty-state",children:"No alerts"}):N.map((d,n)=>e.jsxs("div",{className:`alert-item severity-${d.severity}`,children:[e.jsxs("div",{className:"alert-header",children:[e.jsxs("span",{className:"font-semibold",children:[d.studentName||`Student ${d.studentId}`," - ",(d.violationType||"unknown").replace(/_/g," ")]}),e.jsx("span",{className:`severity-badge severity-${d.severity}`,children:d.severity})]}),e.jsx("div",{className:"alert-time",children:c(d.timestamp)})]},n))})]})]}),e.jsxs("div",{className:"mt-6",children:[e.jsxs("h3",{className:"text-lg font-semibold mb-4 flex items-center gap-2",children:[e.jsx(De,{size:20,className:"text-blue-500"}),"Global Activity Feed (",j.length,")"]}),e.jsx("div",{className:"updates-list admin-updates",children:j.length===0?e.jsx("div",{className:"empty-state",children:"Waiting for activity..."}):j.map((d,n)=>e.jsxs("div",{className:`update-item type-${d.type}`,children:[e.jsx("div",{className:"update-icon",children:u(d.type)}),e.jsx("div",{className:"update-content",children:e.jsxs("div",{className:"update-title",children:[d.type==="submission_started"&&e.jsxs("span",{children:[e.jsx("strong",{children:d.studentName||`Student ${d.studentId}`})," started",e.jsxs("strong",{children:[" ",d.problemTitle]}),d.isProctored&&e.jsx("span",{className:"badge-proctored",children:"Proctored"})]}),d.type==="submission_completed"&&e.jsxs("span",{children:[e.jsx("strong",{children:d.studentName||`Student ${d.studentId}`})," completed",e.jsxs("strong",{children:[" ",d.problemTitle]}),e.jsx("span",{className:`badge-status status-${d.status}`,children:d.status})]}),d.type==="progress_update"&&e.jsxs("span",{children:[e.jsx("strong",{children:d.studentName||`Student ${d.studentId}`})," -",e.jsxs("strong",{children:[" ",d.problemId]}),e.jsxs("span",{className:"badge-progress",children:[d.progress,"%"]})]}),d.type==="test_failed"&&e.jsxs("span",{children:[e.jsx("strong",{children:d.studentName||`Student ${d.studentId}`})," - Test failed:",e.jsxs("strong",{children:[" ",d.testname]})]})]})}),e.jsx("div",{className:"update-time",children:c(d.timestamp)})]},n))})]}),e.jsx("style",{children:`
                .admin-alerts {
                    max-height: 400px;
                }
                
                .admin-updates {
                    max-height: 500px;
                }

                .severity-badge.severity-critical {
                    background: #dc2626;
                    color: white;
                    font-size: 0.75rem;
                    padding: 0.25rem 0.75rem;
                    border-radius: 9999px;
                }

                .severity-badge.severity-warning {
                    background: #f59e0b;
                    color: white;
                    font-size: 0.75rem;
                    padding: 0.25rem 0.75rem;
                    border-radius: 9999px;
                }
            `})]})}const me="http://localhost:3000/api",xs=["#3b82f6","#8b5cf6","#06b6d4","#10b981","#f59e0b","#ef4444","#ec4899","#14b8a6"],ae={background:"var(--bg-card)",border:"1px solid var(--border-color)",borderRadius:"16px",padding:"1.5rem",transition:"all 0.3s ease"},He={padding:"0.6rem 1.2rem",borderRadius:"10px",border:"none",background:"linear-gradient(135deg, #3b82f6, #8b5cf6)",color:"white",fontWeight:600,cursor:"pointer",fontSize:"0.85rem",display:"flex",alignItems:"center",gap:"0.5rem",transition:"all 0.2s ease"},Ge={...He,background:"rgba(59, 130, 246, 0.1)",color:"#3b82f6",border:"1px solid rgba(59, 130, 246, 0.3)"},Yt={...He,background:"linear-gradient(135deg, #ef4444, #dc2626)"},ct={width:"100%",padding:"0.7rem 1rem",borderRadius:"10px",border:"1px solid var(--border-color)",background:"var(--bg-card)",color:"var(--text)",fontSize:"0.85rem",outline:"none"},kt={...ct,cursor:"pointer"},Ft=t=>({padding:"0.7rem 1.5rem",borderRadius:"10px",border:t?"none":"1px solid var(--border-color)",background:t?"linear-gradient(135deg, #3b82f6, #8b5cf6)":"transparent",color:t?"white":"var(--text-muted)",fontWeight:600,cursor:"pointer",fontSize:"0.85rem",transition:"all 0.2s ease",display:"flex",alignItems:"center",gap:"0.5rem"}),Ee=t=>({padding:"0.25rem 0.75rem",borderRadius:"20px",fontSize:"0.7rem",fontWeight:600,background:`${t}20`,color:t,display:"inline-flex",alignItems:"center",gap:"0.3rem"}),nt={display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:"1.5rem"},Qt={position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0, 0, 0, 0.7)",backdropFilter:"blur(4px)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3},Ut={background:"var(--bg-card)",borderRadius:"20px",padding:"2rem",maxWidth:"700px",width:"95%",maxHeight:"85vh",overflowY:"auto",border:"1px solid var(--border-color)",boxShadow:"0 25px 50px rgba(0,0,0,0.3)"};function zt({status:t}){const W={healthy:"#10b981",warning:"#f59e0b",degraded:"#f59e0b",error:"#ef4444",down:"#ef4444",completed:"#10b981",running:"#3b82f6",failed:"#ef4444",pending:"#f59e0b",passed:"#10b981"}[t]||"#6b7280",N={healthy:e.jsx(oe,{size:12}),completed:e.jsx(oe,{size:12}),passed:e.jsx(oe,{size:12}),warning:e.jsx(pe,{size:12}),degraded:e.jsx(pe,{size:12}),error:e.jsx(Me,{size:12}),down:e.jsx(Me,{size:12}),failed:e.jsx(Me,{size:12}),running:e.jsx(De,{size:12}),pending:e.jsx(Ce,{size:12})};return e.jsxs("span",{style:Ee(W),children:[N[t],t]})}function Ir(){const[t,j]=i.useState("health"),W=[{id:"health",label:"System Health",icon:e.jsx(De,{size:16})},{id:"bulk",label:"Bulk Operations",icon:e.jsx(re,{size:16})},{id:"audit",label:"Audit Logs",icon:e.jsx(Be,{size:16})},{id:"templates",label:"Templates",icon:e.jsx($t,{size:16})},{id:"backups",label:"Backups",icon:e.jsx(Qe,{size:16})},{id:"export",label:"Data Export",icon:e.jsx(Ue,{size:16})},{id:"analytics",label:"Analytics",icon:e.jsx(Fe,{size:16})}];return e.jsxs("div",{className:"animate-fadeIn",children:[e.jsxs("div",{style:{background:"linear-gradient(135deg, rgba(59, 130, 246, 0.1) 0%, rgba(139, 92, 246, 0.1) 50%, rgba(6, 182, 212, 0.05) 100%)",borderRadius:"20px",padding:"2rem 2.5rem",marginBottom:"1.5rem",border:"1px solid rgba(59, 130, 246, 0.2)",position:"relative",overflow:"hidden"},children:[e.jsx("div",{style:{position:"absolute",top:"-50%",right:"-10%",width:"400px",height:"400px",background:"radial-gradient(circle, rgba(139, 92, 246, 0.15) 0%, transparent 70%)",pointerEvents:"none"}}),e.jsxs("div",{style:{position:"relative",zIndex:1,display:"flex",alignItems:"center",gap:"1rem"},children:[e.jsx("div",{style:{width:"52px",height:"52px",borderRadius:"14px",background:"linear-gradient(135deg, #3b82f6, #8b5cf6)",display:"flex",alignItems:"center",justifyContent:"center",boxShadow:"0 8px 24px rgba(59, 130, 246, 0.3)"},children:e.jsx(Ct,{size:26,color:"white"})}),e.jsxs("div",{children:[e.jsx("h1",{style:{margin:0,fontSize:"1.6rem",fontWeight:800,background:"linear-gradient(135deg, #fff, #94a3b8)",WebkitBackgroundClip:"text",WebkitTextFillColor:"transparent"},children:"Admin Operations Center"}),e.jsx("p",{style:{margin:0,color:"var(--text-muted)",fontSize:"0.85rem"},children:"System health, bulk operations, audit logs, backups & analytics"})]})]})]}),e.jsx("div",{style:{display:"flex",gap:"0.5rem",marginBottom:"1.5rem",flexWrap:"wrap",padding:"0.5rem",background:"var(--bg-card)",borderRadius:"14px",border:"1px solid var(--border-color)"},children:W.map(N=>e.jsxs("button",{onClick:()=>j(N.id),style:Ft(t===N.id),children:[N.icon," ",N.label]},N.id))}),t==="health"&&e.jsx(Nr,{}),t==="bulk"&&e.jsx(Rr,{}),t==="audit"&&e.jsx(Lr,{}),t==="templates"&&e.jsx(Br,{}),t==="backups"&&e.jsx(_r,{}),t==="export"&&e.jsx(Wr,{}),t==="analytics"&&e.jsx(Pr,{})]})}function Nr(){const[t,j]=i.useState(null),[W,N]=i.useState(!0),[y,b]=i.useState(!1),x=i.useCallback(async()=>{try{const f=await I.get(`${me}/admin/system-health`);j(f.data)}catch(f){console.error("Health check failed:",f)}finally{N(!1)}},[]);if(i.useEffect(()=>{if(x(),y){const f=setInterval(x,1e4);return()=>clearInterval(f)}},[x,y]),W)return e.jsx("div",{className:"loading-spinner"});if(!t)return e.jsx("div",{style:{color:"var(--text-muted)",textAlign:"center",padding:"3rem"},children:"Failed to load system health"});const k=t.status==="healthy"?"#10b981":t.status==="warning"?"#f59e0b":"#ef4444";return e.jsxs("div",{children:[e.jsxs("div",{style:nt,children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"1rem"},children:[e.jsx("h2",{style:{margin:0,color:"var(--text)",fontSize:"1.2rem"},children:"System Health Monitor"}),e.jsx(zt,{status:t.status})]}),e.jsxs("div",{style:{display:"flex",gap:"0.5rem",alignItems:"center"},children:[e.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"0.4rem",color:"var(--text-muted)",fontSize:"0.8rem",cursor:"pointer"},children:[e.jsx("input",{type:"checkbox",checked:y,onChange:f=>b(f.target.checked)}),"Auto-refresh (10s)"]}),e.jsxs("button",{onClick:x,style:Ge,children:[e.jsx(Te,{size:14})," Refresh"]})]})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(4, 1fr)",gap:"1rem",marginBottom:"1.5rem"},children:[e.jsxs("div",{style:{...ae,borderLeft:`4px solid ${k}`},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.75rem"},children:[e.jsx("div",{style:{width:"42px",height:"42px",borderRadius:"12px",background:`${k}20`,display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsx(De,{size:20,color:k})}),e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--text-muted)"},children:"System Status"}),e.jsx("div",{style:{fontSize:"1.2rem",fontWeight:700,color:k,textTransform:"capitalize"},children:t.status})]})]}),e.jsxs("div",{style:{marginTop:"0.75rem",fontSize:"0.7rem",color:"var(--text-muted)"},children:["API Latency: ",t.apiLatency,"ms"]})]}),e.jsxs("div",{style:{...ae,borderLeft:"4px solid #3b82f6"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.75rem"},children:[e.jsx("div",{style:{width:"42px",height:"42px",borderRadius:"12px",background:"rgba(59, 130, 246, 0.1)",display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsx(Qe,{size:20,color:"#3b82f6"})}),e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--text-muted)"},children:"Database"}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[e.jsx(zt,{status:t.database.status}),e.jsxs("span",{style:{fontSize:"0.75rem",color:"var(--text-muted)"},children:[t.database.latency,"ms"]})]})]})]}),e.jsxs("div",{style:{marginTop:"0.75rem",fontSize:"0.7rem",color:"var(--text-muted)"},children:[t.database.tableCount," tables Â· ",t.database.totalSizeMB," MB"]})]}),e.jsxs("div",{style:{...ae,borderLeft:"4px solid #8b5cf6"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.75rem"},children:[e.jsx("div",{style:{width:"42px",height:"42px",borderRadius:"12px",background:"rgba(139, 92, 246, 0.1)",display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsx(is,{size:20,color:"#8b5cf6"})}),e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--text-muted)"},children:"Memory Usage"}),e.jsxs("div",{style:{fontSize:"1.2rem",fontWeight:700,color:"var(--text)"},children:[t.memory.heapUsed," MB"]})]})]}),e.jsxs("div",{style:{marginTop:"0.5rem"},children:[e.jsx("div",{style:{height:"6px",background:"rgba(139, 92, 246, 0.15)",borderRadius:"3px",overflow:"hidden"},children:e.jsx("div",{style:{height:"100%",width:`${t.memory.heapPercent}%`,background:t.memory.heapPercent>80?"#ef4444":"#8b5cf6",borderRadius:"3px",transition:"width 0.5s"}})}),e.jsxs("div",{style:{fontSize:"0.7rem",color:"var(--text-muted)",marginTop:"0.25rem"},children:[t.memory.heapPercent,"% of ",t.memory.heapTotal," MB heap"]})]})]}),e.jsxs("div",{style:{...ae,borderLeft:"4px solid #06b6d4"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.75rem"},children:[e.jsx("div",{style:{width:"42px",height:"42px",borderRadius:"12px",background:"rgba(6, 182, 212, 0.1)",display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsx(Ce,{size:20,color:"#06b6d4"})}),e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--text-muted)"},children:"Uptime"}),e.jsx("div",{style:{fontSize:"1rem",fontWeight:700,color:"var(--text)"},children:t.uptime.formatted})]})]}),e.jsxs("div",{style:{marginTop:"0.75rem",fontSize:"0.7rem",color:"var(--text-muted)"},children:["WebSockets: ",t.websockets.total," connected Â· Node ",t.nodeVersion]})]})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"1rem"},children:[e.jsxs("div",{style:ae,children:[e.jsxs("h3",{style:{margin:"0 0 1rem 0",fontSize:"1rem",color:"var(--text)",display:"flex",alignItems:"center",gap:"0.5rem"},children:[e.jsx(Qe,{size:16,color:"#3b82f6"})," Database Tables"]}),e.jsx("div",{style:{maxHeight:"300px",overflowY:"auto"},children:e.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:"0.8rem"},children:[e.jsx("thead",{children:e.jsxs("tr",{style:{borderBottom:"1px solid var(--border-color)"},children:[e.jsx("th",{style:{textAlign:"left",padding:"0.5rem",color:"var(--text-muted)"},children:"Table"}),e.jsx("th",{style:{textAlign:"right",padding:"0.5rem",color:"var(--text-muted)"},children:"Rows"}),e.jsx("th",{style:{textAlign:"right",padding:"0.5rem",color:"var(--text-muted)"},children:"Size"})]})}),e.jsx("tbody",{children:(t.database.tables||[]).map((f,u)=>e.jsxs("tr",{style:{borderBottom:"1px solid rgba(255,255,255,0.05)"},children:[e.jsx("td",{style:{padding:"0.5rem",color:"var(--text)",fontFamily:"monospace",fontSize:"0.75rem"},children:f.tableName}),e.jsx("td",{style:{padding:"0.5rem",textAlign:"right",color:"var(--text)"},children:(f.rowCount||0).toLocaleString()}),e.jsxs("td",{style:{padding:"0.5rem",textAlign:"right",color:"var(--text-muted)"},children:[f.sizeMB," MB"]})]},u))})]})})]}),e.jsxs("div",{style:ae,children:[e.jsxs("h3",{style:{margin:"0 0 1rem 0",fontSize:"1rem",color:"var(--text)",display:"flex",alignItems:"center",gap:"0.5rem"},children:[e.jsx(as,{size:16,color:"#8b5cf6"})," System Details"]}),e.jsx("div",{style:{display:"grid",gap:"0.75rem"},children:[{label:"Node.js Version",value:t.nodeVersion,icon:e.jsx(Oe,{size:14})},{label:"Platform",value:t.platform,icon:e.jsx(as,{size:14})},{label:"RSS Memory",value:`${t.memory.rss} MB`,icon:e.jsx(is,{size:14})},{label:"External Memory",value:`${t.memory.external} MB`,icon:e.jsx(nr,{size:14})},{label:"Upload Storage",value:`${t.storage.uploadsSizeMB} MB`,icon:e.jsx(bs,{size:14})},{label:"Cache Items",value:t.cache.totalItems,icon:e.jsx(Ze,{size:14})},{label:"WS Mentors Online",value:t.websockets.mentors,icon:e.jsx(lr,{size:14})},{label:"WS Students Online",value:t.websockets.students,icon:e.jsx(re,{size:14})},{label:"WS Admins Online",value:t.websockets.admins,icon:e.jsx(Be,{size:14})},{label:"Recent Errors (24h)",value:t.recentErrors,icon:e.jsx(pe,{size:14})}].map((f,u)=>e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"0.5rem 0.75rem",background:"rgba(255,255,255,0.02)",borderRadius:"8px"},children:[e.jsxs("span",{style:{display:"flex",alignItems:"center",gap:"0.5rem",color:"var(--text-muted)",fontSize:"0.8rem"},children:[f.icon," ",f.label]}),e.jsx("span",{style:{color:"var(--text)",fontWeight:600,fontSize:"0.85rem"},children:f.value})]},u))})]})]})]})}function Rr(){const[t,j]=i.useState("reassign"),[W,N]=i.useState([]),[y,b]=i.useState([]),[x,k]=i.useState([]),[f,u]=i.useState([]),[c,d]=i.useState([]),[n,E]=i.useState(""),[D,g]=i.useState("mark_passed"),[S,A]=i.useState(!0),[C,o]=i.useState(!1),[M,w]=i.useState(null),[L,$]=i.useState("");i.useEffect(()=>{Promise.all([I.get(`${me}/users`),I.get(`${me}/submissions`)]).then(([v,Y])=>{const z=Array.isArray(v.data)?v.data:v.data.users||[];N(z.filter(_=>_.role==="student")),b(z.filter(_=>_.role==="mentor")),k(Array.isArray(Y.data)?Y.data:Y.data.submissions||[]),A(!1)}).catch(()=>A(!1))},[]);const te=async()=>{if(!(f.length===0||!n)){o(!0);try{const v=await I.post(`${me}/admin/bulk/reassign-students`,{studentIds:f,newMentorId:n,adminId:"admin-001",adminName:"Admin"});w({type:"success",message:v.data.message}),u([])}catch(v){w({type:"error",message:v.response?.data?.error||v.message})}o(!1)}},X=async()=>{if(c.length!==0){o(!0);try{const v=await I.post(`${me}/admin/bulk/regrade-submissions`,{submissionIds:c,action:D,adminId:"admin-001",adminName:"Admin"});w({type:"success",message:v.data.message}),d([])}catch(v){w({type:"error",message:v.response?.data?.error||v.message})}o(!1)}},ee=async()=>{if(c.length!==0&&window.confirm(`Delete ${c.length} submissions? This cannot be undone.`)){o(!0);try{const v=await I.post(`${me}/admin/bulk/delete-submissions`,{submissionIds:c,adminId:"admin-001",adminName:"Admin"});w({type:"success",message:v.data.message}),d([]),k(Y=>Y.filter(z=>!c.includes(z.id)))}catch(v){w({type:"error",message:v.response?.data?.error||v.message})}o(!1)}};if(S)return e.jsx("div",{className:"loading-spinner"});const ne=W.filter(v=>v.name?.toLowerCase().includes(L.toLowerCase())||v.email?.toLowerCase().includes(L.toLowerCase()));return e.jsxs("div",{children:[e.jsx("div",{style:nt,children:e.jsxs("h2",{style:{margin:0,color:"var(--text)",fontSize:"1.2rem",display:"flex",alignItems:"center",gap:"0.5rem"},children:[e.jsx(re,{size:20,color:"#3b82f6"})," Bulk Operations"]})}),M&&e.jsxs("div",{style:{padding:"1rem 1.5rem",borderRadius:"12px",marginBottom:"1rem",background:M.type==="success"?"rgba(16, 185, 129, 0.1)":"rgba(239, 68, 68, 0.1)",border:`1px solid ${M.type==="success"?"rgba(16, 185, 129, 0.3)":"rgba(239, 68, 68, 0.3)"}`,color:M.type==="success"?"#10b981":"#ef4444",display:"flex",alignItems:"center",justifyContent:"space-between"},children:[e.jsxs("span",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[M.type==="success"?e.jsx(oe,{size:16}):e.jsx(Me,{size:16}),M.message]}),e.jsx("button",{onClick:()=>w(null),style:{background:"none",border:"none",color:"inherit",cursor:"pointer"},children:e.jsx(le,{size:16})})]}),e.jsxs("div",{style:{display:"flex",gap:"0.5rem",marginBottom:"1.5rem"},children:[e.jsxs("button",{onClick:()=>j("reassign"),style:Ft(t==="reassign"),children:[e.jsx(re,{size:14})," Reassign Students"]}),e.jsxs("button",{onClick:()=>j("regrade"),style:Ft(t==="regrade"),children:[e.jsx(Te,{size:14})," Regrade Submissions"]})]}),t==="reassign"&&e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 350px",gap:"1.5rem"},children:[e.jsxs("div",{style:ae,children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"1rem",marginBottom:"1rem"},children:[e.jsxs("div",{style:{position:"relative",flex:1},children:[e.jsx(Se,{size:16,style:{position:"absolute",left:"0.75rem",top:"50%",transform:"translateY(-50%)",color:"var(--text-muted)"}}),e.jsx("input",{placeholder:"Search students...",value:L,onChange:v=>$(v.target.value),style:{...ct,paddingLeft:"2.2rem"}})]}),e.jsx("button",{onClick:()=>u(f.length===ne.length?[]:ne.map(v=>v.id)),style:Ge,children:f.length===ne.length?"Deselect All":"Select All"})]}),e.jsx("div",{style:{maxHeight:"400px",overflowY:"auto"},children:ne.map(v=>e.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"0.75rem",padding:"0.65rem 0.75rem",borderRadius:"8px",cursor:"pointer",background:f.includes(v.id)?"rgba(59, 130, 246, 0.08)":"transparent",border:`1px solid ${f.includes(v.id)?"rgba(59, 130, 246, 0.3)":"transparent"}`,marginBottom:"0.25rem",transition:"all 0.15s ease"},children:[e.jsx("input",{type:"checkbox",checked:f.includes(v.id),onChange:Y=>{u(z=>Y.target.checked?[...z,v.id]:z.filter(_=>_!==v.id))},style:{accentColor:"#3b82f6"}}),e.jsxs("div",{style:{flex:1},children:[e.jsx("div",{style:{color:"var(--text)",fontWeight:600,fontSize:"0.85rem"},children:v.name}),e.jsxs("div",{style:{color:"var(--text-muted)",fontSize:"0.7rem"},children:[v.email," Â· ",v.batch||"No batch"]})]}),e.jsx("span",{style:Ee("#6b7280"),children:v.mentor_id||"Unassigned"})]},v.id))})]}),e.jsx("div",{children:e.jsxs("div",{style:ae,children:[e.jsx("h3",{style:{margin:"0 0 1rem 0",fontSize:"0.95rem",color:"var(--text)"},children:"Reassignment"}),e.jsx("div",{style:{fontSize:"2rem",fontWeight:800,color:"#3b82f6",marginBottom:"0.5rem"},children:f.length}),e.jsx("div",{style:{color:"var(--text-muted)",fontSize:"0.8rem",marginBottom:"1.5rem"},children:"students selected"}),e.jsx("label",{style:{display:"block",marginBottom:"0.5rem",color:"var(--text-muted)",fontSize:"0.8rem",fontWeight:600},children:"Assign to Mentor"}),e.jsxs("select",{value:n,onChange:v=>E(v.target.value),style:{...kt,marginBottom:"1.5rem"},children:[e.jsx("option",{value:"",children:"Select mentor..."}),y.map(v=>e.jsxs("option",{value:v.id,children:[v.name," (",v.email,")"]},v.id))]}),e.jsxs("button",{onClick:te,disabled:f.length===0||!n||C,style:{...He,width:"100%",justifyContent:"center",opacity:f.length===0||!n?.5:1},children:[C?e.jsx(Te,{size:16,className:"spin"}):e.jsx(re,{size:16}),"Reassign ",f.length," Students"]})]})})]}),t==="regrade"&&e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 350px",gap:"1.5rem"},children:[e.jsxs("div",{style:ae,children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"1rem",marginBottom:"1rem"},children:[e.jsxs("span",{style:{color:"var(--text-muted)",fontSize:"0.8rem"},children:[x.length," submissions"]}),e.jsx("button",{onClick:()=>d(c.length===x.length?[]:x.map(v=>v.id)),style:Ge,children:c.length===x.length?"Deselect All":"Select All"})]}),e.jsx("div",{style:{maxHeight:"400px",overflowY:"auto"},children:x.slice(0,100).map(v=>e.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"0.75rem",padding:"0.65rem 0.75rem",borderRadius:"8px",cursor:"pointer",background:c.includes(v.id)?"rgba(59, 130, 246, 0.08)":"transparent",border:`1px solid ${c.includes(v.id)?"rgba(59, 130, 246, 0.3)":"transparent"}`,marginBottom:"0.25rem"},children:[e.jsx("input",{type:"checkbox",checked:c.includes(v.id),onChange:Y=>{d(z=>Y.target.checked?[...z,v.id]:z.filter(_=>_!==v.id))},style:{accentColor:"#3b82f6"}}),e.jsxs("div",{style:{flex:1},children:[e.jsx("div",{style:{color:"var(--text)",fontWeight:600,fontSize:"0.82rem"},children:v.studentName||v.student_name||"Unknown"}),e.jsx("div",{style:{color:"var(--text-muted)",fontSize:"0.7rem"},children:v.problemTitle||v.problem_title||v.problem_id})]}),e.jsxs("div",{style:{textAlign:"right"},children:[e.jsxs("div",{style:{fontWeight:700,fontSize:"0.85rem",color:(v.score||0)>=60?"#10b981":"#ef4444"},children:[v.score||0,"%"]}),e.jsx(zt,{status:v.status||"pending"})]})]},v.id))})]}),e.jsx("div",{children:e.jsxs("div",{style:ae,children:[e.jsx("h3",{style:{margin:"0 0 1rem 0",fontSize:"0.95rem",color:"var(--text)"},children:"Bulk Actions"}),e.jsx("div",{style:{fontSize:"2rem",fontWeight:800,color:"#8b5cf6",marginBottom:"0.5rem"},children:c.length}),e.jsx("div",{style:{color:"var(--text-muted)",fontSize:"0.8rem",marginBottom:"1.5rem"},children:"submissions selected"}),e.jsx("label",{style:{display:"block",marginBottom:"0.5rem",color:"var(--text-muted)",fontSize:"0.8rem",fontWeight:600},children:"Action"}),e.jsxs("select",{value:D,onChange:v=>g(v.target.value),style:{...kt,marginBottom:"1rem"},children:[e.jsx("option",{value:"mark_passed",children:"Mark as Passed (score â‰¥ 60)"}),e.jsx("option",{value:"mark_failed",children:"Mark as Failed (score = 0)"}),e.jsx("option",{value:"reset_scores",children:"Reset Scores (score = 0, pending)"})]}),e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"0.5rem"},children:[e.jsxs("button",{onClick:X,disabled:c.length===0||C,style:{...He,width:"100%",justifyContent:"center",opacity:c.length===0?.5:1},children:[C?e.jsx(Te,{size:16,className:"spin"}):e.jsx(Te,{size:16}),"Apply to ",c.length," Submissions"]}),e.jsxs("button",{onClick:ee,disabled:c.length===0||C,style:{...Yt,width:"100%",justifyContent:"center",opacity:c.length===0?.5:1},children:[e.jsx(Le,{size:16})," Delete ",c.length," Submissions"]})]})]})})]})]})}function Lr(){const[t,j]=i.useState([]),[W,N]=i.useState(null),[y,b]=i.useState(!0),[x,k]=i.useState(1),[f,u]=i.useState(0),[c,d]=i.useState(0),[n,E]=i.useState({action:"",resourceType:""}),[D,g]=i.useState(null);i.useEffect(()=>{(async()=>{b(!0);try{const C=new URLSearchParams({page:x,limit:30});n.action&&C.append("action",n.action),n.resourceType&&C.append("resourceType",n.resourceType);const[o,M]=await Promise.all([I.get(`${me}/admin/audit-logs?${C}`),I.get(`${me}/admin/audit-logs/stats`)]);j(o.data.logs),u(o.data.pagination.total),d(o.data.pagination.totalPages),N(M.data)}catch(C){console.error("Audit logs error:",C)}b(!1)})()},[x,n]);const S={bulk_reassign_students:"#3b82f6",bulk_regrade:"#8b5cf6",bulk_delete_submissions:"#ef4444",create_backup:"#10b981",create_template:"#06b6d4",delete_template:"#ef4444",apply_template:"#f59e0b",data_export:"#ec4899"};return e.jsxs("div",{children:[e.jsxs("div",{style:nt,children:[e.jsxs("h2",{style:{margin:0,color:"var(--text)",fontSize:"1.2rem",display:"flex",alignItems:"center",gap:"0.5rem"},children:[e.jsx(Be,{size:20,color:"#8b5cf6"})," Audit Trail"]}),e.jsxs("span",{style:Ee("#8b5cf6"),children:[f," total logs"]})]}),W&&e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(4, 1fr)",gap:"1rem",marginBottom:"1.5rem"},children:[e.jsxs("div",{style:ae,children:[e.jsx("div",{style:{fontSize:"1.5rem",fontWeight:800,color:"#8b5cf6"},children:W.totalLogs}),e.jsx("div",{style:{color:"var(--text-muted)",fontSize:"0.8rem"},children:"Total Logs"})]}),e.jsxs("div",{style:ae,children:[e.jsx("div",{style:{fontSize:"1.5rem",fontWeight:800,color:"#3b82f6"},children:W.actionBreakdown?.length||0}),e.jsx("div",{style:{color:"var(--text-muted)",fontSize:"0.8rem"},children:"Unique Actions"})]}),e.jsxs("div",{style:ae,children:[e.jsx("div",{style:{fontSize:"1.5rem",fontWeight:800,color:"#10b981"},children:W.userActivity?.length||0}),e.jsx("div",{style:{color:"var(--text-muted)",fontSize:"0.8rem"},children:"Active Users"})]}),e.jsxs("div",{style:ae,children:[e.jsx("div",{style:{fontSize:"1.5rem",fontWeight:800,color:"#06b6d4"},children:W.recentActivity?.reduce((A,C)=>A+C.count,0)||0}),e.jsx("div",{style:{color:"var(--text-muted)",fontSize:"0.8rem"},children:"Last 7 Days"})]})]}),W?.recentActivity?.length>0&&e.jsxs("div",{style:{...ae,marginBottom:"1.5rem"},children:[e.jsx("h3",{style:{margin:"0 0 1rem 0",fontSize:"0.95rem",color:"var(--text)"},children:"Activity Trend (7 Days)"}),e.jsx(it,{width:"100%",height:200,children:e.jsxs(Ot,{data:W.recentActivity,children:[e.jsx(bt,{strokeDasharray:"3 3",stroke:"rgba(255,255,255,0.06)"}),e.jsx(ft,{dataKey:"date",tick:{fill:"#94a3b8",fontSize:11}}),e.jsx(yt,{tick:{fill:"#94a3b8",fontSize:11}}),e.jsx(at,{contentStyle:{background:"#1e293b",border:"1px solid #334155",borderRadius:"10px"}}),e.jsx(St,{dataKey:"count",fill:"#8b5cf6",radius:[4,4,0,0]})]})})]}),e.jsxs("div",{style:{display:"flex",gap:"0.75rem",marginBottom:"1rem"},children:[e.jsx("input",{placeholder:"Filter by action...",value:n.action,onChange:A=>{E(C=>({...C,action:A.target.value})),k(1)},style:{...ct,maxWidth:"250px"}}),e.jsxs("select",{value:n.resourceType,onChange:A=>{E(C=>({...C,resourceType:A.target.value})),k(1)},style:{...kt,maxWidth:"200px"},children:[e.jsx("option",{value:"",children:"All Resources"}),e.jsx("option",{value:"allocation",children:"Allocation"}),e.jsx("option",{value:"submission",children:"Submission"}),e.jsx("option",{value:"template",children:"Template"}),e.jsx("option",{value:"backup",children:"Backup"})]})]}),y?e.jsx("div",{className:"loading-spinner"}):e.jsx("div",{style:ae,children:t.length===0?e.jsx("p",{style:{color:"var(--text-muted)",textAlign:"center",padding:"2rem"},children:"No audit logs found. Actions will be logged as you use admin features."}):e.jsxs(e.Fragment,{children:[t.map(A=>e.jsxs("div",{onClick:()=>g(A),style:{display:"flex",alignItems:"center",gap:"1rem",padding:"0.75rem",borderRadius:"10px",cursor:"pointer",borderBottom:"1px solid rgba(255,255,255,0.04)",transition:"background 0.15s"},onMouseOver:C=>C.currentTarget.style.background="rgba(255,255,255,0.03)",onMouseOut:C=>C.currentTarget.style.background="transparent",children:[e.jsx("div",{style:{width:"8px",height:"8px",borderRadius:"50%",background:S[A.action]||"#6b7280",flexShrink:0}}),e.jsxs("div",{style:{flex:1},children:[e.jsx("div",{style:{color:"var(--text)",fontWeight:600,fontSize:"0.82rem"},children:A.action?.replace(/_/g," ")}),e.jsxs("div",{style:{color:"var(--text-muted)",fontSize:"0.7rem"},children:[A.user_name||"System"," Â· ",A.resource_type||""]})]}),e.jsx("div",{style:{color:"var(--text-muted)",fontSize:"0.7rem",textAlign:"right"},children:new Date(A.timestamp).toLocaleString()}),e.jsx(ve,{size:14,color:"var(--text-muted)"})]},A.id)),e.jsxs("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",gap:"1rem",marginTop:"1rem"},children:[e.jsxs("button",{disabled:x<=1,onClick:()=>k(A=>A-1),style:{...Ge,opacity:x<=1?.4:1},children:[e.jsx(fs,{size:14})," Prev"]}),e.jsxs("span",{style:{color:"var(--text-muted)",fontSize:"0.8rem"},children:["Page ",x," of ",c]}),e.jsxs("button",{disabled:x>=c,onClick:()=>k(A=>A+1),style:{...Ge,opacity:x>=c?.4:1},children:["Next ",e.jsx(Tt,{size:14})]})]})]})}),D&&e.jsx("div",{style:Qt,onClick:()=>g(null),children:e.jsxs("div",{style:Ut,onClick:A=>A.stopPropagation(),children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"1.5rem"},children:[e.jsx("h3",{style:{margin:0,color:"var(--text)"},children:"Audit Log Detail"}),e.jsx("button",{onClick:()=>g(null),style:{background:"none",border:"none",color:"var(--text-muted)",cursor:"pointer"},children:e.jsx(le,{size:20})})]}),e.jsx("div",{style:{display:"grid",gap:"0.75rem"},children:[{label:"Action",value:D.action?.replace(/_/g," ")},{label:"User",value:`${D.user_name} (${D.user_role})`},{label:"Resource",value:`${D.resource_type||"-"} / ${D.resource_id||"-"}`},{label:"IP Address",value:D.ip_address||"-"},{label:"Timestamp",value:new Date(D.timestamp).toLocaleString()}].map((A,C)=>e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",padding:"0.5rem 0",borderBottom:"1px solid rgba(255,255,255,0.06)"},children:[e.jsx("span",{style:{color:"var(--text-muted)",fontSize:"0.85rem"},children:A.label}),e.jsx("span",{style:{color:"var(--text)",fontWeight:600,fontSize:"0.85rem"},children:A.value})]},C))}),D.details&&e.jsxs("div",{style:{marginTop:"1rem"},children:[e.jsx("div",{style:{color:"var(--text-muted)",fontSize:"0.85rem",marginBottom:"0.5rem",fontWeight:600},children:"Details (JSON)"}),e.jsx("pre",{style:{background:"rgba(0,0,0,0.2)",padding:"1rem",borderRadius:"10px",fontSize:"0.75rem",color:"#06b6d4",overflowX:"auto",maxHeight:"250px"},children:JSON.stringify(D.details,null,2)})]})]})})]})}function Br(){const[t,j]=i.useState([]),[W,N]=i.useState([]),[y,b]=i.useState(!0),[x,k]=i.useState(!1),[f,u]=i.useState(null),[c,d]=i.useState({name:"",description:"",difficulty:"Mixed",tags:"",problemIds:[]});i.useEffect(()=>{Promise.all([I.get(`${me}/admin/templates`),I.get(`${me}/problems`)]).then(([S,A])=>{j(S.data);const C=Array.isArray(A.data)?A.data:A.data.problems||[];N(C),b(!1)}).catch(()=>b(!1))},[]);const n=async()=>{try{const S=await I.post(`${me}/admin/templates`,{...c,tags:c.tags.split(",").map(A=>A.trim()).filter(Boolean),createdBy:"admin-001",adminName:"Admin"});j(A=>[{...c,id:S.data.id,problemCount:c.problemIds.length,created_at:new Date},...A]),k(!1),d({name:"",description:"",difficulty:"Mixed",tags:"",problemIds:[]})}catch(S){alert(S.response?.data?.error||S.message)}},E=async S=>{if(window.confirm("Delete this template?"))try{await I.delete(`${me}/admin/templates/${S}?adminId=admin-001&adminName=Admin`),j(A=>A.filter(C=>C.id!==S))}catch(A){alert(A.response?.data?.error||A.message)}},D=async S=>{try{const A=await I.post(`${me}/admin/templates/${S}/apply`,{adminId:"admin-001",adminName:"Admin"});alert(A.data.message)}catch(A){alert(A.response?.data?.error||A.message)}},g=async S=>{try{const A=await I.get(`${me}/admin/templates/${S}`);u(A.data)}catch{alert("Failed to load template details")}};return y?e.jsx("div",{className:"loading-spinner"}):e.jsxs("div",{children:[e.jsxs("div",{style:nt,children:[e.jsxs("h2",{style:{margin:0,color:"var(--text)",fontSize:"1.2rem",display:"flex",alignItems:"center",gap:"0.5rem"},children:[e.jsx($t,{size:20,color:"#06b6d4"})," Problem Set Templates"]}),e.jsxs("button",{onClick:()=>k(!0),style:He,children:[e.jsx(Ae,{size:16})," New Template"]})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(320px, 1fr))",gap:"1rem"},children:[t.map(S=>e.jsxs("div",{style:{...ae,position:"relative",overflow:"hidden"},children:[e.jsx("div",{style:{position:"absolute",top:0,right:0,width:"100px",height:"100px",background:"radial-gradient(circle at top right, rgba(6, 182, 212, 0.1), transparent 70%)"}}),e.jsxs("div",{style:{position:"relative",zIndex:1},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",marginBottom:"0.75rem"},children:[e.jsxs("div",{children:[e.jsx("h3",{style:{margin:0,color:"var(--text)",fontSize:"1rem"},children:S.name}),e.jsx("p",{style:{margin:"0.25rem 0 0",color:"var(--text-muted)",fontSize:"0.8rem"},children:S.description||"No description"})]}),e.jsx("span",{style:Ee("#06b6d4"),children:S.difficulty})]}),e.jsxs("div",{style:{display:"flex",gap:"0.5rem",marginBottom:"1rem",flexWrap:"wrap"},children:[e.jsxs("span",{style:Ee("#3b82f6"),children:[e.jsx($e,{size:10})," ",S.problemCount||0," problems"]}),(Array.isArray(S.tags)?S.tags:[]).map((A,C)=>e.jsx("span",{style:Ee("#8b5cf6"),children:A},C))]}),e.jsxs("div",{style:{display:"flex",gap:"0.5rem"},children:[e.jsxs("button",{onClick:()=>g(S.id),style:{...Ge,flex:1,justifyContent:"center",padding:"0.5rem"},children:[e.jsx(ve,{size:14})," View"]}),e.jsxs("button",{onClick:()=>D(S.id),style:{...He,flex:1,justifyContent:"center",padding:"0.5rem"},children:[e.jsx(or,{size:14})," Apply"]}),e.jsx("button",{onClick:()=>E(S.id),style:{...Yt,padding:"0.5rem"},children:e.jsx(Le,{size:14})})]})]})]},S.id)),t.length===0&&e.jsxs("div",{style:{...ae,gridColumn:"1 / -1",textAlign:"center",padding:"3rem"},children:[e.jsx($t,{size:48,color:"var(--text-muted)",style:{marginBottom:"1rem",opacity:.3}}),e.jsx("p",{style:{color:"var(--text-muted)"},children:"No templates yet. Create your first problem set template!"})]})]}),x&&e.jsx("div",{style:Qt,onClick:()=>k(!1),children:e.jsxs("div",{style:Ut,onClick:S=>S.stopPropagation(),children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"1.5rem"},children:[e.jsx("h3",{style:{margin:0,color:"var(--text)"},children:"Create Problem Set Template"}),e.jsx("button",{onClick:()=>k(!1),style:{background:"none",border:"none",color:"var(--text-muted)",cursor:"pointer"},children:e.jsx(le,{size:20})})]}),e.jsxs("div",{style:{display:"grid",gap:"1rem"},children:[e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",marginBottom:"0.4rem",color:"var(--text-muted)",fontSize:"0.8rem",fontWeight:600},children:"Template Name"}),e.jsx("input",{value:c.name,onChange:S=>d(A=>({...A,name:S.target.value})),placeholder:"e.g., Beginner Python Set",style:ct})]}),e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",marginBottom:"0.4rem",color:"var(--text-muted)",fontSize:"0.8rem",fontWeight:600},children:"Description"}),e.jsx("textarea",{value:c.description,onChange:S=>d(A=>({...A,description:S.target.value})),placeholder:"Describe this template...",style:{...ct,minHeight:"70px",resize:"vertical"}})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"1rem"},children:[e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",marginBottom:"0.4rem",color:"var(--text-muted)",fontSize:"0.8rem",fontWeight:600},children:"Difficulty"}),e.jsxs("select",{value:c.difficulty,onChange:S=>d(A=>({...A,difficulty:S.target.value})),style:kt,children:[e.jsx("option",{value:"Mixed",children:"Mixed"}),e.jsx("option",{value:"Easy",children:"Easy"}),e.jsx("option",{value:"Medium",children:"Medium"}),e.jsx("option",{value:"Hard",children:"Hard"})]})]}),e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",marginBottom:"0.4rem",color:"var(--text-muted)",fontSize:"0.8rem",fontWeight:600},children:"Tags (comma-separated)"}),e.jsx("input",{value:c.tags,onChange:S=>d(A=>({...A,tags:S.target.value})),placeholder:"python, loops, basics",style:ct})]})]}),e.jsxs("div",{children:[e.jsxs("label",{style:{display:"block",marginBottom:"0.4rem",color:"var(--text-muted)",fontSize:"0.8rem",fontWeight:600},children:["Select Problems (",c.problemIds.length," selected)"]}),e.jsx("div",{style:{maxHeight:"200px",overflowY:"auto",border:"1px solid var(--border-color)",borderRadius:"10px",padding:"0.5rem"},children:W.map(S=>e.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"0.5rem",padding:"0.4rem 0.5rem",borderRadius:"6px",cursor:"pointer",background:c.problemIds.includes(S.id)?"rgba(6, 182, 212, 0.08)":"transparent"},children:[e.jsx("input",{type:"checkbox",checked:c.problemIds.includes(S.id),onChange:A=>{d(C=>({...C,problemIds:A.target.checked?[...C.problemIds,S.id]:C.problemIds.filter(o=>o!==S.id)}))},style:{accentColor:"#06b6d4"}}),e.jsx("span",{style:{color:"var(--text)",fontSize:"0.82rem"},children:S.title}),e.jsx("span",{style:{marginLeft:"auto",...Ee("#6b7280")},children:S.difficulty})]},S.id))})]})]}),e.jsxs("div",{style:{display:"flex",gap:"0.75rem",marginTop:"1.5rem",justifyContent:"flex-end"},children:[e.jsx("button",{onClick:()=>k(!1),style:Ge,children:"Cancel"}),e.jsxs("button",{onClick:n,disabled:!c.name,style:{...He,opacity:c.name?1:.5},children:[e.jsx(At,{size:16})," Create Template"]})]})]})}),f&&e.jsx("div",{style:Qt,onClick:()=>u(null),children:e.jsxs("div",{style:Ut,onClick:S=>S.stopPropagation(),children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"1.5rem"},children:[e.jsxs("div",{children:[e.jsx("h3",{style:{margin:0,color:"var(--text)"},children:f.name}),e.jsx("p",{style:{margin:"0.25rem 0 0",color:"var(--text-muted)",fontSize:"0.85rem"},children:f.description})]}),e.jsx("button",{onClick:()=>u(null),style:{background:"none",border:"none",color:"var(--text-muted)",cursor:"pointer"},children:e.jsx(le,{size:20})})]}),e.jsxs("div",{style:{display:"flex",gap:"0.5rem",marginBottom:"1rem"},children:[e.jsx("span",{style:Ee("#06b6d4"),children:f.difficulty}),(f.tags||[]).map((S,A)=>e.jsx("span",{style:Ee("#8b5cf6"),children:S},A))]}),e.jsxs("h4",{style:{color:"var(--text)",marginBottom:"0.75rem"},children:["Problems (",f.problems?.length||0,")"]}),(f.problems||[]).map((S,A)=>e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.75rem",padding:"0.75rem",borderRadius:"10px",marginBottom:"0.5rem",background:"rgba(255,255,255,0.02)",border:"1px solid rgba(255,255,255,0.04)"},children:[e.jsx("span",{style:{width:"28px",height:"28px",borderRadius:"8px",background:"rgba(6, 182, 212, 0.1)",display:"flex",alignItems:"center",justifyContent:"center",fontWeight:700,fontSize:"0.75rem",color:"#06b6d4"},children:A+1}),e.jsxs("div",{style:{flex:1},children:[e.jsx("div",{style:{color:"var(--text)",fontWeight:600,fontSize:"0.85rem"},children:S.title}),e.jsxs("div",{style:{color:"var(--text-muted)",fontSize:"0.7rem"},children:[S.language," Â· ",S.difficulty]})]})]},S.id))]})})]})}function _r(){const[t,j]=i.useState([]),[W,N]=i.useState(!0),[y,b]=i.useState(!1);i.useEffect(()=>{I.get(`${me}/admin/backups`).then(u=>{j(u.data),N(!1)}).catch(()=>N(!1))},[]);const x=async()=>{b(!0);try{const u=await I.post(`${me}/admin/backups`,{adminId:"admin-001",adminName:"Admin"});j(c=>[{id:u.data.backupId,status:"completed",backup_type:"full",fileSizeFormatted:u.data.fileSize,tables_backed_up:u.data.tables,created_at:new Date},...c])}catch(u){alert("Backup failed: "+(u.response?.data?.error||u.message))}b(!1)},k=async u=>{if(window.confirm("Delete this backup?"))try{await I.delete(`${me}/admin/backups/${u}`),j(c=>c.filter(d=>d.id!==u))}catch(c){alert("Error: "+c.message)}},f=u=>{window.open(`${me}/admin/backups/${u}/download`,"_blank")};return W?e.jsx("div",{className:"loading-spinner"}):e.jsxs("div",{children:[e.jsxs("div",{style:nt,children:[e.jsxs("h2",{style:{margin:0,color:"var(--text)",fontSize:"1.2rem",display:"flex",alignItems:"center",gap:"0.5rem"},children:[e.jsx(Qe,{size:20,color:"#10b981"})," Database Backups"]}),e.jsxs("button",{onClick:x,disabled:y,style:He,children:[y?e.jsx(Te,{size:16,className:"spin"}):e.jsx(bs,{size:16}),y?"Creating Backup...":"Create Backup Now"]})]}),e.jsx("div",{style:{...ae,marginBottom:"1.5rem",background:"rgba(16, 185, 129, 0.05)",borderLeft:"4px solid #10b981"},children:e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.75rem"},children:[e.jsx(ys,{size:18,color:"#10b981"}),e.jsxs("div",{children:[e.jsx("div",{style:{color:"var(--text)",fontWeight:600,fontSize:"0.85rem"},children:"Full Database Backup"}),e.jsx("div",{style:{color:"var(--text-muted)",fontSize:"0.8rem"},children:"Creates a complete JSON export of all database tables. Download to keep a secure copy."})]})]})}),e.jsx("div",{style:ae,children:t.length===0?e.jsxs("div",{style:{textAlign:"center",padding:"3rem"},children:[e.jsx(Qe,{size:48,color:"var(--text-muted)",style:{marginBottom:"1rem",opacity:.3}}),e.jsx("p",{style:{color:"var(--text-muted)"},children:"No backups yet. Create your first backup!"})]}):t.map(u=>e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"1rem",padding:"1rem",borderRadius:"12px",borderBottom:"1px solid rgba(255,255,255,0.04)",transition:"background 0.15s"},children:[e.jsx("div",{style:{width:"42px",height:"42px",borderRadius:"12px",background:u.status==="completed"?"rgba(16, 185, 129, 0.1)":"rgba(245, 158, 11, 0.1)",display:"flex",alignItems:"center",justifyContent:"center"},children:u.status==="completed"?e.jsx(oe,{size:20,color:"#10b981"}):e.jsx(Ce,{size:20,color:"#f59e0b"})}),e.jsxs("div",{style:{flex:1},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[e.jsx("span",{style:{color:"var(--text)",fontWeight:600,fontSize:"0.85rem"},children:u.backup_type==="full"?"Full Backup":"Partial Backup"}),e.jsx(zt,{status:u.status})]}),e.jsxs("div",{style:{color:"var(--text-muted)",fontSize:"0.75rem",marginTop:"0.2rem"},children:[new Date(u.created_at).toLocaleString()," Â· ",u.fileSizeFormatted||"N/A",u.tables_backed_up&&` Â· ${Array.isArray(u.tables_backed_up)?u.tables_backed_up.length:0} tables`]})]}),e.jsxs("div",{style:{display:"flex",gap:"0.5rem"},children:[e.jsx("button",{onClick:()=>f(u.id),style:Ge,title:"Download",children:e.jsx(Ue,{size:14})}),e.jsx("button",{onClick:()=>k(u.id),style:{...Yt,padding:"0.5rem 0.75rem"},title:"Delete",children:e.jsx(Le,{size:14})})]})]},u.id))})]})}function Wr(){const[t,j]=i.useState(null),W=[{id:"students",label:"Students",description:"All student profiles with batch and mentor info",icon:e.jsx(re,{size:24}),color:"#3b82f6"},{id:"submissions",label:"Code Submissions",description:"All coding submissions with scores and statuses",icon:e.jsx($e,{size:24}),color:"#8b5cf6"},{id:"problems",label:"Problems",description:"All coding problems with difficulty and language",icon:e.jsx(Oe,{size:24}),color:"#06b6d4"},{id:"allocations",label:"Allocations",description:"Mentor-student allocation mappings",icon:e.jsx(re,{size:24}),color:"#10b981"},{id:"aptitude-submissions",label:"Aptitude Submissions",description:"All aptitude test submissions and scores",icon:e.jsx(Fe,{size:24}),color:"#f59e0b"},{id:"audit-logs",label:"Audit Logs",description:"System audit trail (last 5000 entries)",icon:e.jsx(Be,{size:24}),color:"#ef4444"}],N=async(y,b)=>{j(y);try{const x=`${me}/admin/export/${y}?format=${b}&adminId=admin-001&adminName=Admin`;if(b==="json"){const k=await I.get(x),f=new Blob([JSON.stringify(k.data,null,2)],{type:"application/json"}),u=URL.createObjectURL(f),c=document.createElement("a");c.href=u,c.download=`${y}_export.json`,c.click(),URL.revokeObjectURL(u)}else{const k=await I.get(x,{responseType:"blob"}),f=URL.createObjectURL(k.data),u=document.createElement("a");u.href=f,u.download=`${y}_export.csv`,u.click(),URL.revokeObjectURL(f)}}catch(x){alert("Export failed: "+(x.response?.data?.error||x.message))}j(null)};return e.jsxs("div",{children:[e.jsx("div",{style:nt,children:e.jsxs("h2",{style:{margin:0,color:"var(--text)",fontSize:"1.2rem",display:"flex",alignItems:"center",gap:"0.5rem"},children:[e.jsx(Ue,{size:20,color:"#f59e0b"})," Data Export Tools"]})}),e.jsx("div",{style:{...ae,marginBottom:"1.5rem",background:"rgba(245, 158, 11, 0.05)",borderLeft:"4px solid #f59e0b"},children:e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.75rem"},children:[e.jsx(ys,{size:18,color:"#f59e0b"}),e.jsx("div",{style:{color:"var(--text-muted)",fontSize:"0.8rem"},children:"Export data in CSV (spreadsheet-compatible) or JSON format. CSV files can be opened in Excel, Google Sheets, etc."})]})}),e.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(320px, 1fr))",gap:"1rem"},children:W.map(y=>e.jsxs("div",{style:{...ae,position:"relative",overflow:"hidden"},children:[e.jsx("div",{style:{position:"absolute",bottom:"-20px",right:"-20px",width:"100px",height:"100px",background:`radial-gradient(circle, ${y.color}15, transparent 70%)`}}),e.jsxs("div",{style:{position:"relative",zIndex:1},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.75rem",marginBottom:"0.75rem"},children:[e.jsx("div",{style:{width:"48px",height:"48px",borderRadius:"12px",background:`${y.color}15`,display:"flex",alignItems:"center",justifyContent:"center"},children:Ys.cloneElement(y.icon,{color:y.color})}),e.jsxs("div",{children:[e.jsx("div",{style:{color:"var(--text)",fontWeight:700,fontSize:"0.95rem"},children:y.label}),e.jsx("div",{style:{color:"var(--text-muted)",fontSize:"0.75rem"},children:y.description})]})]}),e.jsxs("div",{style:{display:"flex",gap:"0.5rem"},children:[e.jsxs("button",{onClick:()=>N(y.id,"csv"),disabled:t===y.id,style:{...Ge,flex:1,justifyContent:"center",padding:"0.5rem"},children:[t===y.id?e.jsx(Te,{size:14,className:"spin"}):e.jsx(Ue,{size:14})," CSV"]}),e.jsxs("button",{onClick:()=>N(y.id,"json"),disabled:t===y.id,style:{...He,flex:1,justifyContent:"center",padding:"0.5rem"},children:[t===y.id?e.jsx(Te,{size:14,className:"spin"}):e.jsx(Ue,{size:14})," JSON"]})]})]})]},y.id))})]})}function Pr(){const[t,j]=i.useState(null),[W,N]=i.useState(!0);if(i.useEffect(()=>{I.get(`${me}/admin/analytics/comprehensive`).then(b=>{j(b.data),N(!1)}).catch(()=>N(!1))},[]),W)return e.jsx("div",{className:"loading-spinner"});if(!t)return e.jsx("div",{style:{color:"var(--text-muted)",textAlign:"center",padding:"3rem"},children:"Failed to load analytics"});const y=t.weeklyGrowth>=0?e.jsx(It,{size:14,color:"#10b981"}):e.jsx(dr,{size:14,color:"#ef4444"});return e.jsxs("div",{children:[e.jsxs("div",{style:nt,children:[e.jsxs("h2",{style:{margin:0,color:"var(--text)",fontSize:"1.2rem",display:"flex",alignItems:"center",gap:"0.5rem"},children:[e.jsx(Fe,{size:20,color:"#ec4899"})," Comprehensive Analytics"]}),e.jsxs("span",{style:Ee(t.weeklyGrowth>=0?"#10b981":"#ef4444"),children:[y," ",t.weeklyGrowth>=0?"+":"",t.weeklyGrowth,"% weekly"]})]}),e.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(5, 1fr)",gap:"1rem",marginBottom:"1.5rem"},children:[{label:"Students",value:t.userStats?.student||0,color:"#3b82f6"},{label:"Mentors",value:t.userStats?.mentor||0,color:"#8b5cf6"},{label:"Admins",value:t.userStats?.admin||0,color:"#06b6d4"},{label:"This Week",value:t.thisWeekSubmissions,color:"#10b981"},{label:"Last Week",value:t.lastWeekSubmissions,color:"#f59e0b"}].map((b,x)=>e.jsxs("div",{style:{...ae,borderTop:`3px solid ${b.color}`},children:[e.jsx("div",{style:{fontSize:"1.5rem",fontWeight:800,color:b.color},children:b.value}),e.jsx("div",{style:{color:"var(--text-muted)",fontSize:"0.75rem"},children:b.label})]},x))}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"1rem",marginBottom:"1.5rem"},children:[e.jsxs("div",{style:ae,children:[e.jsx("h3",{style:{margin:"0 0 1rem 0",fontSize:"0.95rem",color:"var(--text)"},children:"Submissions (30 Days)"}),t.dailySubmissions?.length>0?e.jsx(it,{width:"100%",height:250,children:e.jsxs(Ss,{data:t.dailySubmissions,children:[e.jsx("defs",{children:e.jsxs("linearGradient",{id:"colorSubs",x1:"0",y1:"0",x2:"0",y2:"1",children:[e.jsx("stop",{offset:"5%",stopColor:"#3b82f6",stopOpacity:.3}),e.jsx("stop",{offset:"95%",stopColor:"#3b82f6",stopOpacity:0})]})}),e.jsx(bt,{strokeDasharray:"3 3",stroke:"rgba(255,255,255,0.06)"}),e.jsx(ft,{dataKey:"date",tick:{fill:"#94a3b8",fontSize:10}}),e.jsx(yt,{tick:{fill:"#94a3b8",fontSize:10}}),e.jsx(at,{contentStyle:{background:"#1e293b",border:"1px solid #334155",borderRadius:"10px",fontSize:"0.8rem"}}),e.jsx(Cs,{type:"monotone",dataKey:"count",stroke:"#3b82f6",fill:"url(#colorSubs)",strokeWidth:2})]})}):e.jsx("p",{style:{color:"var(--text-muted)",textAlign:"center"},children:"No data"})]}),e.jsxs("div",{style:ae,children:[e.jsx("h3",{style:{margin:"0 0 1rem 0",fontSize:"0.95rem",color:"var(--text)"},children:"Language Distribution"}),t.languageDistribution?.length>0?e.jsx(it,{width:"100%",height:250,children:e.jsxs(ws,{children:[e.jsx(ks,{data:t.languageDistribution,cx:"50%",cy:"50%",innerRadius:50,outerRadius:90,dataKey:"count",nameKey:"name",label:({name:b,percent:x})=>`${b} ${(x*100).toFixed(0)}%`,children:t.languageDistribution.map((b,x)=>e.jsx(zs,{fill:xs[x%xs.length]},x))}),e.jsx(at,{contentStyle:{background:"#1e293b",border:"1px solid #334155",borderRadius:"10px"}})]})}):e.jsx("p",{style:{color:"var(--text-muted)",textAlign:"center"},children:"No data"})]}),e.jsxs("div",{style:ae,children:[e.jsx("h3",{style:{margin:"0 0 1rem 0",fontSize:"0.95rem",color:"var(--text)"},children:"Activity by Hour (7 Days)"}),t.hourlyActivity?.length>0?e.jsx(it,{width:"100%",height:250,children:e.jsxs(Ot,{data:t.hourlyActivity,children:[e.jsx(bt,{strokeDasharray:"3 3",stroke:"rgba(255,255,255,0.06)"}),e.jsx(ft,{dataKey:"hour",tick:{fill:"#94a3b8",fontSize:10}}),e.jsx(yt,{tick:{fill:"#94a3b8",fontSize:10}}),e.jsx(at,{contentStyle:{background:"#1e293b",border:"1px solid #334155",borderRadius:"10px"}}),e.jsx(St,{dataKey:"count",fill:"#8b5cf6",radius:[4,4,0,0]})]})}):e.jsx("p",{style:{color:"var(--text-muted)",textAlign:"center"},children:"No data"})]}),e.jsxs("div",{style:ae,children:[e.jsx("h3",{style:{margin:"0 0 1rem 0",fontSize:"0.95rem",color:"var(--text)"},children:"Difficulty Analysis"}),t.difficultyStats?.length>0?e.jsx("div",{style:{display:"grid",gap:"0.75rem"},children:t.difficultyStats.map((b,x)=>e.jsxs("div",{style:{padding:"0.75rem",background:"rgba(255,255,255,0.02)",borderRadius:"10px"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:"0.5rem"},children:[e.jsx("span",{style:{color:"var(--text)",fontWeight:600,fontSize:"0.85rem"},children:b.difficulty}),e.jsxs("span",{style:{color:"var(--text-muted)",fontSize:"0.75rem"},children:[b.submissions," submissions"]})]}),e.jsxs("div",{style:{display:"flex",gap:"1rem",fontSize:"0.75rem"},children:[e.jsxs("span",{style:{color:"#3b82f6"},children:["Avg: ",b.avgScore,"%"]}),e.jsxs("span",{style:{color:"#10b981"},children:["Pass: ",b.passRate,"%"]})]}),e.jsx("div",{style:{height:"4px",background:"rgba(59, 130, 246, 0.1)",borderRadius:"2px",marginTop:"0.5rem"},children:e.jsx("div",{style:{height:"100%",width:`${b.passRate}%`,background:b.passRate>60?"#10b981":b.passRate>30?"#f59e0b":"#ef4444",borderRadius:"2px"}})})]},x))}):e.jsx("p",{style:{color:"var(--text-muted)",textAlign:"center"},children:"No data"})]})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"1rem",marginBottom:"1.5rem"},children:[e.jsxs("div",{style:ae,children:[e.jsx("h3",{style:{margin:"0 0 1rem 0",fontSize:"0.95rem",color:"var(--text)"},children:"Top Performing Students"}),(t.topStudents||[]).map((b,x)=>e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.75rem",padding:"0.65rem",borderRadius:"8px",borderBottom:"1px solid rgba(255,255,255,0.04)"},children:[e.jsxs("span",{style:{width:"28px",height:"28px",borderRadius:"8px",background:x<3?"linear-gradient(135deg, #f59e0b, #ef4444)":"rgba(107, 114, 128, 0.2)",display:"flex",alignItems:"center",justifyContent:"center",fontWeight:700,fontSize:"0.75rem",color:x<3?"white":"var(--text-muted)"},children:["#",x+1]}),e.jsxs("div",{style:{flex:1},children:[e.jsx("div",{style:{color:"var(--text)",fontWeight:600,fontSize:"0.82rem"},children:b.name}),e.jsxs("div",{style:{color:"var(--text-muted)",fontSize:"0.7rem"},children:[b.batch||"No batch"," Â· ",b.totalSubmissions," submissions"]})]}),e.jsxs("div",{style:{fontWeight:700,fontSize:"0.9rem",color:b.avgScore>=70?"#10b981":"#f59e0b"},children:[b.avgScore,"%"]})]},x)),(!t.topStudents||t.topStudents.length===0)&&e.jsx("p",{style:{color:"var(--text-muted)",textAlign:"center"},children:"No data"})]}),e.jsxs("div",{style:ae,children:[e.jsx("h3",{style:{margin:"0 0 1rem 0",fontSize:"0.95rem",color:"var(--text)"},children:"Mentor Effectiveness"}),(t.mentorStats||[]).map((b,x)=>e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.75rem",padding:"0.65rem",borderRadius:"8px",borderBottom:"1px solid rgba(255,255,255,0.04)"},children:[e.jsx("div",{style:{width:"28px",height:"28px",borderRadius:"50%",background:"linear-gradient(135deg, #3b82f6, #8b5cf6)",display:"flex",alignItems:"center",justifyContent:"center",fontWeight:700,fontSize:"0.7rem",color:"white"},children:b.name?.[0]||"?"}),e.jsxs("div",{style:{flex:1},children:[e.jsx("div",{style:{color:"var(--text)",fontWeight:600,fontSize:"0.82rem"},children:b.name}),e.jsxs("div",{style:{color:"var(--text-muted)",fontSize:"0.7rem"},children:[b.studentCount," students Â· ",b.totalStudentSubmissions," submissions"]})]}),e.jsxs("div",{style:{fontWeight:700,fontSize:"0.9rem",color:b.avgStudentScore>=60?"#10b981":"#f59e0b"},children:[b.avgStudentScore,"%"]})]},x)),(!t.mentorStats||t.mentorStats.length===0)&&e.jsx("p",{style:{color:"var(--text-muted)",textAlign:"center"},children:"No data"})]})]}),t.batchPerformance?.length>0&&e.jsxs("div",{style:ae,children:[e.jsx("h3",{style:{margin:"0 0 1rem 0",fontSize:"0.95rem",color:"var(--text)"},children:"Batch Performance"}),e.jsx(it,{width:"100%",height:250,children:e.jsxs(Ot,{data:t.batchPerformance,children:[e.jsx(bt,{strokeDasharray:"3 3",stroke:"rgba(255,255,255,0.06)"}),e.jsx(ft,{dataKey:"batch",tick:{fill:"#94a3b8",fontSize:11}}),e.jsx(yt,{tick:{fill:"#94a3b8",fontSize:11}}),e.jsx(at,{contentStyle:{background:"#1e293b",border:"1px solid #334155",borderRadius:"10px"}}),e.jsx(kr,{}),e.jsx(St,{dataKey:"avgScore",name:"Avg Score",fill:"#3b82f6",radius:[4,4,0,0]}),e.jsx(St,{dataKey:"submissions",name:"Submissions",fill:"#8b5cf6",radius:[4,4,0,0]})]})})]})]})}const st="http://localhost:3000/api",gt={background:"var(--bg-card)",border:"1px solid var(--border-color)",borderRadius:"16px",padding:"1.5rem",transition:"all 0.3s ease"},qe={width:"100%",padding:"0.7rem 1rem",borderRadius:"10px",border:"1px solid var(--border-color)",background:"var(--bg-card)",color:"var(--text)",fontSize:"0.85rem",outline:"none",boxSizing:"border-box"},vt={...qe,cursor:"pointer"},jt={padding:"0.6rem 1.2rem",borderRadius:"10px",border:"none",background:"linear-gradient(135deg, #3b82f6, #8b5cf6)",color:"white",fontWeight:600,cursor:"pointer",fontSize:"0.85rem",display:"flex",alignItems:"center",gap:"0.5rem"},Er={...jt,background:"linear-gradient(135deg, #ef4444, #dc2626)"},lt={...jt,background:"rgba(59, 130, 246, 0.1)",color:"#3b82f6",border:"1px solid rgba(59, 130, 246, 0.3)"},gs={active:"#10b981",inactive:"#f59e0b",suspended:"#ef4444"},us={admin:"#8b5cf6",mentor:"#3b82f6",student:"#10b981"};function Mr(){const[t,j]=i.useState([]),[W,N]=i.useState(!0),[y,b]=i.useState([]),[x,k]=i.useState({role:"",status:"",search:"",batch:""}),[f,u]=i.useState({page:1,limit:15,total:0,pages:0}),[c,d]=i.useState(!1),[n,E]=i.useState(null),[D,g]=i.useState(null),[S,A]=i.useState(""),[C,o]=i.useState(!1),[M,w]=i.useState(null),[L,$]=i.useState({name:"",email:"",password:"",role:"student",mentorId:"",batch:"",phone:""}),[te,X]=i.useState(null),ee=i.useCallback(async(h=1)=>{N(!0);try{const B=new URLSearchParams({page:h,limit:f.limit});x.role&&B.set("role",x.role),x.status&&B.set("status",x.status),x.search&&B.set("search",x.search),x.batch&&B.set("batch",x.batch);const Z=await I.get(`${st}/admin/users?${B}`);j(Z.data.data),u(xe=>({...xe,page:h,total:Z.data.pagination.total,pages:Z.data.pagination.pages}))}catch(B){console.error(B)}N(!1)},[x,f.limit]),ne=async()=>{try{const h=await I.get(`${st}/users?role=mentor`);b(Array.isArray(h.data)?h.data:h.data.data||[])}catch(h){console.error(h)}};i.useEffect(()=>{ee(),ne()},[]),i.useEffect(()=>{const h=setTimeout(()=>ee(1),300);return()=>clearTimeout(h)},[x]);const v=(h,B="success")=>{X({text:h,type:B}),setTimeout(()=>X(null),3e3)},Y=async()=>{if(!L.name||!L.email||!L.password)return v("Name, email, and password are required","error");try{await I.post(`${st}/admin/users`,L),v(`User ${L.name} created successfully`),d(!1),$({name:"",email:"",password:"",role:"student",mentorId:"",batch:"",phone:""}),ee(f.page)}catch(h){v(h.response?.data?.error||"Failed to create user","error")}},z=async()=>{try{await I.put(`${st}/admin/users/${n.id}`,L),v(`User ${n.id} updated successfully`),E(null),d(!1),ee(f.page)}catch(h){v(h.response?.data?.error||"Failed to update user","error")}},_=async h=>{try{await I.delete(`${st}/admin/users/${h}`),v(`User ${h} deleted`),w(null),ee(f.page)}catch(B){v(B.response?.data?.error||"Failed to delete user","error")}},J=async h=>{if(!S)return v("Password cannot be empty","error");try{await I.post(`${st}/admin/users/${h}/reset-password`,{newPassword:S}),v("Password reset successfully"),g(null),A("")}catch{v("Failed to reset password","error")}},we=async(h,B)=>{const Z=B==="active"?"suspended":"active";try{await I.patch(`${st}/admin/users/${h}/status`,{status:Z}),v(`User status changed to ${Z}`),ee(f.page)}catch{v("Failed to change status","error")}},p=h=>{E(h),$({name:h.name,email:h.email,password:"",role:h.role,mentorId:h.mentor_id||h.mentorId||"",batch:h.batch||"",phone:h.phone||""}),d(!0)},G=()=>{E(null),$({name:"",email:"",password:"",role:"student",mentorId:"",batch:"",phone:""}),d(!0)};return e.jsxs("div",{className:"animate-fadeIn",children:[te&&e.jsxs("div",{style:{position:"fixed",top:"1rem",right:"1rem",zIndex:9999,padding:"1rem 1.5rem",borderRadius:"12px",background:te.type==="error"?"linear-gradient(135deg, #ef4444, #dc2626)":"linear-gradient(135deg, #10b981, #059669)",color:"white",fontWeight:600,boxShadow:"0 8px 32px rgba(0,0,0,0.3)",display:"flex",alignItems:"center",gap:"0.5rem"},children:[te.type==="error"?e.jsx(Me,{size:18}):e.jsx(oe,{size:18})," ",te.text]}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"1.5rem"},children:[e.jsxs("div",{children:[e.jsx("h2",{style:{margin:0,fontSize:"1.5rem",fontWeight:700,color:"var(--text)"},children:"User Management"}),e.jsxs("p",{style:{margin:0,color:"var(--text-muted)",fontSize:"0.85rem"},children:[f.total," total users"]})]}),e.jsxs("div",{style:{display:"flex",gap:"0.75rem"},children:[e.jsxs("button",{onClick:()=>ee(f.page),style:lt,children:[e.jsx(Te,{size:16})," Refresh"]}),e.jsxs("button",{onClick:G,style:jt,children:[e.jsx(cr,{size:16})," Add User"]})]})]}),e.jsxs("div",{style:{...gt,marginBottom:"1.5rem",display:"flex",gap:"1rem",alignItems:"center",flexWrap:"wrap"},children:[e.jsxs("div",{style:{flex:"2",minWidth:"200px",position:"relative"},children:[e.jsx(Se,{size:16,style:{position:"absolute",left:"12px",top:"50%",transform:"translateY(-50%)",color:"var(--text-muted)"}}),e.jsx("input",{placeholder:"Search name, email, or ID...",value:x.search,onChange:h=>k(B=>({...B,search:h.target.value})),style:{...qe,paddingLeft:"36px"}})]}),e.jsxs("select",{value:x.role,onChange:h=>k(B=>({...B,role:h.target.value})),style:{...vt,flex:"1",minWidth:"130px"},children:[e.jsx("option",{value:"",children:"All Roles"}),e.jsx("option",{value:"student",children:"Student"}),e.jsx("option",{value:"mentor",children:"Mentor"}),e.jsx("option",{value:"admin",children:"Admin"})]}),e.jsxs("select",{value:x.status,onChange:h=>k(B=>({...B,status:h.target.value})),style:{...vt,flex:"1",minWidth:"130px"},children:[e.jsx("option",{value:"",children:"All Status"}),e.jsx("option",{value:"active",children:"Active"}),e.jsx("option",{value:"inactive",children:"Inactive"}),e.jsx("option",{value:"suspended",children:"Suspended"})]}),e.jsx("input",{placeholder:"Filter batch...",value:x.batch,onChange:h=>k(B=>({...B,batch:h.target.value})),style:{...qe,flex:"1",minWidth:"120px"}})]}),e.jsxs("div",{style:{...gt,padding:0,overflow:"hidden"},children:[W?e.jsx("div",{style:{padding:"3rem",textAlign:"center"},children:e.jsx("div",{className:"loading-spinner"})}):e.jsx("div",{style:{overflowX:"auto"},children:e.jsxs("table",{style:{width:"100%",borderCollapse:"collapse"},children:[e.jsx("thead",{children:e.jsx("tr",{style:{borderBottom:"1px solid var(--border-color)",background:"rgba(59,130,246,0.05)"},children:["ID","Name","Email","Role","Mentor","Batch","Status","Actions"].map(h=>e.jsx("th",{style:{padding:"0.8rem 1rem",textAlign:"left",fontSize:"0.75rem",fontWeight:700,color:"var(--text-muted)",textTransform:"uppercase",letterSpacing:"0.05em"},children:h},h))})}),e.jsx("tbody",{children:t.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:8,style:{padding:"3rem",textAlign:"center",color:"var(--text-muted)"},children:"No users found"})}):t.map(h=>e.jsxs("tr",{style:{borderBottom:"1px solid var(--border-color)",transition:"background 0.2s"},onMouseEnter:B=>B.currentTarget.style.background="rgba(59,130,246,0.03)",onMouseLeave:B=>B.currentTarget.style.background="transparent",children:[e.jsx("td",{style:{padding:"0.75rem 1rem",fontSize:"0.8rem",fontFamily:"monospace",color:"var(--text-muted)"},children:h.id}),e.jsx("td",{style:{padding:"0.75rem 1rem",fontWeight:600,color:"var(--text)"},children:h.name}),e.jsx("td",{style:{padding:"0.75rem 1rem",color:"var(--text-muted)",fontSize:"0.85rem"},children:h.email}),e.jsx("td",{style:{padding:"0.75rem 1rem"},children:e.jsx("span",{style:{padding:"0.2rem 0.6rem",borderRadius:"20px",fontSize:"0.7rem",fontWeight:600,background:`${us[h.role]}20`,color:us[h.role]},children:h.role})}),e.jsx("td",{style:{padding:"0.75rem 1rem",color:"var(--text-muted)",fontSize:"0.85rem"},children:h.mentor_id||h.mentorId||"â€”"}),e.jsx("td",{style:{padding:"0.75rem 1rem",color:"var(--text-muted)",fontSize:"0.85rem"},children:h.batch||"â€”"}),e.jsx("td",{style:{padding:"0.75rem 1rem"},children:e.jsx("span",{onClick:()=>we(h.id,h.status||"active"),style:{padding:"0.2rem 0.6rem",borderRadius:"20px",fontSize:"0.7rem",fontWeight:600,background:`${gs[h.status||"active"]}20`,color:gs[h.status||"active"],cursor:"pointer"},children:h.status||"active"})}),e.jsx("td",{style:{padding:"0.75rem 1rem"},children:e.jsxs("div",{style:{display:"flex",gap:"0.4rem"},children:[e.jsx("button",{onClick:()=>p(h),title:"Edit",style:{padding:"0.4rem",borderRadius:"8px",border:"1px solid var(--border-color)",background:"transparent",color:"#3b82f6",cursor:"pointer"},children:e.jsx(mr,{size:14})}),e.jsx("button",{onClick:()=>g(h.id),title:"Reset Password",style:{padding:"0.4rem",borderRadius:"8px",border:"1px solid var(--border-color)",background:"transparent",color:"#f59e0b",cursor:"pointer"},children:e.jsx(ns,{size:14})}),e.jsx("button",{onClick:()=>w(h.id),title:"Delete",style:{padding:"0.4rem",borderRadius:"8px",border:"1px solid var(--border-color)",background:"transparent",color:"#ef4444",cursor:"pointer"},children:e.jsx(Le,{size:14})})]})})]},h.id))})]})}),f.pages>1&&e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"1rem",borderTop:"1px solid var(--border-color)"},children:[e.jsxs("span",{style:{color:"var(--text-muted)",fontSize:"0.8rem"},children:["Page ",f.page," of ",f.pages," (",f.total," users)"]}),e.jsxs("div",{style:{display:"flex",gap:"0.5rem"},children:[e.jsx("button",{disabled:f.page<=1,onClick:()=>ee(f.page-1),style:{...lt,opacity:f.page<=1?.5:1},children:e.jsx(fs,{size:16})}),e.jsx("button",{disabled:f.page>=f.pages,onClick:()=>ee(f.page+1),style:{...lt,opacity:f.page>=f.pages?.5:1},children:e.jsx(Tt,{size:16})})]})]})]}),c&&e.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.6)",backdropFilter:"blur(4px)",zIndex:9998,display:"flex",alignItems:"center",justifyContent:"center"},onClick:()=>d(!1),children:e.jsxs("div",{style:{...gt,width:"500px",maxHeight:"85vh",overflowY:"auto",position:"relative"},onClick:h=>h.stopPropagation(),children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"1.5rem"},children:[e.jsx("h3",{style:{margin:0,fontSize:"1.2rem",fontWeight:700},children:n?"Edit User":"Create New User"}),e.jsx("button",{onClick:()=>d(!1),style:{background:"transparent",border:"none",color:"var(--text-muted)",cursor:"pointer"},children:e.jsx(le,{size:20})})]}),e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"1rem"},children:[e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",marginBottom:"0.3rem",fontSize:"0.8rem",fontWeight:600,color:"var(--text-muted)"},children:"Name *"}),e.jsx("input",{value:L.name,onChange:h=>$(B=>({...B,name:h.target.value})),placeholder:"Full Name",style:qe})]}),e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",marginBottom:"0.3rem",fontSize:"0.8rem",fontWeight:600,color:"var(--text-muted)"},children:"Email *"}),e.jsx("input",{type:"email",value:L.email,onChange:h=>$(B=>({...B,email:h.target.value})),placeholder:"email@example.com",style:qe})]}),!n&&e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",marginBottom:"0.3rem",fontSize:"0.8rem",fontWeight:600,color:"var(--text-muted)"},children:"Password *"}),e.jsxs("div",{style:{position:"relative"},children:[e.jsx("input",{type:C?"text":"password",value:L.password,onChange:h=>$(B=>({...B,password:h.target.value})),placeholder:"Password",style:{...qe,paddingRight:"40px"}}),e.jsx("button",{onClick:()=>o(!C),style:{position:"absolute",right:"10px",top:"50%",transform:"translateY(-50%)",background:"transparent",border:"none",color:"var(--text-muted)",cursor:"pointer"},children:C?e.jsx(Mt,{size:16}):e.jsx(ve,{size:16})})]})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"1rem"},children:[e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",marginBottom:"0.3rem",fontSize:"0.8rem",fontWeight:600,color:"var(--text-muted)"},children:"Role *"}),e.jsxs("select",{value:L.role,onChange:h=>$(B=>({...B,role:h.target.value})),style:vt,children:[e.jsx("option",{value:"student",children:"Student"}),e.jsx("option",{value:"mentor",children:"Mentor"}),e.jsx("option",{value:"admin",children:"Admin"})]})]}),e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",marginBottom:"0.3rem",fontSize:"0.8rem",fontWeight:600,color:"var(--text-muted)"},children:"Batch"}),e.jsx("input",{value:L.batch,onChange:h=>$(B=>({...B,batch:h.target.value})),placeholder:"e.g. 2025-A",style:qe})]})]}),L.role==="student"&&e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",marginBottom:"0.3rem",fontSize:"0.8rem",fontWeight:600,color:"var(--text-muted)"},children:"Assign Mentor"}),e.jsxs("select",{value:L.mentorId,onChange:h=>$(B=>({...B,mentorId:h.target.value})),style:vt,children:[e.jsx("option",{value:"",children:"No Mentor"}),y.map(h=>e.jsxs("option",{value:h.id,children:[h.name," (",h.id,")"]},h.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",marginBottom:"0.3rem",fontSize:"0.8rem",fontWeight:600,color:"var(--text-muted)"},children:"Phone"}),e.jsx("input",{value:L.phone,onChange:h=>$(B=>({...B,phone:h.target.value})),placeholder:"+91 9876543210",style:qe})]})]}),e.jsxs("div",{style:{display:"flex",gap:"0.75rem",marginTop:"1.5rem",justifyContent:"flex-end"},children:[e.jsx("button",{onClick:()=>d(!1),style:lt,children:"Cancel"}),e.jsxs("button",{onClick:n?z:Y,style:jt,children:[e.jsx(At,{size:16})," ",n?"Update":"Create"]})]})]})}),D&&e.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.6)",backdropFilter:"blur(4px)",zIndex:9998,display:"flex",alignItems:"center",justifyContent:"center"},onClick:()=>g(null),children:e.jsxs("div",{style:{...gt,width:"400px"},onClick:h=>h.stopPropagation(),children:[e.jsx("h3",{style:{margin:"0 0 1rem",fontWeight:700},children:"Reset Password"}),e.jsxs("p",{style:{color:"var(--text-muted)",marginBottom:"1rem",fontSize:"0.85rem"},children:["User: ",e.jsx("strong",{children:D})]}),e.jsx("input",{type:"password",value:S,onChange:h=>A(h.target.value),placeholder:"Enter new password",style:qe}),e.jsxs("div",{style:{display:"flex",gap:"0.75rem",marginTop:"1.25rem",justifyContent:"flex-end"},children:[e.jsx("button",{onClick:()=>g(null),style:lt,children:"Cancel"}),e.jsxs("button",{onClick:()=>J(D),style:jt,children:[e.jsx(ns,{size:16})," Reset"]})]})]})}),M&&e.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.6)",backdropFilter:"blur(4px)",zIndex:9998,display:"flex",alignItems:"center",justifyContent:"center"},onClick:()=>w(null),children:e.jsxs("div",{style:{...gt,width:"400px",textAlign:"center"},onClick:h=>h.stopPropagation(),children:[e.jsx(pe,{size:48,color:"#ef4444",style:{marginBottom:"1rem"}}),e.jsx("h3",{style:{margin:"0 0 0.5rem",fontWeight:700},children:"Delete User?"}),e.jsxs("p",{style:{color:"var(--text-muted)",marginBottom:"1.5rem",fontSize:"0.85rem"},children:["This will permanently delete ",e.jsx("strong",{children:M})," and all their data. This cannot be undone."]}),e.jsxs("div",{style:{display:"flex",gap:"0.75rem",justifyContent:"center"},children:[e.jsx("button",{onClick:()=>w(null),style:lt,children:"Cancel"}),e.jsxs("button",{onClick:()=>_(M),style:Er,children:[e.jsx(Le,{size:16})," Delete"]})]})]})})]})}const Ke="http://localhost:3000",Ht={Languages:["Python","JavaScript","Java","C++","C#","Go","Rust","TypeScript"],Frontend:["React","Angular","Vue.js","HTML","CSS"],Backend:["Node.js","Express.js","Django","Flask","Spring Boot"],Databases:["SQL","MySQL","PostgreSQL","MongoDB","Redis"],"CS Fundamentals":["Data Structures","Algorithms","System Design","OOP","Design Patterns"],"DevOps & Cloud":["Docker","Kubernetes","AWS","Azure","GCP","Git","Linux"],"API & Web":["REST API","GraphQL","Networking","Security","Testing"],"AI / ML":["Machine Learning","Deep Learning","NLP","Computer Vision"]},Dr=Object.values(Ht).flat(),ot=({icon:t,title:j,subtitle:W,color:N,children:y})=>e.jsxs("div",{style:{background:"#1e293b",borderRadius:"14px",border:"1px solid #334155",overflow:"hidden",boxShadow:"0 2px 8px rgba(0,0,0,0.2)"},children:[e.jsxs("div",{style:{padding:"14px 18px",display:"flex",alignItems:"center",gap:"10px",borderBottom:"1px solid #334155",background:`linear-gradient(135deg, ${N}18, ${N}08)`},children:[e.jsx("div",{style:{width:"32px",height:"32px",borderRadius:"8px",display:"flex",alignItems:"center",justifyContent:"center",background:`${N}25`,color:N},children:t}),e.jsxs("div",{children:[e.jsx("div",{style:{fontWeight:700,fontSize:"14px",color:"#f1f5f9"},children:j}),W&&e.jsx("div",{style:{fontSize:"11px",color:"#94a3b8"},children:W})]})]}),e.jsx("div",{style:{padding:"16px 18px"},children:y})]}),Ie=({label:t,value:j,onChange:W,min:N,max:y,icon:b,color:x,suffix:k})=>e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"6px"},children:[e.jsxs("label",{style:{fontSize:"12px",fontWeight:600,color:"#94a3b8",display:"flex",alignItems:"center",gap:"4px"},children:[b," ",t]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",borderRadius:"10px",border:"1px solid #475569",overflow:"hidden",background:"#0f172a"},children:[e.jsx("button",{onClick:()=>W(Math.max(N,j-1)),style:{width:"36px",height:"40px",border:"none",background:"#1e293b",cursor:"pointer",fontSize:"18px",color:"#94a3b8",fontWeight:600,borderRight:"1px solid #475569"},children:"âˆ’"}),e.jsx("input",{type:"number",value:j,min:N,max:y,onChange:f=>W(Math.min(y,Math.max(N,parseInt(f.target.value)||N))),style:{flex:1,textAlign:"center",border:"none",outline:"none",fontSize:"16px",fontWeight:700,color:x||"#f1f5f9",padding:"8px 4px",width:"100%",boxSizing:"border-box",background:"transparent"}}),e.jsx("button",{onClick:()=>W(Math.min(y,j+1)),style:{width:"36px",height:"40px",border:"none",background:"#1e293b",cursor:"pointer",fontSize:"18px",color:"#94a3b8",fontWeight:600,borderLeft:"1px solid #475569"},children:"+"})]}),k&&e.jsx("span",{style:{fontSize:"10px",color:"#64748b",textAlign:"center"},children:k})]});function $r(){const[t,j]=i.useState([]),[W,N]=i.useState(!0),[y,b]=i.useState(!1),[x,k]=i.useState(null),[f,u]=i.useState([]),[c,d]=i.useState(!1),[n,E]=i.useState({title:"",description:"",skills:[],difficulty_level:"mixed",mcq_count:10,coding_count:3,sql_count:3,interview_count:5,attempt_limit:1,mcq_duration_minutes:30,coding_duration_minutes:45,sql_duration_minutes:45,interview_duration_minutes:30,mcq_passing_score:60,coding_passing_score:50,sql_passing_score:50,interview_passing_score:6,proctoring_enabled:!0,proctoring_config:{camera:!0,mic:!0,fullscreen:!0,paste_disabled:!0,face_detection:!0,camera_block_detect:!0,phone_detect:!0}}),[D,g]=i.useState(""),[S,A]=i.useState(null),[C,o]=i.useState(""),[M,w]=i.useState([]),[L,$]=i.useState(!1),[te,X]=i.useState([]),[ee,ne]=i.useState(null),[v,Y]=i.useState(""),[z,_]=i.useState("");i.useEffect(()=>{J()},[]);const J=async()=>{try{N(!0);const{data:r}=await I.get(`${Ke}/api/skill-tests/all`);j(r)}catch(r){o(r.response?.data?.error||r.message)}finally{N(!1)}},we=async()=>{if(!n.title.trim())return o("Title is required");if(n.skills.length===0)return o("Select at least one skill");o(""),d(!0);try{await I.post(`${Ke}/api/skill-tests/create`,n),b(!1),E({title:"",description:"",skills:[],difficulty_level:"mixed",mcq_count:10,coding_count:3,sql_count:3,interview_count:5,attempt_limit:1,mcq_duration_minutes:30,coding_duration_minutes:45,sql_duration_minutes:45,interview_duration_minutes:30,mcq_passing_score:60,coding_passing_score:50,sql_passing_score:50,interview_passing_score:6,proctoring_enabled:!0,proctoring_config:{camera:!0,mic:!0,fullscreen:!0,paste_disabled:!0,face_detection:!0,camera_block_detect:!0,phone_detect:!0}}),J()}catch(r){o(r.response?.data?.error||r.message)}finally{d(!1)}},p=async r=>{try{await I.put(`${Ke}/api/skill-tests/${r}/toggle`),J()}catch(R){o(R.message)}},G=async r=>{if(window.confirm("Delete this test and all its attempts?"))try{await I.delete(`${Ke}/api/skill-tests/${r}`),J()}catch(R){o(R.message)}},h=async()=>{try{const{data:r}=await I.get(`${Ke}/api/users?role=student`);w(Array.isArray(r)?r:[])}catch(r){console.error("Error fetching students:",r),w([])}},B=async r=>{await h(),ne(r);try{const{data:R}=await I.get(`${Ke}/api/tests/${r}/allocated-students`);X(R.studentIds||[])}catch(R){console.error("Error loading allocations:",R),X([])}$(!0)},Z=r=>{X(R=>R.includes(r)?R.filter(a=>a!==r):[...R,r])},xe=async()=>{try{await I.post(`${Ke}/api/tests/${ee}/allocate-students`,{studentIds:te}),$(!1),X([]),ne(null),J()}catch(r){o("Error saving allocations: "+(r.response?.data?.error||r.message))}},ge=r=>{E(R=>({...R,skills:R.skills.includes(r)?R.skills.filter(a=>a!==r):[...R.skills,r]}))},ye=r=>{const R=Ht[r]||[],a=R.every(q=>n.skills.includes(q));E(q=>({...q,skills:a?q.skills.filter(P=>!R.includes(P)):[...new Set([...q.skills,...R])]}))},ke=D?Dr.filter(r=>r.toLowerCase().includes(D.toLowerCase())):[],l={passed:"#22c55e",failed:"#ef4444",in_progress:"#f59e0b",pending:"#6b7280"},H=t.filter(r=>(r.title||"").toLowerCase().includes(z.toLowerCase())||(r.description||"").toLowerCase().includes(z.toLowerCase())||(r.skills||[]).some(R=>R.toLowerCase().includes(z.toLowerCase()))),ie=async r=>{if(x===r){k(null);return}try{const{data:R}=await I.get(`${Ke}/api/skill-tests/${r}/attempts`);u(Array.isArray(R)?R:[]),k(r)}catch(R){o(R.response?.data?.error||R.message),u([]),k(r)}};return e.jsxs("div",{style:{padding:"24px",maxWidth:"1200px",margin:"0 auto"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"24px"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px"},children:[e.jsx("div",{style:{width:"42px",height:"42px",borderRadius:"12px",display:"flex",alignItems:"center",justifyContent:"center",background:"linear-gradient(135deg, #8b5cf6, #6d28d9)"},children:e.jsx(Xe,{size:22,color:"white"})}),e.jsxs("div",{children:[e.jsx("h2",{style:{margin:0,fontSize:"22px",fontWeight:800,color:"#f1f5f9"},children:"Skill Test Management"}),e.jsx("p",{style:{margin:0,fontSize:"13px",color:"#9ca3af"},children:"Create & manage AI-powered assessments"})]})]}),e.jsxs("button",{onClick:()=>{b(!y),o("")},style:{display:"flex",alignItems:"center",gap:"8px",padding:"11px 22px",background:y?"linear-gradient(135deg, #ef4444, #dc2626)":"linear-gradient(135deg, #8b5cf6, #7c3aed)",color:"white",border:"none",borderRadius:"10px",cursor:"pointer",fontWeight:700,fontSize:"14px",boxShadow:"0 2px 8px rgba(139,92,246,0.3)",transition:"all 0.2s"},children:[y?e.jsx(le,{size:18}):e.jsx(Ae,{size:18}),y?"Cancel":"Create Test"]})]}),C&&e.jsxs("div",{style:{background:"rgba(239,68,68,0.1)",border:"1px solid rgba(239,68,68,0.3)",borderRadius:"10px",padding:"12px 16px",marginBottom:"16px",color:"#fca5a5",display:"flex",justifyContent:"space-between",alignItems:"center",fontSize:"13px"},children:[e.jsxs("span",{children:[e.jsx(Me,{size:14,style:{verticalAlign:"middle",marginRight:"6px"}}),C]}),e.jsx("button",{onClick:()=>o(""),style:{background:"none",border:"none",cursor:"pointer",color:"#fca5a5",padding:"4px"},children:e.jsx(le,{size:16})})]}),y&&e.jsxs("div",{style:{background:"linear-gradient(135deg, rgba(139,92,246,0.08), rgba(109,40,217,0.05))",borderRadius:"16px",padding:"24px",marginBottom:"28px",border:"1px solid rgba(139,92,246,0.2)",boxShadow:"0 4px 20px rgba(0,0,0,0.2)"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"10px",marginBottom:"20px"},children:[e.jsx(Ve,{size:20,color:"#8b5cf6"}),e.jsx("h3",{style:{margin:0,fontSize:"18px",fontWeight:800,color:"#c4b5fd"},children:"Create New Assessment"})]}),e.jsx(ot,{icon:e.jsx($e,{size:16}),title:"Basic Information",subtitle:"Name your assessment",color:"#3b82f6",children:e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"14px"},children:[e.jsxs("div",{children:[e.jsxs("label",{style:{fontWeight:600,fontSize:"12px",display:"block",marginBottom:"6px",color:"#cbd5e1"},children:["Test Title ",e.jsx("span",{style:{color:"#f87171"},children:"*"})]}),e.jsx("input",{value:n.title,onChange:r=>E({...n,title:r.target.value}),placeholder:"e.g., Full Stack Developer Assessment",style:{width:"100%",padding:"11px 14px",borderRadius:"10px",border:"2px solid "+(n.title?"#8b5cf6":"#475569"),fontSize:"14px",boxSizing:"border-box",outline:"none",transition:"border-color 0.2s",background:"#0f172a",color:"#f1f5f9"}})]}),e.jsxs("div",{children:[e.jsx("label",{style:{fontWeight:600,fontSize:"12px",display:"block",marginBottom:"6px",color:"#cbd5e1"},children:"Description"}),e.jsx("input",{value:n.description,onChange:r=>E({...n,description:r.target.value}),placeholder:"Brief description of this test",style:{width:"100%",padding:"11px 14px",borderRadius:"10px",border:"2px solid #475569",fontSize:"14px",boxSizing:"border-box",outline:"none",transition:"border-color 0.2s",background:"#0f172a",color:"#f1f5f9"}})]})]})}),e.jsx("div",{style:{height:"14px"}}),e.jsxs(ot,{icon:e.jsx(xr,{size:16}),title:"Skills Selection",subtitle:`${n.skills.length} skill${n.skills.length!==1?"s":""} selected`,color:"#8b5cf6",children:[n.skills.length>0&&e.jsx("div",{style:{display:"flex",flexWrap:"wrap",gap:"6px",marginBottom:"14px",padding:"10px",background:"rgba(139,92,246,0.1)",borderRadius:"10px",border:"1px dashed rgba(139,92,246,0.4)"},children:n.skills.map(r=>e.jsxs("span",{onClick:()=>ge(r),style:{padding:"5px 12px",background:"linear-gradient(135deg, #8b5cf6, #7c3aed)",color:"white",borderRadius:"20px",fontSize:"12px",cursor:"pointer",display:"flex",alignItems:"center",gap:"5px",fontWeight:600,boxShadow:"0 1px 3px rgba(139,92,246,0.3)",transition:"transform 0.15s"},children:[r," ",e.jsx(le,{size:12})]},r))}),e.jsxs("div",{style:{position:"relative",marginBottom:"12px"},children:[e.jsx(Se,{size:16,style:{position:"absolute",left:"12px",top:"50%",transform:"translateY(-50%)",color:"#9ca3af"}}),e.jsx("input",{value:D,onChange:r=>g(r.target.value),placeholder:"Search skills...",style:{width:"100%",padding:"10px 12px 10px 36px",borderRadius:"10px",border:"2px solid #475569",fontSize:"13px",boxSizing:"border-box",outline:"none",transition:"border-color 0.2s",background:"#0f172a",color:"#f1f5f9"}})]}),D&&e.jsx("div",{style:{display:"flex",flexWrap:"wrap",gap:"6px",marginBottom:"12px",padding:"10px",background:"rgba(245,158,11,0.08)",borderRadius:"8px"},children:ke.length===0?e.jsxs("span",{style:{fontSize:"12px",color:"#9ca3af"},children:['No skills found for "',D,'"']}):ke.map(r=>e.jsxs("span",{onClick:()=>ge(r),style:{padding:"5px 12px",borderRadius:"20px",fontSize:"12px",cursor:"pointer",fontWeight:500,transition:"all 0.15s",background:n.skills.includes(r)?"#8b5cf6":"#0f172a",color:n.skills.includes(r)?"white":"#cbd5e1",border:"1px solid "+(n.skills.includes(r)?"#7c3aed":"#475569"),boxShadow:n.skills.includes(r)?"0 1px 3px rgba(139,92,246,0.3)":"none"},children:[n.skills.includes(r)?"âœ“ ":"",r]},r))}),!D&&e.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"6px"},children:Object.entries(Ht).map(([r,R])=>{const a=R.filter(P=>n.skills.includes(P)).length,q=S===r;return e.jsxs("div",{style:{border:"1px solid "+(a>0?"rgba(139,92,246,0.4)":"#475569"),borderRadius:"10px",overflow:"hidden",background:a>0?"rgba(139,92,246,0.08)":"#0f172a",transition:"all 0.2s"},children:[e.jsxs("div",{onClick:()=>A(q?null:r),style:{padding:"10px 14px",cursor:"pointer",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[e.jsx("span",{style:{fontWeight:600,fontSize:"13px",color:"#e2e8f0"},children:r}),a>0&&e.jsxs("span",{style:{padding:"1px 8px",borderRadius:"10px",fontSize:"11px",background:"#8b5cf6",color:"white",fontWeight:700},children:[a,"/",R.length]})]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[e.jsx("button",{onClick:P=>{P.stopPropagation(),ye(r)},style:{padding:"3px 8px",borderRadius:"6px",border:"1px solid #475569",background:a===R.length?"#8b5cf6":"#1e293b",color:a===R.length?"white":"#94a3b8",fontSize:"10px",fontWeight:600,cursor:"pointer"},children:a===R.length?"Deselect All":"Select All"}),q?e.jsx(ls,{size:16,color:"#9ca3af"}):e.jsx(pr,{size:16,color:"#9ca3af"})]})]}),q&&e.jsx("div",{style:{padding:"8px 14px 12px",borderTop:"1px solid #334155",display:"flex",flexWrap:"wrap",gap:"6px"},children:R.map(P=>e.jsxs("span",{onClick:()=>ge(P),style:{padding:"5px 12px",borderRadius:"20px",fontSize:"12px",cursor:"pointer",fontWeight:500,transition:"all 0.15s",background:n.skills.includes(P)?"#8b5cf6":"#1e293b",color:n.skills.includes(P)?"white":"#cbd5e1",border:"1px solid "+(n.skills.includes(P)?"#7c3aed":"#475569"),boxShadow:n.skills.includes(P)?"0 1px 3px rgba(139,92,246,0.3)":"none"},children:[n.skills.includes(P)?"âœ“ ":"",P]},P))})]},r)})})]}),e.jsx("div",{style:{height:"14px"}}),e.jsx(ot,{icon:e.jsx(Ne,{size:16}),title:"Difficulty Level",subtitle:"Set overall difficulty",color:"#f59e0b",children:e.jsx("div",{style:{display:"flex",gap:"10px",flexWrap:"wrap"},children:[{value:"easy",label:"Easy",desc:"Beginner friendly",color:"#22c55e"},{value:"medium",label:"Medium",desc:"Intermediate level",color:"#f59e0b"},{value:"hard",label:"Hard",desc:"Advanced concepts",color:"#ef4444"},{value:"mixed",label:"Mixed",desc:"30% easy, 50% medium, 20% hard",color:"#8b5cf6"}].map(r=>e.jsxs("button",{onClick:()=>E({...n,difficulty_level:r.value}),style:{flex:"1 1 140px",padding:"14px 16px",borderRadius:"12px",cursor:"pointer",background:n.difficulty_level===r.value?`${r.color}18`:"#0f172a",border:`2px solid ${n.difficulty_level===r.value?r.color:"#475569"}`,textAlign:"center",transition:"all 0.2s"},children:[e.jsx("div",{style:{fontWeight:700,fontSize:"14px",color:n.difficulty_level===r.value?r.color:"#e2e8f0",marginBottom:"4px"},children:r.label}),e.jsx("div",{style:{fontSize:"11px",color:"#94a3b8"},children:r.desc})]},r.value))})}),e.jsx("div",{style:{height:"14px"}}),e.jsxs(ot,{icon:e.jsx(Be,{size:16}),title:"Proctoring Mode",subtitle:n.proctoring_enabled?"Enabled â€” configure options":"Disabled",color:"#ef4444",children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:n.proctoring_enabled?"16px":"0",padding:"10px 14px",background:"#0f172a",borderRadius:"10px",border:"1px solid #334155"},children:[e.jsxs("div",{children:[e.jsx("div",{style:{fontWeight:700,fontSize:"14px",color:"#f1f5f9"},children:"Enable Proctoring"}),e.jsx("div",{style:{fontSize:"11px",color:"#94a3b8"},children:"Monitor students during test"})]}),e.jsx("button",{onClick:()=>E({...n,proctoring_enabled:!n.proctoring_enabled}),style:{background:"none",border:"none",cursor:"pointer",padding:0},children:n.proctoring_enabled?e.jsx(os,{size:36,color:"#22c55e"}):e.jsx(ds,{size:36,color:"#475569"})})]}),n.proctoring_enabled&&e.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(200px, 1fr))",gap:"10px"},children:[{key:"camera",label:"Camera",desc:"Webcam monitoring",icon:e.jsx(gr,{size:16}),color:"#3b82f6"},{key:"mic",label:"Microphone",desc:"Audio monitoring",icon:e.jsx(ur,{size:16}),color:"#8b5cf6"},{key:"fullscreen",label:"Fullscreen",desc:"Force fullscreen mode",icon:e.jsx(hr,{size:16}),color:"#06b6d4"},{key:"paste_disabled",label:"Paste Disabled",desc:"Block copy-paste",icon:e.jsx(br,{size:16}),color:"#f59e0b"},{key:"face_detection",label:"Face Movement",desc:"Detect face away/moving",icon:e.jsx(fr,{size:16}),color:"#10b981"},{key:"camera_block_detect",label:"Camera Block",desc:"Detect covered camera",icon:e.jsx(ht,{size:16}),color:"#ef4444"},{key:"phone_detect",label:"Phone Detection",desc:"Detect mobile phone",icon:e.jsx(yr,{size:16}),color:"#ec4899"}].map(r=>{const R=n.proctoring_config[r.key];return e.jsxs("button",{onClick:()=>E({...n,proctoring_config:{...n.proctoring_config,[r.key]:!R}}),style:{display:"flex",alignItems:"center",gap:"10px",padding:"12px 14px",borderRadius:"10px",cursor:"pointer",textAlign:"left",background:R?`${r.color}12`:"#0f172a",border:`1.5px solid ${R?r.color:"#475569"}`,transition:"all 0.2s"},children:[e.jsx("div",{style:{width:"34px",height:"34px",borderRadius:"8px",display:"flex",alignItems:"center",justifyContent:"center",flexShrink:0,background:R?`${r.color}25`:"#1e293b",color:R?r.color:"#64748b"},children:r.icon}),e.jsxs("div",{style:{flex:1,minWidth:0},children:[e.jsx("div",{style:{fontWeight:600,fontSize:"13px",color:R?"#f1f5f9":"#94a3b8"},children:r.label}),e.jsx("div",{style:{fontSize:"10px",color:"#64748b"},children:r.desc})]}),e.jsx("div",{style:{width:"8px",height:"8px",borderRadius:"50%",background:R?r.color:"#475569",flexShrink:0}})]},r.key)})})]}),e.jsx("div",{style:{height:"14px"}}),e.jsx(ot,{icon:e.jsx(jr,{size:16}),title:"Question Configuration",subtitle:"Set number of questions per section",color:"#10b981",children:e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(4, 1fr)",gap:"16px"},children:[e.jsx(Ie,{label:"MCQ Questions",value:n.mcq_count,onChange:r=>E({...n,mcq_count:r}),min:5,max:50,icon:e.jsx(Xe,{size:12}),color:"#8b5cf6",suffix:"5â€“50 questions"}),e.jsx(Ie,{label:"Coding Problems",value:n.coding_count,onChange:r=>E({...n,coding_count:r}),min:1,max:10,icon:e.jsx(Re,{size:12}),color:"#3b82f6",suffix:"1â€“10 problems"}),e.jsx(Ie,{label:"SQL Problems",value:n.sql_count,onChange:r=>E({...n,sql_count:r}),min:1,max:10,icon:e.jsx(Qe,{size:12}),color:"#10b981",suffix:"1â€“10 problems"}),e.jsx(Ie,{label:"Interview Qs",value:n.interview_count,onChange:r=>E({...n,interview_count:r}),min:3,max:15,icon:e.jsx(Pt,{size:12}),color:"#f59e0b",suffix:"3â€“15 questions"})]})}),e.jsx("div",{style:{height:"14px"}}),e.jsxs(ot,{icon:e.jsx(Ne,{size:16}),title:"Passing Criteria & Settings",subtitle:"Configure passing scores and limits",color:"#ef4444",children:[e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(4, 1fr)",gap:"16px",marginBottom:"14px"},children:[e.jsx(Ie,{label:"MCQ Pass %",value:n.mcq_passing_score,onChange:r=>E({...n,mcq_passing_score:r}),min:30,max:100,icon:e.jsx(Fe,{size:12}),color:"#8b5cf6",suffix:"min 30%"}),e.jsx(Ie,{label:"Coding Pass %",value:n.coding_passing_score,onChange:r=>E({...n,coding_passing_score:r}),min:30,max:100,icon:e.jsx(Fe,{size:12}),color:"#3b82f6",suffix:"min 30%"}),e.jsx(Ie,{label:"SQL Pass %",value:n.sql_passing_score,onChange:r=>E({...n,sql_passing_score:r}),min:30,max:100,icon:e.jsx(Fe,{size:12}),color:"#10b981",suffix:"min 30%"}),e.jsx(Ie,{label:"Interview Pass (/10)",value:n.interview_passing_score,onChange:r=>E({...n,interview_passing_score:r}),min:3,max:10,icon:e.jsx(Fe,{size:12}),color:"#f59e0b",suffix:"out of 10"})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(4, 1fr)",gap:"16px",marginBottom:"14px"},children:[e.jsx(Ie,{label:"MCQ Time (m)",value:n.mcq_duration_minutes,onChange:r=>E({...n,mcq_duration_minutes:r}),min:5,max:120,icon:e.jsx(Ce,{size:12}),color:"#8b5cf6",suffix:"minutes"}),e.jsx(Ie,{label:"Coding Time (m)",value:n.coding_duration_minutes,onChange:r=>E({...n,coding_duration_minutes:r}),min:5,max:120,icon:e.jsx(Ce,{size:12}),color:"#3b82f6",suffix:"minutes"}),e.jsx(Ie,{label:"SQL Time (m)",value:n.sql_duration_minutes,onChange:r=>E({...n,sql_duration_minutes:r}),min:5,max:120,icon:e.jsx(Ce,{size:12}),color:"#10b981",suffix:"minutes"}),e.jsx(Ie,{label:"Interview Time (m)",value:n.interview_duration_minutes,onChange:r=>E({...n,interview_duration_minutes:r}),min:5,max:120,icon:e.jsx(Ce,{size:12}),color:"#f59e0b",suffix:"minutes"})]}),e.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(4, 1fr)",gap:"16px"},children:e.jsx(Ie,{label:"Max Attempts",value:n.attempt_limit,onChange:r=>E({...n,attempt_limit:r}),min:1,max:5,icon:e.jsx(Be,{size:12}),color:"#6366f1",suffix:"per student"})})]}),e.jsx("div",{style:{height:"18px"}}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"14px 18px",background:"#1e293b",borderRadius:"12px",border:"1px solid #334155",boxShadow:"0 2px 8px rgba(0,0,0,0.2)"},children:[e.jsxs("div",{style:{display:"flex",gap:"16px",fontSize:"12px",color:"#94a3b8",flexWrap:"wrap",alignItems:"center"},children:[e.jsxs("span",{children:[e.jsx(Xe,{size:13,style:{verticalAlign:"middle"}})," ",n.mcq_count," MCQ"]}),e.jsxs("span",{children:[e.jsx(Re,{size:13,style:{verticalAlign:"middle"}})," ",n.coding_count," Coding"]}),e.jsxs("span",{children:[e.jsx(Qe,{size:13,style:{verticalAlign:"middle"}})," ",n.sql_count," SQL"]}),e.jsxs("span",{children:[e.jsx(Pt,{size:13,style:{verticalAlign:"middle"}})," ",n.interview_count," Interview"]}),e.jsxs("span",{children:[e.jsx(Ce,{size:13,style:{verticalAlign:"middle"}})," ",n.mcq_duration_minutes,"m+",n.coding_duration_minutes,"m+",n.sql_duration_minutes,"m+",n.interview_duration_minutes,"m"]}),e.jsxs("span",{style:{color:{easy:"#22c55e",medium:"#f59e0b",hard:"#ef4444",mixed:"#8b5cf6"}[n.difficulty_level]},children:[e.jsx(Ne,{size:13,style:{verticalAlign:"middle"}})," ",n.difficulty_level]}),e.jsxs("span",{style:{color:n.proctoring_enabled?"#22c55e":"#ef4444"},children:[e.jsx(Be,{size:13,style:{verticalAlign:"middle"}})," ",n.proctoring_enabled?"Proctored":"No Proctor"]})]}),e.jsx("button",{onClick:we,disabled:c,style:{padding:"12px 32px",background:c?"#a78bfa":"linear-gradient(135deg, #8b5cf6, #7c3aed)",color:"white",border:"none",borderRadius:"10px",cursor:c?"not-allowed":"pointer",fontWeight:800,fontSize:"15px",boxShadow:"0 2px 10px rgba(139,92,246,0.35)",display:"flex",alignItems:"center",gap:"8px",transition:"all 0.2s"},children:c?e.jsxs(e.Fragment,{children:[e.jsx(Ze,{size:16})," Creating..."]}):e.jsxs(e.Fragment,{children:[e.jsx(Ve,{size:16})," Create Assessment"]})})]})]}),!y&&e.jsx("div",{style:{display:"flex",justifyContent:"flex-end",marginBottom:"16px"},children:e.jsxs("div",{style:{position:"relative"},children:[e.jsx(Se,{size:16,style:{position:"absolute",left:"12px",top:"50%",transform:"translateY(-50%)",color:"#9ca3af"}}),e.jsx("input",{value:z,onChange:r=>_(r.target.value),placeholder:"Search assessments...",style:{padding:"10px 14px 10px 36px",borderRadius:"10px",border:"1px solid #475569",background:"#0f172a",color:"#f1f5f9",fontSize:"13px",width:"280px",outline:"none"}})]})}),W?e.jsxs("div",{style:{textAlign:"center",padding:"60px",color:"#9ca3af"},children:[e.jsx("div",{style:{width:"40px",height:"40px",border:"3px solid #e5e7eb",borderTopColor:"#8b5cf6",borderRadius:"50%",animation:"spin 1s linear infinite",margin:"0 auto 12px"}}),e.jsx("style",{children:"@keyframes spin { to { transform: rotate(360deg); } }"}),e.jsx("p",{style:{fontSize:"14px",fontWeight:500},children:"Loading assessments..."})]}):H.length===0?e.jsxs("div",{style:{gridColumn:"1 / -1",textAlign:"center",padding:"5rem",background:"var(--bg-card)",borderRadius:"20px",border:"1px dashed var(--border-color)"},children:[e.jsx(Xe,{size:48,style:{color:"var(--text-muted)",marginBottom:"1rem",opacity:.3}}),e.jsx("h3",{style:{color:"var(--text-main)"},children:"No tests found"}),e.jsx("p",{style:{color:"var(--text-muted)"},children:z?"Try a different search term":"Create your first skill test to get started"})]}):e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"14px"},children:[e.jsxs("div",{style:{fontSize:"13px",color:"#94a3b8",fontWeight:600,padding:"0 4px"},children:[H.length," assessment",H.length!==1?"s":""]}),H.map(r=>e.jsxs("div",{style:{background:"#1e293b",border:"1px solid #334155",borderRadius:"14px",padding:"20px",boxShadow:"0 2px 8px rgba(0,0,0,0.2)",borderLeft:`4px solid ${r.is_active?"#8b5cf6":"#475569"}`,transition:"box-shadow 0.2s"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start"},children:[e.jsxs("div",{style:{flex:1},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"10px",marginBottom:"8px"},children:[e.jsx("h3",{style:{margin:0,fontSize:"17px",fontWeight:800,color:"#f1f5f9"},children:r.title}),e.jsx("span",{style:{padding:"3px 10px",borderRadius:"20px",fontSize:"11px",fontWeight:700,background:r.is_active?"#dcfce7":"#fee2e2",color:r.is_active?"#16a34a":"#dc2626"},children:r.is_active?"Active":"Inactive"})]}),r.description&&e.jsx("p",{style:{margin:"0 0 12px",color:"#94a3b8",fontSize:"13px",lineHeight:"1.5"},children:r.description}),e.jsx("div",{style:{display:"flex",flexWrap:"wrap",gap:"5px",marginBottom:"12px"},children:(r.skills||[]).map(R=>e.jsx("span",{style:{padding:"3px 10px",background:"rgba(139,92,246,0.15)",color:"#a78bfa",borderRadius:"20px",fontSize:"11px",fontWeight:600,border:"1px solid rgba(139,92,246,0.25)"},children:R},R))}),e.jsxs("div",{style:{display:"flex",gap:"6px",flexWrap:"wrap",fontSize:"11px",padding:"8px 12px",background:"#0f172a",borderRadius:"8px"},children:[e.jsxs("span",{style:{display:"flex",alignItems:"center",gap:"3px",color:"#8b5cf6",fontWeight:600},children:[e.jsx(Xe,{size:12})," ",r.mcq_count," MCQ"]}),e.jsx("span",{style:{color:"#475569"},children:"|"}),e.jsxs("span",{style:{display:"flex",alignItems:"center",gap:"3px",color:"#3b82f6",fontWeight:600},children:[e.jsx(Re,{size:12})," ",r.coding_count," Coding"]}),r.config?.interview?.enabled&&e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.4rem",padding:"0.4rem 0.8rem",background:"rgba(59, 130, 246, 0.1)",borderRadius:"20px",fontSize:"0.75rem",color:"#3b82f6",border:"1px solid rgba(59, 130, 246, 0.2)"},children:[e.jsx(qt,{size:14})," AI Interview"]}),e.jsx("span",{style:{color:"#475569"},children:"|"}),e.jsxs("span",{style:{display:"flex",alignItems:"center",gap:"3px",color:"#10b981",fontWeight:600},children:[e.jsx(Qe,{size:12})," ",r.sql_count," SQL"]}),e.jsx("span",{style:{color:"#475569"},children:"|"}),e.jsxs("span",{style:{display:"flex",alignItems:"center",gap:"3px",color:"#f59e0b",fontWeight:600},children:[e.jsx(Pt,{size:12})," ",r.interview_count," Interview"]}),e.jsx("span",{style:{color:"#475569"},children:"|"}),e.jsxs("span",{style:{display:"flex",alignItems:"center",gap:"3px",color:"#94a3b8"},children:[e.jsx(Ce,{size:12})," ",r.mcq_duration_minutes,"m"]}),e.jsx("span",{style:{color:"#475569"},children:"|"}),e.jsxs("span",{style:{display:"flex",alignItems:"center",gap:"3px",color:"#94a3b8"},children:[e.jsx(Be,{size:12})," ",r.attempt_limit," attempt",r.attempt_limit>1?"s":""]})]}),r.attempt_stats&&e.jsxs("div",{style:{display:"flex",gap:"16px",marginTop:"10px",fontSize:"12px"},children:[e.jsxs("span",{style:{display:"flex",alignItems:"center",gap:"4px",color:"#94a3b8"},children:[e.jsx(re,{size:14})," ",r.attempt_stats.total||0," attempts"]}),e.jsxs("span",{style:{display:"flex",alignItems:"center",gap:"4px",color:"#22c55e"},children:[e.jsx(oe,{size:14})," ",r.attempt_stats.completed||0," passed"]}),e.jsxs("span",{style:{display:"flex",alignItems:"center",gap:"4px",color:"#ef4444"},children:[e.jsx(Me,{size:14})," ",r.attempt_stats.failed||0," failed"]})]})]}),e.jsxs("div",{style:{display:"flex",gap:"6px",marginLeft:"16px"},children:[e.jsx("button",{onClick:()=>ie(r.id),title:"View Attempts",style:{padding:"8px",background:"rgba(16,185,129,0.1)",border:"1px solid rgba(16,185,129,0.3)",borderRadius:"10px",cursor:"pointer",transition:"all 0.15s"},children:e.jsx(ve,{size:16,color:"#34d399"})}),e.jsxs("button",{onClick:()=>B(r.id),title:"Assign Students",style:{display:"flex",alignItems:"center",gap:"0.5rem",padding:"0.6rem 1rem",background:"rgba(167, 139, 250, 0.1)",color:"#a78bfa",border:"1px solid rgba(167, 139, 250, 0.2)",borderRadius:"10px",fontSize:"0.85rem",fontWeight:600,cursor:"pointer",transition:"all 0.2s"},onMouseEnter:R=>R.currentTarget.style.background="rgba(167, 139, 250, 0.2)",onMouseLeave:R=>R.currentTarget.style.background="rgba(167, 139, 250, 0.1)",children:[e.jsx(re,{size:16})," Assign"]}),e.jsx("button",{onClick:()=>p(r.id),title:r.is_active?"Deactivate":"Activate",style:{padding:"8px",background:r.is_active?"rgba(245,158,11,0.1)":"rgba(16,185,129,0.1)",border:"1px solid "+(r.is_active?"rgba(245,158,11,0.3)":"rgba(16,185,129,0.3)"),borderRadius:"10px",cursor:"pointer",transition:"all 0.15s"},children:r.is_active?e.jsx(os,{size:16,color:"#fbbf24"}):e.jsx(ds,{size:16,color:"#34d399"})}),e.jsx("button",{onClick:()=>G(r.id),title:"Delete",style:{padding:"8px",background:"rgba(239,68,68,0.1)",border:"1px solid rgba(239,68,68,0.3)",borderRadius:"10px",cursor:"pointer",transition:"all 0.15s"},children:e.jsx(Le,{size:16,color:"#f87171"})})]})]}),x===r.id&&e.jsxs("div",{style:{marginTop:"16px",borderTop:"1px solid #334155",paddingTop:"16px"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:"12px"},children:[e.jsxs("h4",{style:{margin:0,fontSize:"14px",fontWeight:700,color:"#e2e8f0",display:"flex",alignItems:"center",gap:"6px"},children:[e.jsx(re,{size:15})," Student Attempts"]}),e.jsxs("button",{onClick:()=>k(null),style:{background:"#334155",border:"none",cursor:"pointer",color:"#94a3b8",borderRadius:"6px",padding:"4px 8px",display:"flex",alignItems:"center",gap:"4px",fontSize:"11px",fontWeight:600},children:["Close ",e.jsx(ls,{size:14})]})]}),f.length===0?e.jsx("p",{style:{color:"#9ca3af",fontSize:"13px"},children:"No attempts yet"}):e.jsx("div",{style:{overflowX:"auto"},children:e.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:"13px"},children:[e.jsx("thead",{children:e.jsxs("tr",{style:{background:"#0f172a"},children:[e.jsx("th",{style:{padding:"8px",textAlign:"left",borderBottom:"1px solid #334155",color:"#94a3b8"},children:"Student"}),e.jsx("th",{style:{padding:"8px",textAlign:"center",borderBottom:"1px solid #334155",color:"#94a3b8"},children:"Attempt"}),e.jsx("th",{style:{padding:"8px",textAlign:"center",borderBottom:"1px solid #334155",color:"#94a3b8"},children:"Stage"}),e.jsx("th",{style:{padding:"8px",textAlign:"center",borderBottom:"1px solid #334155",color:"#94a3b8"},children:"MCQ"}),e.jsx("th",{style:{padding:"8px",textAlign:"center",borderBottom:"1px solid #334155",color:"#94a3b8"},children:"Coding"}),e.jsx("th",{style:{padding:"8px",textAlign:"center",borderBottom:"1px solid #334155",color:"#94a3b8"},children:"SQL"}),e.jsx("th",{style:{padding:"8px",textAlign:"center",borderBottom:"1px solid #334155",color:"#94a3b8"},children:"Interview"}),e.jsx("th",{style:{padding:"8px",textAlign:"center",borderBottom:"1px solid #334155",color:"#94a3b8"},children:"Status"})]})}),e.jsx("tbody",{children:f.map(R=>e.jsxs("tr",{style:{borderBottom:"1px solid #1e293b"},children:[e.jsx("td",{style:{padding:"8px",color:"#e2e8f0"},children:R.student_name||R.student_id}),e.jsxs("td",{style:{padding:"8px",textAlign:"center",color:"#cbd5e1"},children:["#",R.attempt_number]}),e.jsx("td",{style:{padding:"8px",textAlign:"center"},children:e.jsx("span",{style:{padding:"2px 8px",borderRadius:"12px",fontSize:"11px",background:"rgba(99,102,241,0.15)",color:"#a5b4fc"},children:R.current_stage})}),e.jsx("td",{style:{padding:"8px",textAlign:"center",color:l[R.mcq_status]},children:R.mcq_status!=="pending"?`${Math.round(R.mcq_score)}%`:"-"}),e.jsx("td",{style:{padding:"8px",textAlign:"center",color:l[R.coding_status]},children:R.coding_status!=="pending"?`${Math.round(R.coding_score)}%`:"-"}),e.jsx("td",{style:{padding:"8px",textAlign:"center",color:l[R.sql_status]},children:R.sql_status!=="pending"?`${Math.round(R.sql_score)}%`:"-"}),e.jsx("td",{style:{padding:"8px",textAlign:"center",color:l[R.interview_status]},children:R.interview_status!=="pending"?`${(R.interview_score||0).toFixed(1)}/10`:"-"}),e.jsx("td",{style:{padding:"8px",textAlign:"center"},children:e.jsx("span",{style:{padding:"2px 8px",borderRadius:"12px",fontSize:"11px",fontWeight:600,background:R.overall_status==="completed"?"rgba(16,185,129,0.15)":R.overall_status==="failed"?"rgba(239,68,68,0.15)":"rgba(245,158,11,0.15)",color:R.overall_status==="completed"?"#6ee7b7":R.overall_status==="failed"?"#fca5a5":"#fcd34d"},children:R.overall_status})})]},R.id))})]})})]})]},r.id))]}),L&&e.jsx("div",{className:"modal-overlay",onClick:()=>$(!1),children:e.jsxs("div",{className:"modal-content",onClick:r=>r.stopPropagation(),style:{maxWidth:"800px",maxHeight:"90vh",display:"flex",flexDirection:"column",borderRadius:"24px",overflow:"hidden",padding:0,border:"1px solid var(--border-color)",boxShadow:"0 25px 50px -12px rgba(0, 0, 0, 0.5)"},children:[e.jsxs("div",{className:"modal-header",style:{padding:"1.5rem 2rem",borderBottom:"1px solid var(--border-color)",display:"flex",justifyContent:"space-between",alignItems:"center",background:"var(--bg-card)"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"1rem"},children:[e.jsx("div",{style:{width:"48px",height:"48px",borderRadius:"14px",background:"linear-gradient(135deg, #a78bfa, #8b5cf6)",display:"flex",alignItems:"center",justifyContent:"center",boxShadow:"0 8px 16px rgba(167, 139, 250, 0.2)"},children:e.jsx(re,{size:24,color:"white"})}),e.jsxs("div",{children:[e.jsx("h2",{style:{margin:0,fontSize:"1.5rem",color:"var(--text-main)",fontWeight:800},children:"Assign Students"}),e.jsx("p",{style:{margin:0,fontSize:"0.85rem",color:"var(--text-muted)"},children:"Manage student participation for this skill test"})]})]}),e.jsx("button",{onClick:()=>$(!1),className:"modal-close",style:{background:"var(--bg-secondary)"},children:e.jsx(le,{size:20})})]}),e.jsxs("div",{style:{padding:"1.25rem 2rem",background:"var(--bg-secondary)",borderBottom:"1px solid var(--border-color)",display:"flex",justifyContent:"space-between",alignItems:"center",gap:"1.5rem"},children:[e.jsxs("div",{style:{position:"relative",flex:1},children:[e.jsx(Se,{size:18,style:{position:"absolute",left:"1rem",top:"50%",transform:"translateY(-50%)",color:"var(--text-muted)",pointerEvents:"none"}}),e.jsx("input",{type:"text",placeholder:"Search by student name, username or batch...",value:v,onChange:r=>Y(r.target.value),style:{width:"100%",padding:"0.85rem 1rem 0.85rem 2.75rem",borderRadius:"12px",border:"1px solid var(--border-color)",background:"var(--bg-card)",color:"var(--text-main)",fontSize:"0.95rem",outline:"none",transition:"all 0.2s",boxShadow:"0 2px 4px rgba(0,0,0,0.05)"}})]}),e.jsx("button",{onClick:()=>{const r=M.filter(a=>(a.name||a.username||"").toLowerCase().includes(v.toLowerCase())||(a.batch||"").toLowerCase().includes(v.toLowerCase()));if(r.every(a=>te.includes(a.id)))X(a=>a.filter(q=>!r.find(P=>P.id===q)));else{const a=r.map(q=>q.id).filter(q=>!te.includes(q));X(q=>[...q,...a])}},style:{padding:"0.85rem 1.5rem",background:"var(--bg-card)",color:"var(--text-main)",border:"1px solid var(--border-color)",borderRadius:"12px",fontWeight:600,fontSize:"0.9rem",cursor:"pointer",whiteSpace:"nowrap",transition:"all 0.2s"},children:M.filter(r=>(r.name||r.username||"").toLowerCase().includes(v.toLowerCase())||(r.batch||"").toLowerCase().includes(v.toLowerCase())).every(r=>te.includes(r.id))?"Deselect All":"Select All"})]}),e.jsx("div",{className:"modal-body",style:{padding:"2rem",overflowY:"auto",maxHeight:"50vh",background:"var(--bg-card)"},children:e.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(280px, 1fr))",gap:"1rem"},children:M.filter(r=>(r.name||r.username||"").toLowerCase().includes(v.toLowerCase())||(r.batch||"").toLowerCase().includes(v.toLowerCase())).length===0?e.jsxs("div",{style:{gridColumn:"1/-1",textAlign:"center",padding:"4rem",color:"var(--text-muted)"},children:[e.jsx(re,{size:48,style:{opacity:.2,marginBottom:"1rem"}}),e.jsx("p",{children:"No students found matching your search."})]}):M.filter(r=>(r.name||r.username||"").toLowerCase().includes(v.toLowerCase())||(r.batch||"").toLowerCase().includes(v.toLowerCase())).map(r=>e.jsxs("div",{onClick:()=>Z(r.id),style:{display:"flex",alignItems:"center",gap:"1rem",padding:"1rem",borderRadius:"16px",background:te.includes(r.id)?"rgba(167, 139, 250, 0.1)":"var(--bg-secondary)",border:`2px solid ${te.includes(r.id)?"#a78bfa":"transparent"}`,cursor:"pointer",transition:"all 0.2s ease",position:"relative",overflow:"hidden"},children:[e.jsx("div",{style:{width:"44px",height:"44px",borderRadius:"12px",background:te.includes(r.id)?"#a78bfa":"var(--bg-card)",color:te.includes(r.id)?"white":"var(--primary)",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"1.1rem",fontWeight:800,boxShadow:"0 4px 6px rgba(0,0,0,0.05)"},children:(r.name||r.username||"S").charAt(0).toUpperCase()}),e.jsxs("div",{style:{flex:1,minWidth:0},children:[e.jsx("div",{style:{fontWeight:700,fontSize:"0.95rem",color:"var(--text-main)",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:r.name||r.username}),e.jsxs("div",{style:{fontSize:"0.75rem",color:"var(--text-muted)",display:"flex",alignItems:"center",gap:"0.5rem",marginTop:"0.2rem"},children:[e.jsx("span",{style:{padding:"2px 6px",background:"var(--bg-card)",borderRadius:"4px",border:"1px solid var(--border-color)"},children:r.batch||"General"}),e.jsx("span",{children:"â€¢"}),e.jsx("span",{children:r.email?.split("@")[0]})]})]}),te.includes(r.id)&&e.jsx("div",{style:{width:"24px",height:"24px",borderRadius:"50%",background:"#a78bfa",display:"flex",alignItems:"center",justifyContent:"center",color:"white",boxShadow:"0 2px 4px rgba(167, 139, 250, 0.4)"},children:e.jsx(js,{size:14,strokeWidth:3})})]},r.id))})}),e.jsxs("div",{className:"modal-footer",style:{padding:"1.5rem 2rem",borderTop:"1px solid var(--border-color)",display:"flex",justifyContent:"space-between",alignItems:"center",background:"var(--bg-card)"},children:[e.jsxs("div",{style:{color:"var(--text-main)"},children:[e.jsx("span",{style:{fontWeight:800,color:"var(--primary)",fontSize:"1.25rem"},children:te.length}),e.jsx("span",{style:{marginLeft:"0.5rem",color:"var(--text-muted)"},children:"students selected"})]}),e.jsxs("div",{style:{display:"flex",gap:"1rem"},children:[e.jsx("button",{onClick:()=>$(!1),className:"btn-reset",style:{padding:"0.75rem 1.5rem",borderRadius:"12px",fontWeight:600},children:"Cancel"}),e.jsx("button",{onClick:xe,style:{padding:"0.75rem 2.5rem",background:"var(--primary)",color:"white",border:"none",borderRadius:"12px",fontWeight:700,fontSize:"1rem",cursor:"pointer",boxShadow:"0 8px 20px var(--primary-alpha)",transition:"all 0.2s ease"},onMouseEnter:r=>r.currentTarget.style.transform="translateY(-2px)",onMouseLeave:r=>r.currentTarget.style.transform="translateY(0)",children:"Confirm Assignments"})]})]})]})})]})}const qr="http://localhost:3000/api",Or=()=>({Authorization:`Bearer ${localStorage.getItem("authToken")}`});function Fr(){const[t,j]=i.useState(null),[W,N]=i.useState(!0),[y,b]=i.useState(""),[x,k]=i.useState(null),f=async()=>{N(!0),k(null);try{const C=await I.get(`${qr}/analytics/plagiarism`,{headers:Or()});j(C.data)}catch{k("Failed to load plagiarism data")}finally{N(!1)}};if(i.useEffect(()=>{f()},[]),W)return e.jsx("div",{style:{padding:40,textAlign:"center",opacity:.6},children:e.jsx("p",{children:"Loading plagiarism data..."})});if(x)return e.jsxs("div",{style:{padding:40,textAlign:"center",color:"#ef4444"},children:[e.jsx(pe,{size:32,style:{marginBottom:12}}),e.jsx("p",{style:{margin:"0 0 12px"},children:x}),e.jsx("button",{onClick:f,style:{padding:"8px 16px",background:"#ef4444",color:"#fff",border:"none",borderRadius:8,cursor:"pointer"},children:"Retry"})]});const u=t?.stats||{},c=t?.flaggedSubmissions||[],d=t?.repeatOffenders||[],n=t?.byProblem||[],E=u.totalSubmissions||0,D=u.plagiarismCount||0,g=E>0?(D/E*100).toFixed(1):"0.0",S=c.filter(C=>{const o=y.toLowerCase();return!o||(C.studentName||"").toLowerCase().includes(o)||(C.problemTitle||"").toLowerCase().includes(o)||(C.copiedFromName||"").toLowerCase().includes(o)}),A=[{label:"Total Submissions",value:E,color:"#6366f1",Icon:cs},{label:"Plagiarism Flags",value:D,color:"#ef4444",Icon:Et},{label:"Plagiarism Rate",value:`${g}%`,color:"#f59e0b",Icon:It},{label:"Repeat Offenders",value:d.length,color:"#8b5cf6",Icon:re}];return e.jsxs("div",{style:{maxWidth:1400},children:[e.jsxs("div",{style:{marginBottom:28,display:"flex",justifyContent:"space-between",alignItems:"flex-start"},children:[e.jsxs("div",{children:[e.jsx("h2",{style:{margin:"0 0 4px",fontSize:22,fontWeight:700},children:" Plagiarism Detection Dashboard"}),e.jsx("p",{style:{margin:0,opacity:.55,fontSize:13},children:"Monitor code similarity and academic integrity across all submissions"})]}),e.jsxs("button",{onClick:f,style:{display:"flex",alignItems:"center",gap:6,padding:"8px 16px",background:"var(--primary, #4f46e5)",color:"#fff",border:"none",borderRadius:8,cursor:"pointer",fontSize:13,fontWeight:600},children:[e.jsx(Te,{size:14})," Refresh"]})]}),e.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(200px, 1fr))",gap:16,marginBottom:28},children:A.map((C,o)=>e.jsxs("div",{style:{padding:20,borderRadius:14,background:"var(--card-bg, #1e293b)",border:`1px solid ${C.color}30`,borderLeft:`4px solid ${C.color}`},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8,marginBottom:10,opacity:.6},children:[e.jsx(C.Icon,{size:15,style:{color:C.color}}),e.jsx("span",{style:{fontSize:11,fontWeight:700,textTransform:"uppercase",letterSpacing:"0.6px"},children:C.label})]}),e.jsx("div",{style:{fontSize:32,fontWeight:800,color:C.color},children:C.value})]},o))}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:16,marginBottom:28},children:[e.jsxs("div",{style:{background:"var(--card-bg, #1e293b)",borderRadius:14,overflow:"hidden",border:"1px solid rgba(239,68,68,0.2)"},children:[e.jsxs("div",{style:{padding:"14px 18px",borderBottom:"1px solid var(--border, #334155)",display:"flex",alignItems:"center",gap:8},children:[e.jsx(pe,{size:15,color:"#ef4444"}),e.jsx("span",{style:{fontWeight:700,color:"#ef4444"},children:"Repeat Offenders"})]}),d.length===0?e.jsx("div",{style:{padding:24,textAlign:"center",opacity:.4},children:"No repeat offenders found"}):d.map((C,o)=>e.jsxs("div",{style:{padding:"12px 18px",borderBottom:"1px solid var(--border, #33415530)",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsxs("div",{children:[e.jsx("div",{style:{fontWeight:700,fontSize:13,textTransform:"uppercase"},children:C.name}),e.jsx("div",{style:{fontSize:11,opacity:.45,marginTop:2},children:C.copiedFromNames||"Multiple sources"})]}),e.jsxs("span",{style:{background:"#ef4444",color:"#fff",borderRadius:"50%",width:28,height:28,display:"flex",alignItems:"center",justifyContent:"center",fontSize:12,fontWeight:700,flexShrink:0},children:[C.plagiarismCount,"x"]})]},o))]}),e.jsxs("div",{style:{background:"var(--card-bg, #1e293b)",borderRadius:14,overflow:"hidden",border:"1px solid rgba(245,158,11,0.2)"},children:[e.jsxs("div",{style:{padding:"14px 18px",borderBottom:"1px solid var(--border, #334155)",display:"flex",alignItems:"center",gap:8},children:[e.jsx(cs,{size:15,color:"#f59e0b"}),e.jsx("span",{style:{fontWeight:700,color:"#f59e0b"},children:"Most Copied Problems"})]}),n.length===0?e.jsx("div",{style:{padding:24,textAlign:"center",opacity:.4},children:"No data available"}):n.map((C,o)=>e.jsxs("div",{style:{padding:"12px 18px",borderBottom:"1px solid var(--border, #33415530)",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsxs("div",{children:[e.jsx("div",{style:{fontWeight:600,fontSize:14},children:C.title}),e.jsx("div",{style:{fontSize:11,opacity:.45,marginTop:2},children:C.difficulty||"Unknown"})]}),e.jsxs("span",{style:{color:"#f59e0b",fontWeight:700,fontSize:13},children:[C.flaggedCount," flags"]})]},o))]})]}),e.jsxs("div",{style:{background:"var(--card-bg, #1e293b)",borderRadius:14,overflow:"hidden",border:"1px solid var(--border, #334155)"},children:[e.jsxs("div",{style:{padding:"14px 18px",borderBottom:"1px solid var(--border, #334155)",display:"flex",justifyContent:"space-between",alignItems:"center",gap:12,flexWrap:"wrap"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[e.jsx(Et,{size:15,color:"#ef4444"}),e.jsx("span",{style:{fontWeight:700},children:"All Flagged Submissions"}),e.jsxs("span",{style:{fontSize:12,opacity:.4},children:["(",S.length," of ",c.length,")"]})]}),e.jsxs("div",{style:{position:"relative"},children:[e.jsx("input",{value:y,onChange:C=>b(C.target.value),placeholder:"Search student or problem",style:{padding:"7px 12px 7px 32px",borderRadius:8,border:"1px solid var(--border, #334155)",background:"var(--bg, #0f172a)",color:"inherit",fontSize:13,outline:"none",width:220}}),e.jsx(Se,{size:13,style:{position:"absolute",left:10,top:"50%",transform:"translateY(-50%)",opacity:.4}})]})]}),S.length===0?e.jsxs("div",{style:{padding:"48px 0",textAlign:"center",opacity:.4},children:[e.jsx(Et,{size:36,style:{marginBottom:12}}),e.jsx("p",{style:{margin:0},children:"No flagged submissions found"})]}):e.jsx("div",{style:{overflowX:"auto"},children:e.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:13},children:[e.jsx("thead",{children:e.jsx("tr",{style:{background:"rgba(0,0,0,0.2)"},children:["Student","Problem","Language","Score","Copied From","Date"].map(C=>e.jsx("th",{style:{padding:"10px 16px",textAlign:"left",fontWeight:700,fontSize:11,textTransform:"uppercase",letterSpacing:"0.5px",opacity:.45},children:C},C))})}),e.jsx("tbody",{children:S.map((C,o)=>e.jsxs("tr",{style:{borderTop:"1px solid var(--border, #33415530)"},onMouseEnter:M=>M.currentTarget.style.background="rgba(239,68,68,0.05)",onMouseLeave:M=>M.currentTarget.style.background="transparent",children:[e.jsx("td",{style:{padding:"11px 16px",fontWeight:600},children:C.studentName}),e.jsx("td",{style:{padding:"11px 16px",opacity:.75},children:C.problemTitle||"â€”"}),e.jsx("td",{style:{padding:"11px 16px",opacity:.6},children:C.language||"â€”"}),e.jsx("td",{style:{padding:"11px 16px"},children:e.jsx("span",{style:{fontWeight:700,color:C.score>=70?"#22c55e":"#ef4444"},children:C.score??"â€”"})}),e.jsx("td",{style:{padding:"11px 16px"},children:e.jsx("span",{style:{color:"#ef4444",fontWeight:600},children:C.copiedFromName||"â€”"})}),e.jsx("td",{style:{padding:"11px 16px",opacity:.5,whiteSpace:"nowrap"},children:C.submittedAt?new Date(C.submittedAt).toLocaleDateString():"â€”"})]},o))})]})})]})]})}const Q="http://localhost:3000/api",dt=["#3b82f6","#8b5cf6","#06b6d4","#10b981","#f59e0b"],We="admin-001";function mi(){const{user:t}=As(),{t:j}=Ts(),W=Js(),[N,y]=i.useState(""),[b,x]=i.useState(""),[k,f]=i.useState(0);i.useEffect(()=>{const c=t?.id||t?.userId||We,d=async()=>{try{const E=await I.get(`${Q}/messages/unread/${c}`);f(E.data.unreadCount||0)}catch{}};d();const n=setInterval(d,15e3);return()=>clearInterval(n)},[t]),i.useEffect(()=>{switch(W.pathname.split("/").pop()){case"allocations":y(j("allocations")),x(j("mentor_student_assignments"));break;case"student-leaderboard":y(j("student_leaderboard")),x(j("top_performers"));break;case"mentor-leaderboard":y(j("mentor_leaderboard")),x(j("mentor_activity"));break;case"all-submissions":y(j("all_submissions")),x(j("platform_wide_submissions"));break;case"global-tasks":y(j("global_tasks")),x(j("tasks_visible_all"));break;case"global-problems":y(j("global_problems")),x(j("coding_challenges_all"));break;case"aptitude-tests":y(j("aptitude_tests")),x(j("manage_aptitude_tests"));break;case"global-tests":y(j("global_complete_tests")),x(j("global_tests_subtitle"));break;case"live-monitoring":y(j("global_live_monitoring")),x(j("monitor_all_subtitle"));break;case"operations":y(j("admin_operations")),x(j("admin_ops_subtitle"));break;case"user-management":y("User Management"),x("Create, edit, and manage platform users");break;case"messaging":y("Messaging"),x("Chat with students and mentors");break;case"analytics":y(j("analytics")),x(j("advanced_analytics_subtitle"));break;case"plagiarism":y("Plagiarism Dashboard"),x("Monitor and review plagiarism detection reports");break;case"code-reviews":y("Code Reviews"),x("View all code review comments across the platform");break;case"reports":y("Export Reports"),x("Generate and download platform-wide reports");break;case"skill-tests":y("Skill Tests"),x("Create and manage AI skill assessments");break;case"skill-submissions":y("Skill Test Submissions"),x("View all student skill test results");break;default:y(j("dashboard")),x(j("system_administration"))}},[W,j]);const u=[{path:"/admin",label:j("dashboard"),icon:e.jsx(vr,{size:20})},{label:"Content Management",icon:e.jsx(wt,{size:20}),defaultExpanded:!1,children:[{path:"/admin/global-tasks",label:j("global_tasks"),icon:e.jsx(Oe,{size:20})},{path:"/admin/global-problems",label:j("global_problems"),icon:e.jsx(wt,{size:20})},{path:"/admin/aptitude-tests",label:j("aptitude_tests"),icon:e.jsx(Ne,{size:20})},{path:"/admin/global-tests",label:j("global_complete_tests"),icon:e.jsx(rt,{size:20})},{path:"/admin/skill-tests",label:"Skill Tests",icon:e.jsx(Xe,{size:20})}]},{label:"Allocations",icon:e.jsx(re,{size:20}),defaultExpanded:!1,children:[{path:"/admin/allocations",label:j("allocations"),icon:e.jsx(re,{size:20})}]},{label:"Rankings",icon:e.jsx(et,{size:20}),defaultExpanded:!1,children:[{path:"/admin/student-leaderboard",label:j("student_ranks"),icon:e.jsx(et,{size:20})},{path:"/admin/mentor-leaderboard",label:j("mentor_ranks"),icon:e.jsx(mt,{size:20})}]},{label:"Monitoring",icon:e.jsx(De,{size:20}),defaultExpanded:!1,children:[{path:"/admin/all-submissions",label:j("all_submissions"),icon:e.jsx(Sr,{size:20})},{path:"/admin/skill-submissions",label:"Skill Submissions",icon:e.jsx(Xe,{size:20})},{path:"/admin/live-monitoring",label:j("live_monitoring"),icon:e.jsx(De,{size:20})},{path:"/admin/analytics",label:j("analytics"),icon:e.jsx(It,{size:20})},{path:"/admin/plagiarism",label:"Plagiarism Dashboard",icon:e.jsx(Be,{size:20})},{path:"/admin/code-reviews",label:"Code Reviews",icon:e.jsx(Vt,{size:20})}]},{label:"System",icon:e.jsx(Ct,{size:20}),defaultExpanded:!1,children:[{path:"/admin/operations",label:j("admin_operations"),icon:e.jsx(Ct,{size:20})},{path:"/admin/user-management",label:"User Management",icon:e.jsx(Be,{size:20})},{path:"/admin/messaging",label:"Messaging",icon:e.jsx(Cr,{size:20}),badge:k},{path:"/admin/reports",label:"Export Reports",icon:e.jsx(Ue,{size:20})}]}];return e.jsx(Xs,{navItems:u,title:N,subtitle:b,children:e.jsxs(Ks,{children:[e.jsx(he,{path:"/",element:e.jsx(Qr,{})}),e.jsx(he,{path:"/global-tasks",element:e.jsx(Kr,{})}),e.jsx(he,{path:"/global-problems",element:e.jsx(Xr,{})}),e.jsx(he,{path:"/aptitude-tests",element:e.jsx(ei,{})}),e.jsx(he,{path:"/global-tests",element:e.jsx(Zr,{})}),e.jsx(he,{path:"/skill-tests",element:e.jsx($r,{})}),e.jsx(he,{path:"/skill-submissions",element:e.jsx(zr,{user:t,isAdmin:!0})}),e.jsx(he,{path:"/allocations",element:e.jsx(Ur,{})}),e.jsx(he,{path:"/student-leaderboard",element:e.jsx(Hr,{})}),e.jsx(he,{path:"/mentor-leaderboard",element:e.jsx(Vr,{})}),e.jsx(he,{path:"/all-submissions",element:e.jsx(Gr,{})}),e.jsx(he,{path:"/live-monitoring",element:e.jsx(Tr,{user:t})}),e.jsx(he,{path:"/analytics",element:e.jsx(ti,{})}),e.jsx(he,{path:"/operations",element:e.jsx(Ir,{})}),e.jsx(he,{path:"/user-management",element:e.jsx(Mr,{})}),e.jsx(he,{path:"/messaging",element:e.jsx(Zs,{currentUser:{...t,role:"admin"}})}),e.jsx(he,{path:"/plagiarism",element:e.jsx(Fr,{adminId:t?.id,adminName:t?.name})}),e.jsx(he,{path:"/code-reviews",element:e.jsx(ri,{})}),e.jsx(he,{path:"/reports",element:e.jsx(er,{})})]})})}function Qr(){const[t,j]=i.useState(null),[W,N]=i.useState(!0),[y,b]=i.useState("7d");if(i.useEffect(()=>{I.get(`${Q}/analytics/admin`).then(u=>{j(u.data),N(!1)}).catch(u=>N(!1))},[]),W)return e.jsx("div",{className:"loading-spinner"});if(!t)return e.jsx("div",{children:"Error loading stats"});const x=t.totalStudents>0?Math.round(t.totalSubmissions/t.totalStudents*10)/10:0,k=t.mentorCount||Math.ceil(t.totalStudents/15),f=t.recentSubmissions?.length||0;return e.jsxs("div",{className:"animate-fadeIn",children:[e.jsxs("div",{style:{background:"linear-gradient(135deg, rgba(59, 130, 246, 0.1) 0%, rgba(139, 92, 246, 0.1) 50%, rgba(6, 182, 212, 0.05) 100%)",borderRadius:"20px",padding:"2rem 2.5rem",marginBottom:"2rem",border:"1px solid rgba(59, 130, 246, 0.2)",position:"relative",overflow:"hidden"},children:[e.jsx("div",{style:{position:"absolute",top:"-50%",right:"-10%",width:"400px",height:"400px",background:"radial-gradient(circle, rgba(59, 130, 246, 0.15) 0%, transparent 70%)",pointerEvents:"none"}}),e.jsx("div",{style:{position:"relative",zIndex:1},children:e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"1rem",marginBottom:"0.5rem"},children:[e.jsx("div",{style:{width:"48px",height:"48px",borderRadius:"14px",background:"linear-gradient(135deg, #3b82f6, #8b5cf6)",display:"flex",alignItems:"center",justifyContent:"center",boxShadow:"0 8px 24px rgba(59, 130, 246, 0.3)"},children:e.jsx(Be,{size:24,color:"white"})}),e.jsxs("div",{children:[e.jsx("h1",{style:{margin:0,fontSize:"1.75rem",fontWeight:800,background:"linear-gradient(135deg, #fff, #94a3b8)",WebkitBackgroundClip:"text",WebkitTextFillColor:"transparent"},children:"Admin Control Center"}),e.jsx("p",{style:{margin:0,color:"var(--text-muted)",fontSize:"0.9rem"},children:"Monitor performance, manage content, and track platform health"})]})]})})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(6, 1fr)",gap:"1rem",marginBottom:"2rem"},children:[e.jsxs("div",{style:{background:"var(--bg-card)",border:"1px solid var(--border-color)",borderRadius:"16px",padding:"1.5rem",position:"relative",overflow:"hidden",transition:"all 0.3s ease"},children:[e.jsx("div",{style:{position:"absolute",top:0,right:0,width:"80px",height:"80px",background:"radial-gradient(circle at top right, rgba(59, 130, 246, 0.15), transparent 70%)"}}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"1rem"},children:[e.jsx("div",{style:{width:"48px",height:"48px",borderRadius:"12px",background:"linear-gradient(135deg, #1e40af, #3b82f6)",display:"flex",alignItems:"center",justifyContent:"center",boxShadow:"0 4px 12px rgba(59, 130, 246, 0.3)"},children:e.jsx(re,{size:22,color:"white"})}),e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:"1.75rem",fontWeight:800,color:"var(--text)"},children:t.totalStudents}),e.jsx("div",{style:{fontSize:"0.8rem",color:"var(--text-muted)"},children:"Total Students"})]})]}),e.jsxs("div",{style:{marginTop:"1rem",padding:"0.35rem 0.75rem",background:"rgba(16, 185, 129, 0.1)",borderRadius:"20px",display:"inline-flex",alignItems:"center",gap:"0.35rem",fontSize:"0.75rem",fontWeight:600,color:"#10b981"},children:[e.jsx(It,{size:12})," +12% this month"]})]}),e.jsxs("div",{style:{background:"var(--bg-card)",border:"1px solid var(--border-color)",borderRadius:"16px",padding:"1.5rem",position:"relative",overflow:"hidden"},children:[e.jsx("div",{style:{position:"absolute",top:0,right:0,width:"80px",height:"80px",background:"radial-gradient(circle at top right, rgba(139, 92, 246, 0.15), transparent 70%)"}}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"1rem"},children:[e.jsx("div",{style:{width:"48px",height:"48px",borderRadius:"12px",background:"linear-gradient(135deg, #6d28d9, #8b5cf6)",display:"flex",alignItems:"center",justifyContent:"center",boxShadow:"0 4px 12px rgba(139, 92, 246, 0.3)"},children:e.jsx(mt,{size:22,color:"white"})}),e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:"1.75rem",fontWeight:800,color:"var(--text)"},children:k}),e.jsx("div",{style:{fontSize:"0.8rem",color:"var(--text-muted)"},children:"Active Mentors"})]})]}),e.jsxs("div",{style:{marginTop:"1rem",fontSize:"0.75rem",color:"var(--text-muted)"},children:["~",Math.round(t.totalStudents/k)," students/mentor"]})]}),e.jsxs("div",{style:{background:"var(--bg-card)",border:"1px solid var(--border-color)",borderRadius:"16px",padding:"1.5rem",position:"relative",overflow:"hidden"},children:[e.jsx("div",{style:{position:"absolute",top:0,right:0,width:"80px",height:"80px",background:"radial-gradient(circle at top right, rgba(6, 182, 212, 0.15), transparent 70%)"}}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"1rem"},children:[e.jsx("div",{style:{width:"48px",height:"48px",borderRadius:"12px",background:"linear-gradient(135deg, #0891b2, #06b6d4)",display:"flex",alignItems:"center",justifyContent:"center",boxShadow:"0 4px 12px rgba(6, 182, 212, 0.3)"},children:e.jsx(Gt,{size:22,color:"white"})}),e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:"1.75rem",fontWeight:800,color:"var(--text)"},children:t.totalSubmissions}),e.jsx("div",{style:{fontSize:"0.8rem",color:"var(--text-muted)"},children:"Submissions"})]})]}),e.jsxs("div",{style:{marginTop:"1rem",fontSize:"0.75rem",color:"var(--text-muted)"},children:[x," avg per student"]})]}),e.jsxs("div",{style:{background:"var(--bg-card)",border:"1px solid var(--border-color)",borderRadius:"16px",padding:"1.5rem",position:"relative",overflow:"hidden"},children:[e.jsx("div",{style:{position:"absolute",top:0,right:0,width:"80px",height:"80px",background:"radial-gradient(circle at top right, rgba(16, 185, 129, 0.15), transparent 70%)"}}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"1rem"},children:[e.jsx("div",{style:{width:"48px",height:"48px",borderRadius:"12px",background:"linear-gradient(135deg, #047857, #10b981)",display:"flex",alignItems:"center",justifyContent:"center",boxShadow:"0 4px 12px rgba(16, 185, 129, 0.3)"},children:e.jsx(oe,{size:22,color:"white"})}),e.jsxs("div",{children:[e.jsxs("div",{style:{fontSize:"1.75rem",fontWeight:800,color:"var(--text)"},children:[t.successRate,"%"]}),e.jsx("div",{style:{fontSize:"0.8rem",color:"var(--text-muted)"},children:"Success Rate"})]})]}),e.jsx("div",{style:{marginTop:"1rem",height:"6px",background:"rgba(16, 185, 129, 0.15)",borderRadius:"3px",overflow:"hidden"},children:e.jsx("div",{style:{height:"100%",width:`${t.successRate}%`,background:"linear-gradient(90deg, #10b981, #06b6d4)",borderRadius:"3px",transition:"width 1s ease"}})})]}),e.jsxs("div",{style:{background:"var(--bg-card)",border:"1px solid var(--border-color)",borderRadius:"16px",padding:"1.5rem",position:"relative",overflow:"hidden"},children:[e.jsx("div",{style:{position:"absolute",top:0,right:0,width:"80px",height:"80px",background:"radial-gradient(circle at top right, rgba(245, 158, 11, 0.15), transparent 70%)"}}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"1rem"},children:[e.jsx("div",{style:{width:"48px",height:"48px",borderRadius:"12px",background:"linear-gradient(135deg, #d97706, #f59e0b)",display:"flex",alignItems:"center",justifyContent:"center",boxShadow:"0 4px 12px rgba(245, 158, 11, 0.3)"},children:e.jsx(wt,{size:22,color:"white"})}),e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:"1.75rem",fontWeight:800,color:"var(--text)"},children:t.totalContent}),e.jsx("div",{style:{fontSize:"0.8rem",color:"var(--text-muted)"},children:"Total Content"})]})]}),e.jsx("div",{style:{marginTop:"1rem",fontSize:"0.75rem",color:"var(--text-muted)"},children:"Tasks, Problems & Tests"})]}),e.jsxs("div",{style:{background:"var(--bg-card)",border:"1px solid var(--border-color)",borderRadius:"16px",padding:"1.5rem",position:"relative",overflow:"hidden"},children:[e.jsx("div",{style:{position:"absolute",top:0,right:0,width:"80px",height:"80px",background:"radial-gradient(circle at top right, rgba(236, 72, 153, 0.15), transparent 70%)"}}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"1rem"},children:[e.jsx("div",{style:{width:"48px",height:"48px",borderRadius:"12px",background:"linear-gradient(135deg, #be185d, #ec4899)",display:"flex",alignItems:"center",justifyContent:"center",boxShadow:"0 4px 12px rgba(236, 72, 153, 0.3)"},children:e.jsx(Ze,{size:22,color:"white"})}),e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:"1.75rem",fontWeight:800,color:"var(--text)"},children:f}),e.jsx("div",{style:{fontSize:"0.8rem",color:"var(--text-muted)"},children:"Active Today"})]})]}),e.jsxs("div",{style:{marginTop:"1rem",padding:"0.35rem 0.75rem",background:"rgba(236, 72, 153, 0.1)",borderRadius:"20px",display:"inline-flex",alignItems:"center",gap:"0.35rem",fontSize:"0.75rem",fontWeight:600,color:"#ec4899"},children:[e.jsx(De,{size:12})," Live"]})]})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"2fr 1fr",gap:"1.5rem",marginBottom:"2rem"},children:[e.jsxs("div",{style:{background:"var(--bg-card)",border:"1px solid var(--border-color)",borderRadius:"20px",padding:"1.5rem",position:"relative"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"1.5rem"},children:[e.jsxs("div",{children:[e.jsx("h3",{style:{margin:0,fontSize:"1.1rem",fontWeight:700},children:"Submission Trends"}),e.jsx("p",{style:{margin:"0.25rem 0 0",fontSize:"0.8rem",color:"var(--text-muted)"},children:"Platform activity over time"})]}),e.jsx("div",{style:{display:"flex",gap:"0.5rem"},children:["7d","30d","90d"].map(u=>e.jsx("button",{onClick:()=>b(u),style:{padding:"0.4rem 0.8rem",fontSize:"0.75rem",fontWeight:600,border:"none",borderRadius:"8px",cursor:"pointer",background:y===u?"linear-gradient(135deg, #3b82f6, #8b5cf6)":"var(--bg-tertiary)",color:y===u?"white":"var(--text-muted)",transition:"all 0.2s ease"},children:u},u))})]}),e.jsx("div",{style:{width:"100%",height:"280px"},children:e.jsx(it,{children:e.jsxs(Ss,{data:t.submissionTrends,children:[e.jsx("defs",{children:e.jsxs("linearGradient",{id:"colorCountAdmin",x1:"0",y1:"0",x2:"0",y2:"1",children:[e.jsx("stop",{offset:"5%",stopColor:"#3b82f6",stopOpacity:.4}),e.jsx("stop",{offset:"95%",stopColor:"#3b82f6",stopOpacity:0})]})}),e.jsx(bt,{strokeDasharray:"3 3",stroke:"var(--border-color)",vertical:!1}),e.jsx(ft,{dataKey:"date",stroke:"var(--text-muted)",fontSize:11,axisLine:!1,tickLine:!1}),e.jsx(yt,{stroke:"var(--text-muted)",fontSize:11,axisLine:!1,tickLine:!1}),e.jsx(at,{contentStyle:{background:"var(--bg-card)",border:"1px solid var(--border-color)",borderRadius:"12px",boxShadow:"0 10px 40px rgba(0,0,0,0.3)"},labelStyle:{color:"var(--text)",fontWeight:600},itemStyle:{color:"#3b82f6"}}),e.jsx(Cs,{type:"monotone",dataKey:"count",stroke:"#3b82f6",strokeWidth:3,fillOpacity:1,fill:"url(#colorCountAdmin)"})]})})})]}),e.jsxs("div",{style:{background:"var(--bg-card)",border:"1px solid var(--border-color)",borderRadius:"20px",padding:"1.5rem"},children:[e.jsxs("div",{style:{marginBottom:"1rem"},children:[e.jsx("h3",{style:{margin:0,fontSize:"1.1rem",fontWeight:700},children:"Language Distribution"}),e.jsx("p",{style:{margin:"0.25rem 0 0",fontSize:"0.8rem",color:"var(--text-muted)"},children:"Code submissions by language"})]}),e.jsx("div",{style:{width:"100%",height:"200px"},children:e.jsx(it,{children:e.jsxs(ws,{children:[e.jsx(ks,{data:t.languageStats,cx:"50%",cy:"50%",innerRadius:55,outerRadius:80,paddingAngle:4,dataKey:"value",children:t.languageStats.map((u,c)=>e.jsx(zs,{fill:dt[c%dt.length]},`cell-${c}`))}),e.jsx(at,{contentStyle:{background:"var(--bg-card)",border:"1px solid var(--border-color)",borderRadius:"8px"}})]})})}),e.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(2, 1fr)",gap:"0.75rem",marginTop:"1rem"},children:t.languageStats.map((u,c)=>e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem",fontSize:"0.8rem"},children:[e.jsx("div",{style:{width:"10px",height:"10px",borderRadius:"3px",background:dt[c%dt.length]}}),e.jsx("span",{style:{color:"var(--text-muted)"},children:u.name}),e.jsx("span",{style:{marginLeft:"auto",fontWeight:600},children:u.value})]},u.name))})]})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1.5fr 1fr",gap:"1.5rem"},children:[e.jsxs("div",{style:{background:"var(--bg-card)",border:"1px solid var(--border-color)",borderRadius:"20px",padding:"1.5rem",maxHeight:"420px",display:"flex",flexDirection:"column"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"1.25rem"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.75rem"},children:[e.jsx("div",{style:{width:"36px",height:"36px",borderRadius:"10px",background:"linear-gradient(135deg, #6366f1, #8b5cf6)",display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsx(De,{size:18,color:"white"})}),e.jsxs("div",{children:[e.jsx("h3",{style:{margin:0,fontSize:"1.1rem",fontWeight:700},children:"Recent Activity"}),e.jsx("p",{style:{margin:0,fontSize:"0.75rem",color:"var(--text-muted)"},children:"Live platform submissions"})]})]}),e.jsxs("button",{style:{padding:"0.5rem 1rem",fontSize:"0.75rem",fontWeight:600,background:"var(--bg-tertiary)",border:"1px solid var(--border-color)",borderRadius:"8px",color:"var(--text-muted)",cursor:"pointer",display:"flex",alignItems:"center",gap:"0.4rem"},children:[e.jsx(Te,{size:12})," Refresh"]})]}),e.jsx("div",{style:{flex:1,overflowY:"auto",display:"flex",flexDirection:"column",gap:"0.75rem"},children:t.recentSubmissions.map((u,c)=>e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"1rem",padding:"1rem",background:"var(--bg-tertiary)",borderRadius:"12px",border:"1px solid var(--border-color)",transition:"all 0.2s ease"},children:[e.jsx("div",{style:{width:"10px",height:"10px",borderRadius:"50%",background:u.status==="accepted"?"#10b981":"#ef4444",boxShadow:`0 0 12px ${u.status==="accepted"?"rgba(16, 185, 129, 0.5)":"rgba(239, 68, 68, 0.5)"}`}}),e.jsxs("div",{style:{flex:1},children:[e.jsx("div",{style:{fontWeight:600,fontSize:"0.9rem"},children:u.studentName}),e.jsxs("div",{style:{fontSize:"0.75rem",color:"var(--text-muted)",display:"flex",alignItems:"center",gap:"0.5rem",marginTop:"0.25rem"},children:[e.jsx(Ce,{size:11}),new Date(u.time).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}),e.jsx("span",{style:{opacity:.5},children:"â€¢"}),e.jsx("span",{children:"submitted a solution"})]})]}),e.jsxs("div",{style:{padding:"0.4rem 0.8rem",borderRadius:"8px",fontSize:"0.85rem",fontWeight:700,background:u.status==="accepted"?"rgba(16, 185, 129, 0.1)":"rgba(239, 68, 68, 0.1)",color:u.status==="accepted"?"#10b981":"#ef4444"},children:[u.score,"%"]})]},u.id))})]}),e.jsxs("div",{style:{background:"var(--bg-card)",border:"1px solid var(--border-color)",borderRadius:"20px",padding:"1.5rem"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.75rem",marginBottom:"1.25rem"},children:[e.jsx("div",{style:{width:"36px",height:"36px",borderRadius:"10px",background:"linear-gradient(135deg, #f59e0b, #fbbf24)",display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsx(et,{size:18,color:"white"})}),e.jsxs("div",{children:[e.jsx("h3",{style:{margin:0,fontSize:"1.1rem",fontWeight:700},children:"Top Performers"}),e.jsx("p",{style:{margin:0,fontSize:"0.75rem",color:"var(--text-muted)"},children:"Leading students"})]})]}),e.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"0.75rem"},children:t.studentPerformance.slice(0,5).map((u,c)=>e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"1rem",padding:"1rem",background:c===0?"linear-gradient(135deg, rgba(251, 191, 36, 0.1), rgba(245, 158, 11, 0.05))":"var(--bg-tertiary)",borderRadius:"12px",border:`1px solid ${c===0?"rgba(251, 191, 36, 0.3)":"var(--border-color)"}`},children:[e.jsx("div",{style:{width:"32px",height:"32px",borderRadius:"8px",background:c===0?"linear-gradient(135deg, #fbbf24, #f59e0b)":c===1?"linear-gradient(135deg, #94a3b8, #64748b)":c===2?"linear-gradient(135deg, #d97706, #b45309)":"var(--bg-secondary)",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"0.8rem",fontWeight:700,color:c<3?"white":"var(--text-muted)"},children:c<3?e.jsx(et,{size:14}):`#${c+1}`}),e.jsxs("div",{style:{flex:1},children:[e.jsx("div",{style:{fontWeight:600,fontSize:"0.9rem"},children:u.name}),e.jsxs("div",{style:{fontSize:"0.75rem",color:"var(--text-muted)"},children:[u.count," submissions"]})]}),e.jsxs("div",{style:{fontSize:"1rem",fontWeight:700,color:u.score>=80?"#10b981":u.score>=60?"#f59e0b":"#ef4444"},children:[u.score,"%"]})]},u.name))})]})]})]})}function Ur(){const[t,j]=i.useState([]),[W,N]=i.useState(!0),[y,b]=i.useState(null);return i.useEffect(()=>{I.get(`${Q}/allocations`).then(x=>{j(x.data),N(!1)}).catch(x=>N(!1))},[]),W?e.jsx("div",{className:"loading-spinner"}):e.jsxs("div",{className:"animate-fadeIn",children:[e.jsxs("div",{style:{marginBottom:"2rem"},children:[e.jsx("h2",{style:{fontSize:"1.75rem",fontWeight:800,margin:0},children:"Mentor Allocations"}),e.jsx("p",{style:{color:"var(--text-muted)",margin:"0.25rem 0 0 0"},children:"Manage and view student-mentor assignments"})]}),e.jsx("div",{style:{display:"grid",gap:"1rem"},children:t.map(x=>e.jsxs("div",{className:"card",style:{padding:0,overflow:"hidden"},children:[e.jsxs("div",{style:{padding:"1.5rem 2rem",display:"flex",alignItems:"center",justifyContent:"space-between",cursor:"pointer",background:y===x.mentorId?"rgba(59, 130, 246, 0.05)":"transparent"},onClick:()=>b(y===x.mentorId?null:x.mentorId),children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"1.25rem"},children:[e.jsx("div",{className:"avatar-circle",style:{background:"linear-gradient(135deg, #3b82f6, #06b6d4)"},children:x.mentorName.charAt(0)}),e.jsxs("div",{children:[e.jsx("h3",{style:{margin:0,fontSize:"1.1rem"},children:x.mentorName}),e.jsx("p",{style:{margin:0,fontSize:"0.85rem",color:"var(--text-muted)"},children:x.mentorEmail})]})]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"1.5rem"},children:[e.jsxs("div",{style:{textAlign:"right"},children:[e.jsx("span",{style:{fontSize:"0.9rem",fontWeight:600},children:x.students.length}),e.jsx("span",{style:{fontSize:"0.8rem",color:"var(--text-muted)",marginLeft:"0.5rem"},children:"Students"})]}),e.jsx("div",{style:{transform:y===x.mentorId?"rotate(180deg)":"rotate(0deg)",transition:"transform 0.3s"},children:e.jsx(Gt,{size:18,style:{transform:"rotate(90deg)",color:"var(--text-muted)"}})})]})]}),y===x.mentorId&&e.jsx("div",{style:{padding:"0 2rem 1.5rem",borderTop:"1px solid var(--border-color)"},children:e.jsx("div",{className:"table-container",style:{marginTop:"1.5rem",background:"var(--bg-tertiary)",borderRadius:"0.75rem"},children:e.jsxs("table",{style:{margin:0},children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Student Name"}),e.jsx("th",{children:"Email"}),e.jsx("th",{children:"Batch"}),e.jsx("th",{children:"ID"})]})}),e.jsx("tbody",{children:x.students.map(k=>e.jsxs("tr",{children:[e.jsx("td",{children:k.name}),e.jsx("td",{children:k.email}),e.jsx("td",{children:k.batch}),e.jsx("td",{style:{fontSize:"0.75rem",fontFamily:"monospace",color:"var(--text-muted)"},children:k.id})]},k.id))})]})})})]},x.mentorId))})]})}function Hr(){const[t,j]=i.useState([]),[W,N]=i.useState(!0),[y,b]=i.useState(null),[x,k]=i.useState("");if(i.useEffect(()=>{I.get(`${Q}/leaderboard`).then(c=>{j(c.data),N(!1)}).catch(c=>N(!1))},[]),W)return e.jsx("div",{className:"loading-spinner"});const f=c=>c===1?e.jsx(et,{size:24,style:{color:"#fbbf24"}}):c===2?e.jsx(mt,{size:24,style:{color:"#94a3b8"}}):c===3?e.jsx(mt,{size:24,style:{color:"#b45309"}}):e.jsxs("span",{style:{fontWeight:600,color:"var(--text-muted)"},children:["#",c]}),u=c=>c.violations?(c.violations.tabSwitches||0)+(c.violations.copyPaste||0)+(c.violations.cameraBlocked||0)+(c.violations.phoneDetection||0)+(c.violations.integrityViolations||0)+(c.violations.plagiarism||0):0;return e.jsxs("div",{className:"card animate-fadeIn",style:{padding:"0",overflow:"hidden"},children:[e.jsxs("div",{style:{padding:"2rem"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:"2rem",flexWrap:"wrap",gap:"1rem"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"1rem"},children:[e.jsx(et,{size:32,className:"text-primary"}),e.jsxs("div",{children:[e.jsx("h2",{style:{margin:0},children:"Global Performance Ranking"}),e.jsx("p",{style:{margin:0,color:"var(--text-muted)"},children:"Real-time ranking of students across all mentors"})]})]}),e.jsxs("div",{style:{position:"relative"},children:[e.jsx(Se,{size:18,style:{position:"absolute",left:"1rem",top:"50%",transform:"translateY(-50%)",color:"var(--text-muted)"}}),e.jsx("input",{type:"text",placeholder:"Search students...",value:x,onChange:c=>k(c.target.value),style:{padding:"0.75rem 1rem 0.75rem 2.75rem",borderRadius:"12px",border:"1px solid var(--border-color)",background:"var(--bg-secondary)",color:"var(--text-primary)",outline:"none",width:"300px",fontSize:"0.9rem"}})]})]}),e.jsx("div",{className:"table-container",style:{maxHeight:"600px",overflowY:"auto"},children:e.jsxs("table",{children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Rank"}),e.jsx("th",{children:"Student Name"}),e.jsx("th",{children:"Submissions"}),e.jsx("th",{children:"Avg. Score"}),e.jsx("th",{children:"Violations"}),e.jsx("th",{children:"Status"}),e.jsx("th",{children:"Actions"})]})}),e.jsx("tbody",{children:t.filter(c=>c.name.toLowerCase().includes(x.toLowerCase())).map((c,d)=>{const E=u(c)>0||c.violations?.plagiarism>0;return e.jsxs("tr",{children:[e.jsx("td",{children:e.jsx("div",{style:{display:"flex",alignItems:"center",justifyContent:"center"},children:f(d+1)})}),e.jsx("td",{children:e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.75rem"},children:[e.jsx("div",{className:"avatar-circle",children:c.name.charAt(0)}),e.jsx("span",{children:c.name})]})}),e.jsx("td",{children:c.totalSubmissions}),e.jsx("td",{children:e.jsxs("span",{style:{fontWeight:700,color:"var(--primary)"},children:[c.avgScore,"%"]})}),e.jsx("td",{children:e.jsxs("div",{style:{display:"flex",gap:"0.5rem",flexWrap:"wrap",justifyContent:"center"},children:[c.violations?.tabSwitches>0&&e.jsxs("span",{style:{fontSize:"0.7rem",padding:"2px 8px",borderRadius:"4px",background:"rgba(245, 158, 11, 0.15)",color:"#f59e0b",display:"flex",alignItems:"center",gap:"4px"},title:"Tab Switches",children:[e.jsx(ve,{size:10})," ",c.violations.tabSwitches]}),c.violations?.cameraBlocked>0&&e.jsxs("span",{style:{fontSize:"0.7rem",padding:"2px 8px",borderRadius:"4px",background:"rgba(239, 68, 68, 0.15)",color:"#ef4444",display:"flex",alignItems:"center",gap:"4px"},title:"Camera Blocked",children:["ðŸ“· ",c.violations.cameraBlocked]}),c.violations?.phoneDetection>0&&e.jsxs("span",{style:{fontSize:"0.7rem",padding:"2px 8px",borderRadius:"4px",background:"rgba(239, 68, 68, 0.15)",color:"#ef4444",display:"flex",alignItems:"center",gap:"4px"},title:"Phone Detected",children:["ðŸ“± ",c.violations.phoneDetection]}),c.violations?.copyPaste>0&&e.jsxs("span",{style:{fontSize:"0.7rem",padding:"2px 8px",borderRadius:"4px",background:"rgba(245, 158, 11, 0.15)",color:"#f59e0b",display:"flex",alignItems:"center",gap:"4px"},title:"Copy/Paste Attempts",children:["ðŸ“‹ ",c.violations.copyPaste]}),c.violations?.plagiarism>0&&e.jsxs("span",{style:{fontSize:"0.7rem",padding:"2px 8px",borderRadius:"4px",background:"rgba(239, 68, 68, 0.15)",color:"#ef4444",display:"flex",alignItems:"center",gap:"4px"},title:"Plagiarism",children:[e.jsx(pe,{size:10})," ",c.violations.plagiarism]}),!E&&e.jsx("span",{style:{fontSize:"0.75rem",color:"#10b981"},children:e.jsx(oe,{size:14})})]})}),e.jsx("td",{children:e.jsx("div",{style:{width:"100px",height:"8px",background:"rgba(59, 130, 246, 0.1)",borderRadius:"10px",overflow:"hidden"},children:e.jsx("div",{style:{width:`${c.avgScore}%`,height:"100%",background:E?"var(--warning)":"var(--primary)"}})})}),e.jsx("td",{children:e.jsxs("button",{onClick:()=>b({id:c.studentId,name:c.name}),style:{display:"flex",alignItems:"center",gap:"0.4rem",padding:"0.5rem 0.85rem",background:"linear-gradient(135deg, #8b5cf6, #7c3aed)",border:"none",borderRadius:"8px",color:"white",fontSize:"0.75rem",fontWeight:600,cursor:"pointer",transition:"all 0.2s ease",boxShadow:"0 2px 8px rgba(139, 92, 246, 0.3)"},title:"Generate comprehensive report",children:[e.jsx($e,{size:14}),"Report"]})})]},c.studentId)})})]})})]}),y&&e.jsx(ar,{studentId:y.id,studentName:y.name,onClose:()=>b(null),requestedBy:"Administrator",requestedByRole:"admin"})]})}function Vr(){const[t,j]=i.useState([]),[W,N]=i.useState(!0);return i.useEffect(()=>{I.get(`${Q}/mentor-leaderboard`).then(y=>{j(y.data),N(!1)}).catch(y=>N(!1))},[]),W?e.jsx("div",{className:"loading-spinner"}):e.jsx("div",{className:"card animate-fadeIn",style:{padding:"0",overflow:"hidden"},children:e.jsxs("div",{style:{padding:"2rem"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"1rem",marginBottom:"2rem"},children:[e.jsx(mt,{size:32,style:{color:"#8b5cf6"}}),e.jsxs("div",{children:[e.jsx("h2",{style:{margin:0},children:"Global Mentor Leaderboard"}),e.jsx("p",{style:{margin:0,color:"var(--text-muted)"},children:"Ranking mentors by student success and platform engagement"})]})]}),e.jsx("div",{className:"table-container",children:e.jsxs("table",{children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Mentor"}),e.jsx("th",{children:"Students"}),e.jsx("th",{children:"Content Created"}),e.jsx("th",{children:"Total Submissions"}),e.jsx("th",{children:"Avg. Student Score"})]})}),e.jsx("tbody",{children:t.map(y=>e.jsxs("tr",{children:[e.jsx("td",{children:e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.75rem"},children:[e.jsx("div",{className:"avatar-circle",style:{background:"linear-gradient(135deg, #8b5cf6, #3b82f6)"},children:y.name.charAt(0)}),e.jsx("span",{children:y.name})]})}),e.jsx("td",{children:y.studentCount}),e.jsxs("td",{children:[y.totalContent," items"]}),e.jsx("td",{children:y.totalSubmissions}),e.jsx("td",{children:e.jsxs("span",{style:{fontWeight:700,color:"#8b5cf6"},children:[y.avgStudentScore,"%"]})})]},y.mentorId))})]})})]})})}function Gr(){const[t,j]=i.useState([]),[W,N]=i.useState([]),[y,b]=i.useState([]),[x,k]=i.useState([]),[f,u]=i.useState(!0),[c,d]=i.useState(""),[n,E]=i.useState("all"),[D,g]=i.useState(null),[S,A]=i.useState(null),[C,o]=i.useState(null),[M,w]=i.useState(null),[L,$]=i.useState(!1),te=()=>{u(!0),Promise.all([I.get(`${Q}/submissions`),I.get(`${Q}/aptitude-submissions`),I.get(`${Q}/global-test-submissions`)]).then(([z,_,J])=>{const we=Array.isArray(z.data)?z.data:z.data?.data||[],p=we.filter(Z=>Z.isMLTask).map(Z=>({...Z,subType:"ml-task"})),G=we.filter(Z=>!Z.isMLTask).map(Z=>({...Z,subType:"code"})),h=(_.data||[]).map(Z=>({...Z,subType:"aptitude",itemTitle:Z.testTitle,language:"Aptitude"})),B=(J.data||[]).map(Z=>({...Z,subType:"global",itemTitle:Z.testTitle,language:"Mixed",score:Z.overallPercentage}));j(G),N(p),b(h),k(B),u(!1)}).catch(z=>{console.error("Fetch error:",z),u(!1)})};i.useEffect(()=>{te()},[]);const X=()=>{const z=v();if(z.length===0){alert("No submissions to download");return}const _=["Student Name","Student Email","Type","Problem/Test Title","Language","Score","Status","Tab Switches","Camera Blocked","Phone Detected","Plagiarism Detected","Submitted At"],J=z.map(B=>[B.studentName||"",B.studentEmail||"",B.subType==="aptitude"?"Aptitude":B.subType==="global"?"Global":"Code",B.itemTitle||B.testTitle||"",B.subType==="aptitude"?"N/A":B.subType==="global"?"Mixed":B.language||"N/A",B.score||0,B.status||"",B.integrity?.tabSwitches||B.tabSwitches||0,B.cameraBlockedCount||0,B.phoneDetectionCount||0,B.plagiarism?.detected?"Yes":"No",B.submittedAt?new Date(B.submittedAt).toLocaleString():""]),we=[_.join(","),...J.map(B=>B.map(Z=>{const xe=String(Z);return xe.includes(",")||xe.includes('"')||xe.includes(`
`)?`"${xe.replace(/"/g,'""')}"`:xe}).join(","))].join(`
`),p=new Blob([we],{type:"text/csv;charset=utf-8;"}),G=document.createElement("a"),h=URL.createObjectURL(p);G.setAttribute("href",h),G.setAttribute("download",`submissions_${n}_${new Date().toISOString().split("T")[0]}.csv`),G.style.visibility="hidden",document.body.appendChild(G),G.click(),document.body.removeChild(G)},ee=async()=>{if(!(!window.confirm(`âš ï¸ WARNING: This will permanently delete ALL submissions from ALL students!

This includes:
â€¢ All code submissions
â€¢ All aptitude test submissions
â€¢ All problem completions
â€¢ All task completions

This action CANNOT be undone. Are you sure?`)||!window.confirm(`ðŸš¨ FINAL CONFIRMATION ðŸš¨

You are about to delete ALL submissions permanently.

Type OK to proceed.`))){$(!0);try{const J=await I.delete(`${Q}/submissions`);alert(`âœ… Reset Complete!

â€¢ Code submissions deleted: ${J.data.deletedCodeSubmissions}
â€¢ Aptitude submissions deleted: ${J.data.deletedAptitudeSubmissions}
â€¢ Global test submissions deleted: ${J.data.deletedGlobalSubmissions||0}`),te()}catch(J){alert("âŒ Failed to reset submissions: "+(J.response?.data?.error||J.message))}finally{$(!1)}}},ne=[...t,...W,...y,...x].sort((z,_)=>new Date(_.submittedAt)-new Date(z.submittedAt)),v=()=>(n==="all"?ne:n==="code"?t:n==="ml-task"?W:n==="aptitude"?y:x).filter(_=>(_.studentName||"").toLowerCase().includes(c.toLowerCase())||(_.itemTitle||_.testTitle||"").toLowerCase().includes(c.toLowerCase())||_.status.toLowerCase().includes(c.toLowerCase())),Y=v();return f?e.jsx("div",{className:"loading-spinner"}):e.jsxs("div",{className:"animate-fadeIn",children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-end",marginBottom:"2rem"},children:[e.jsxs("div",{children:[e.jsx("h2",{style:{fontSize:"1.75rem",fontWeight:800,margin:0},children:"Submission Archives"}),e.jsx("p",{style:{color:"var(--text-muted)",margin:"0.25rem 0 0 0"},children:"Global audit trail of all submissions"})]}),e.jsxs("div",{style:{display:"flex",gap:"1rem",alignItems:"center"},children:[e.jsxs("div",{style:{display:"flex",borderRadius:"8px",overflow:"hidden",border:"1px solid var(--border-color)"},children:[e.jsxs("button",{onClick:()=>E("all"),style:{padding:"0.5rem 1rem",background:n==="all"?"var(--primary)":"transparent",border:"none",color:n==="all"?"white":"var(--text-muted)",cursor:"pointer",fontSize:"0.85rem"},children:["All (",ne.length,")"]}),e.jsxs("button",{onClick:()=>E("code"),style:{padding:"0.5rem 1rem",background:n==="code"?"var(--primary)":"transparent",border:"none",color:n==="code"?"white":"var(--text-muted)",cursor:"pointer",fontSize:"0.85rem"},children:["ðŸ’» Code (",t.length,")"]}),e.jsxs("button",{onClick:()=>E("ml-task"),style:{padding:"0.5rem 1rem",background:n==="ml-task"?"#06b6d4":"transparent",border:"none",color:n==="ml-task"?"white":"var(--text-muted)",cursor:"pointer",fontSize:"0.85rem"},children:["ðŸ§  ML Tasks (",W.length,")"]}),e.jsxs("button",{onClick:()=>E("aptitude"),style:{padding:"0.5rem 1rem",background:n==="aptitude"?"#8b5cf6":"transparent",border:"none",color:n==="aptitude"?"white":"var(--text-muted)",cursor:"pointer",fontSize:"0.85rem"},children:["ðŸ“ Aptitude (",y.length,")"]}),e.jsxs("button",{onClick:()=>E("global"),style:{padding:"0.5rem 1rem",background:n==="global"?"#3b82f6":"transparent",border:"none",color:n==="global"?"white":"var(--text-muted)",cursor:"pointer",fontSize:"0.85rem"},children:["ðŸŒ Global (",x.length,")"]})]}),e.jsxs("div",{style:{position:"relative"},children:[e.jsx(Se,{size:18,style:{position:"absolute",left:"12px",top:"50%",transform:"translateY(-50%)",color:"var(--text-muted)"}}),e.jsx("input",{type:"text",placeholder:"Search student, problem or status...",style:{padding:"0.6rem 1rem 0.6rem 2.5rem",background:"var(--bg-card)",border:"1px solid var(--border-color)",borderRadius:"8px",color:"white",width:"300px"},value:c,onChange:z=>d(z.target.value)})]}),e.jsxs("button",{onClick:X,disabled:Y.length===0,style:{padding:"0.6rem 1rem",background:"rgba(16, 185, 129, 0.1)",border:"1px solid rgba(16, 185, 129, 0.3)",borderRadius:"8px",color:"#10b981",cursor:Y.length===0?"not-allowed":"pointer",fontSize:"0.85rem",fontWeight:600,display:"flex",alignItems:"center",gap:"0.5rem",opacity:Y.length===0?.5:1,transition:"all 0.2s ease"},onMouseEnter:z=>{Y.length>0&&(z.target.style.background="rgba(16, 185, 129, 0.2)")},onMouseLeave:z=>{z.target.style.background="rgba(16, 185, 129, 0.1)"},children:[e.jsx(Ue,{size:16}),"Download CSV"]}),e.jsxs("button",{onClick:ee,disabled:L||ne.length===0,style:{padding:"0.6rem 1rem",background:"rgba(239, 68, 68, 0.1)",border:"1px solid rgba(239, 68, 68, 0.3)",borderRadius:"8px",color:"#ef4444",cursor:L||ne.length===0?"not-allowed":"pointer",fontSize:"0.85rem",fontWeight:600,display:"flex",alignItems:"center",gap:"0.5rem",opacity:L||ne.length===0?.5:1,transition:"all 0.2s ease"},onMouseEnter:z=>{!L&&ne.length>0&&(z.target.style.background="rgba(239, 68, 68, 0.2)")},onMouseLeave:z=>{z.target.style.background="rgba(239, 68, 68, 0.1)"},children:[e.jsx(Le,{size:16}),L?"Resetting...":"Reset All"]})]})]}),e.jsx("div",{className:"table-container card glass",children:e.jsxs("table",{children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Student"}),e.jsx("th",{children:"Type"}),e.jsx("th",{children:"Problem / Test"}),e.jsx("th",{children:"Language"}),e.jsx("th",{children:"Score"}),e.jsx("th",{children:"Status"}),e.jsx("th",{children:"Submitted At"}),e.jsx("th",{children:"Actions"})]})}),e.jsx("tbody",{children:Y.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:"8",style:{textAlign:"center",padding:"3rem"},children:"No submissions found"})}):Y.map(z=>e.jsxs("tr",{children:[e.jsx("td",{children:e.jsx("div",{style:{fontWeight:600},children:z.studentName})}),e.jsx("td",{children:e.jsx("span",{style:{fontSize:"0.75rem",padding:"2px 8px",borderRadius:"4px",background:z.subType==="aptitude"?"rgba(139, 92, 246, 0.1)":"rgba(59, 130, 246, 0.1)",color:z.subType==="ml-task"?"#06b6d4":z.subType==="aptitude"?"#8b5cf6":"var(--primary)"},children:z.subType==="ml-task"?"ðŸ§  ML Task":z.subType==="aptitude"?"ðŸ“ Aptitude":z.subType==="global"?"ðŸŒ Global":"ðŸ’» Code"})}),e.jsx("td",{children:e.jsx("div",{style:{color:"var(--primary)",fontWeight:500},children:z.itemTitle||z.testTitle})}),e.jsx("td",{children:e.jsx("span",{style:{fontSize:"0.75rem",padding:"2px 8px",borderRadius:"4px",background:"rgba(59, 130, 246, 0.1)",color:"var(--primary)"},children:z.subType==="aptitude"?"N/A":z.subType==="global"?"Mixed":z.language?.toUpperCase()||"N/A"})}),e.jsxs("td",{style:{fontWeight:700,fontSize:"1.1rem"},children:[z.score,"%"]}),e.jsx("td",{children:e.jsxs("div",{style:{display:"flex",flexWrap:"wrap",gap:"0.25rem",alignItems:"center"},children:[e.jsx("span",{className:`status-badge ${z.status}`,children:z.status}),z.plagiarism?.detected&&e.jsxs("span",{className:"status-badge plagiarized",style:{display:"flex",alignItems:"center",gap:"3px"},children:[e.jsx(pe,{size:11})," Plag"]}),(z.integrity?.integrityViolation||z.tabSwitches>0)&&e.jsxs("span",{style:{fontSize:"0.65rem",padding:"2px 6px",borderRadius:"4px",background:"rgba(245, 158, 11, 0.15)",color:"#f59e0b",border:"1px solid rgba(245, 158, 11, 0.3)",display:"flex",alignItems:"center",gap:"3px"},children:[e.jsx(pe,{size:10})," ",z.integrity?.tabSwitches||z.tabSwitches||0," Tab"]}),z.cameraBlockedCount>0&&e.jsxs("span",{style:{fontSize:"0.65rem",padding:"2px 6px",borderRadius:"4px",background:"rgba(239, 68, 68, 0.15)",color:"#ef4444",border:"1px solid rgba(239, 68, 68, 0.3)",display:"flex",alignItems:"center",gap:"3px"},children:["ðŸ“· ",z.cameraBlockedCount," Cam"]}),z.phoneDetectionCount>0&&e.jsxs("span",{style:{fontSize:"0.65rem",padding:"2px 6px",borderRadius:"4px",background:"rgba(239, 68, 68, 0.15)",color:"#ef4444",border:"1px solid rgba(239, 68, 68, 0.3)",display:"flex",alignItems:"center",gap:"3px"},children:["ðŸ“± ",z.phoneDetectionCount," Phone"]})]})}),e.jsx("td",{style:{fontSize:"0.85rem",color:"var(--text-muted)"},children:new Date(z.submittedAt).toLocaleString()}),e.jsx("td",{children:z.subType==="aptitude"?e.jsxs("button",{onClick:()=>o(z),style:{background:"rgba(139, 92, 246, 0.1)",border:"none",color:"#8b5cf6",padding:"0.4rem 0.75rem",borderRadius:"6px",cursor:"pointer",fontSize:"0.8rem",display:"flex",alignItems:"center",gap:"4px"},children:[e.jsx(ve,{size:14})," Results"]}):z.subType==="global"?e.jsxs("button",{onClick:()=>w(z.id),style:{background:"rgba(59, 130, 246, 0.1)",border:"none",color:"#3b82f6",padding:"0.4rem 0.75rem",borderRadius:"6px",cursor:"pointer",fontSize:"0.8rem",display:"flex",alignItems:"center",gap:"4px"},children:[e.jsx(ve,{size:14})," Full Report"]}):z.subType==="ml-task"?e.jsxs("button",{onClick:()=>A(z),style:{background:"rgba(6, 182, 212, 0.1)",border:"none",color:"#06b6d4",padding:"0.4rem 0.75rem",borderRadius:"6px",cursor:"pointer",fontSize:"0.8rem",display:"flex",alignItems:"center",gap:"4px"},children:[e.jsx(ve,{size:14})," ML Report"]}):e.jsxs("button",{onClick:()=>g(z),style:{background:"rgba(59, 130, 246, 0.1)",border:"none",color:"#3b82f6",padding:"0.4rem 0.75rem",borderRadius:"6px",cursor:"pointer",fontSize:"0.8rem",display:"flex",alignItems:"center",gap:"4px"},children:[e.jsx(ve,{size:14})," Report"]})})]},z.id))})]})}),C&&e.jsx(tr,{submission:C,onClose:()=>o(null)}),M&&e.jsx(sr,{submissionId:M,onClose:()=>w(null),isStudentView:!1}),S&&e.jsx(Yr,{submission:S,onClose:()=>A(null)}),D&&e.jsx(Jr,{submission:D,onClose:()=>g(null)})]})}function Yr({submission:t,onClose:j}){const W=(t.submissionType||"").includes("github"),N=b=>{if(!b||b==="N/A")return null;const x=b.match(/(\d+)/);return x?parseInt(x[1]):null},y=[{label:"Correctness",value:N(t.analysis?.correctness),color:"#3b82f6"},{label:"Code Quality",value:N(t.analysis?.efficiency),color:"#8b5cf6"},{label:"Documentation",value:N(t.analysis?.codeStyle),color:"#06b6d4"},{label:"Model Performance",value:N(t.analysis?.bestPractices),color:"#10b981"}].filter(b=>b.value!==null);return e.jsx("div",{className:"modal-overlay",onClick:j,children:e.jsxs("div",{className:"modal-content",onClick:b=>b.stopPropagation(),style:{maxWidth:"800px",maxHeight:"90vh",overflowY:"auto"},children:[e.jsxs("div",{className:"modal-header",children:[e.jsxs("div",{className:"modal-title-with-icon",children:[e.jsx("div",{style:{width:"40px",height:"40px",borderRadius:"10px",background:"linear-gradient(135deg, #06b6d4, #0891b2)",display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsx(Xe,{size:20,color:"white"})}),e.jsxs("div",{children:[e.jsx("span",{style:{fontSize:"0.7rem",color:"#06b6d4",textTransform:"uppercase",fontWeight:600},children:"ML Task Report"}),e.jsx("h2",{style:{margin:0,fontSize:"1.1rem"},children:t.itemTitle||"ML Task"})]})]}),e.jsx("button",{onClick:j,className:"modal-close",children:e.jsx(Me,{size:20})})]}),e.jsxs("div",{className:"modal-body",style:{padding:"1.5rem"},children:[e.jsxs("div",{style:{marginBottom:"1.5rem",padding:"1rem",background:"var(--bg-tertiary)",borderRadius:"0.5rem",border:"1px solid var(--border-color)",display:"flex",alignItems:"center",justifyContent:"space-between"},children:[e.jsxs("div",{children:[e.jsx("span",{style:{fontSize:"0.8rem",color:"var(--text-muted)"},children:"Student Name"}),e.jsx("div",{style:{fontWeight:600,fontSize:"1rem"},children:t.studentName})]}),e.jsxs("div",{style:{textAlign:"right"},children:[e.jsx("span",{style:{fontSize:"0.8rem",color:"var(--text-muted)"},children:"Submitted On"}),e.jsx("div",{style:{fontWeight:500},children:new Date(t.submittedAt).toLocaleString()})]})]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"2rem",marginBottom:"2rem",padding:"1.5rem",borderRadius:"1rem",background:t.status==="accepted"?"rgba(16, 185, 129, 0.05)":"rgba(239, 68, 68, 0.05)",border:`1px solid ${t.status==="accepted"?"rgba(16, 185, 129, 0.2)":"rgba(239, 68, 68, 0.2)"}`},children:[e.jsx("div",{style:{width:"90px",height:"90px",borderRadius:"50%",background:`conic-gradient(${t.score>=80?"#10b981":t.score>=60?"#f59e0b":"#ef4444"} ${(t.score||0)*3.6}deg, rgba(255,255,255,0.05) 0deg)`,display:"flex",alignItems:"center",justifyContent:"center",flexShrink:0},children:e.jsxs("div",{style:{width:"76px",height:"76px",borderRadius:"50%",background:"var(--bg-card)",display:"flex",alignItems:"center",justifyContent:"center",flexDirection:"column"},children:[e.jsx("span",{style:{fontSize:"1.6rem",fontWeight:800,color:"var(--text-main)"},children:t.score}),e.jsx("span",{style:{fontSize:"0.65rem",color:"var(--text-muted)"},children:"SCORE"})]})}),e.jsxs("div",{children:[e.jsxs("div",{style:{display:"inline-flex",alignItems:"center",gap:"0.5rem",padding:"0.4rem 1rem",borderRadius:"2rem",marginBottom:"0.5rem",background:t.status==="accepted"?"rgba(16, 185, 129, 0.15)":"rgba(239, 68, 68, 0.15)",color:t.status==="accepted"?"#10b981":"#ef4444",fontWeight:700,fontSize:"0.9rem"},children:[t.status==="accepted"?e.jsx(oe,{size:16}):e.jsx(Me,{size:16}),(t.status||"pending").toUpperCase()]}),e.jsx("div",{style:{display:"flex",gap:"1rem",flexWrap:"wrap",marginTop:"0.5rem"},children:e.jsx("span",{style:{fontSize:"0.8rem",color:"#06b6d4",fontWeight:600},children:W?"ðŸ”— GitHub Submission":"ðŸ“ File Upload"})})]})]}),y.length>0&&e.jsxs("div",{style:{marginBottom:"2rem"},children:[e.jsxs("h4",{style:{margin:"0 0 1rem",display:"flex",alignItems:"center",gap:"0.5rem",color:"var(--text-main)"},children:[e.jsx(Dt,{size:18,color:"#06b6d4"})," Performance Metrics"]}),e.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(180px, 1fr))",gap:"1rem"},children:y.map(b=>e.jsxs("div",{style:{background:"var(--bg-dark)",padding:"1rem",borderRadius:"0.75rem",border:"1px solid var(--border-color)"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:"0.5rem"},children:[e.jsx("span",{style:{fontSize:"0.8rem",color:"var(--text-muted)"},children:b.label}),e.jsxs("span",{style:{fontWeight:700,color:b.value>=80?"#10b981":b.value>=60?"#f59e0b":"#ef4444"},children:[b.value,"%"]})]}),e.jsx("div",{style:{height:"6px",background:"rgba(255,255,255,0.05)",borderRadius:"3px",overflow:"hidden"},children:e.jsx("div",{style:{width:`${b.value}%`,height:"100%",background:b.color,borderRadius:"3px",transition:"width 1s ease-out"}})})]},b.label))})]}),e.jsxs("div",{style:{marginBottom:"1.5rem"},children:[e.jsxs("h4",{style:{margin:"0 0 0.75rem",display:"flex",alignItems:"center",gap:"0.5rem"},children:[e.jsx(Ve,{size:18,color:"#06b6d4"})," AI Feedback"]}),e.jsx("div",{style:{background:"var(--bg-dark)",padding:"1.25rem",borderRadius:"0.75rem",border:"1px solid var(--border-color)",whiteSpace:"pre-wrap",color:"var(--text-muted)",fontSize:"0.9rem",lineHeight:"1.7",maxHeight:"300px",overflowY:"auto"},children:t.feedback||"No feedback provided."})]}),t.aiExplanation&&e.jsxs("div",{style:{marginBottom:"1.5rem"},children:[e.jsxs("h4",{style:{margin:"0 0 0.75rem",display:"flex",alignItems:"center",gap:"0.5rem"},children:[e.jsx(ve,{size:18,color:"#8b5cf6"})," Summary"]}),e.jsx("div",{style:{background:"rgba(139, 92, 246, 0.05)",padding:"1rem",borderRadius:"0.75rem",border:"1px solid rgba(139, 92, 246, 0.2)",color:"var(--text-muted)",fontSize:"0.9rem",lineHeight:"1.6"},children:t.aiExplanation})]}),e.jsxs("div",{children:[e.jsxs("h4",{style:{margin:"0 0 0.75rem",display:"flex",alignItems:"center",gap:"0.5rem"},children:[W?e.jsx(Vt,{size:18,color:"var(--text-main)"}):e.jsx($e,{size:18,color:"var(--text-main)"}),W?"GitHub Repository":"Submitted Code"]}),W?e.jsx("div",{style:{background:"var(--bg-dark)",padding:"1rem",borderRadius:"0.75rem",border:"1px solid var(--border-color)"},children:e.jsxs("a",{href:t.code,target:"_blank",rel:"noopener noreferrer",style:{color:"#3b82f6",display:"flex",alignItems:"center",gap:"0.5rem",textDecoration:"none"},children:[e.jsx(wr,{size:16})," ",t.code]})}):e.jsx("pre",{style:{background:"var(--bg-dark)",padding:"1.25rem",borderRadius:"0.75rem",overflow:"auto",maxHeight:"300px",fontSize:"0.8rem",fontFamily:"monospace",color:"var(--text-main)",border:"1px solid var(--border-color)",lineHeight:"1.6"},children:t.code})]})]})]})})}function Jr({submission:t,onClose:j}){return e.jsx("div",{className:"modal-overlay",onClick:j,children:e.jsxs("div",{className:"modal-content",onClick:W=>W.stopPropagation(),style:{maxWidth:"900px"},children:[e.jsxs("div",{className:"modal-header",children:[e.jsxs("div",{className:"modal-title-with-icon",children:[e.jsx("div",{style:{width:"40px",height:"40px",borderRadius:"10px",background:t.status==="accepted"?"linear-gradient(135deg, #10b981, #06b6d4)":"linear-gradient(135deg, #ef4444, #f59e0b)",display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsx($e,{size:20,color:"white"})}),e.jsx("h2",{children:"Detailed Submission Report"})]}),e.jsx("button",{onClick:j,className:"modal-close",children:e.jsx(le,{size:20})})]}),e.jsxs("div",{className:"modal-body",style:{maxHeight:"70vh",overflowY:"auto"},children:[e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(4, 1fr)",gap:"1rem",marginBottom:"2rem",padding:"1.5rem",background:"rgba(59, 130, 246, 0.05)",borderRadius:"1rem",border:"1px solid rgba(59, 130, 246, 0.1)"},children:[e.jsxs("div",{children:[e.jsx("span",{style:{color:"var(--text-muted)",fontSize:"0.8rem"},children:"Student Name"}),e.jsx("p",{style:{margin:"0.25rem 0 0",fontWeight:600,fontSize:"1.1rem"},children:t.studentName})]}),e.jsxs("div",{children:[e.jsx("span",{style:{color:"var(--text-muted)",fontSize:"0.8rem"},children:"Submitted At"}),e.jsx("p",{style:{margin:"0.25rem 0 0",fontWeight:600},children:new Date(t.submittedAt).toLocaleString()})]}),e.jsxs("div",{children:[e.jsx("span",{style:{color:"var(--text-muted)",fontSize:"0.8rem"},children:"Language"}),e.jsx("p",{style:{margin:"0.25rem 0 0",fontWeight:600},children:t.language})]}),e.jsxs("div",{children:[e.jsx("span",{style:{color:"var(--text-muted)",fontSize:"0.8rem"},children:"Submission Type"}),e.jsx("p",{style:{margin:"0.25rem 0 0",fontWeight:600},children:t.submissionType==="file"?"File Upload":"Code Editor"})]})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",gap:"3rem",marginBottom:"2rem",padding:"2rem",background:t.status==="accepted"?"rgba(16, 185, 129, 0.05)":"rgba(239, 68, 68, 0.05)",borderRadius:"1rem",border:`1px solid ${t.status==="accepted"?"rgba(16, 185, 129, 0.2)":"rgba(239, 68, 68, 0.2)"}`},children:[e.jsxs("div",{style:{textAlign:"center"},children:[e.jsx("div",{style:{fontSize:"3rem",fontWeight:800,color:t.status==="accepted"?"#10b981":"#ef4444"},children:t.score}),e.jsx("div",{style:{color:"var(--text-muted)"},children:"AI Evaluation Score"})]}),e.jsxs("div",{style:{padding:"1rem 2rem",borderRadius:"1rem",background:t.status==="accepted"?"rgba(16, 185, 129, 0.1)":"rgba(239, 68, 68, 0.1)",color:t.status==="accepted"?"#10b981":"#ef4444",fontWeight:700,fontSize:"1.25rem",display:"flex",alignItems:"center",gap:"0.5rem"},children:[t.status==="accepted"?e.jsx(oe,{size:24}):e.jsx(le,{size:24}),t.status?.toUpperCase()]})]}),t.plagiarism?.detected&&e.jsxs("div",{className:"plagiarism-banner",style:{marginBottom:"1.5rem"},children:[e.jsx(pe,{size:24,color:"#ef4444"}),e.jsxs("div",{children:[e.jsx("strong",{style:{color:"#ef4444"},children:"Plagiarism Detected"}),e.jsxs("p",{style:{margin:"0.25rem 0 0",color:"var(--text-muted)"},children:["This code matches a submission from ",t.plagiarism.copiedFromName]})]})]}),(t.tabSwitches>0||t.copyPasteAttempts>0||t.cameraBlockedCount>0||t.phoneDetectionCount>0)&&e.jsxs("div",{style:{marginBottom:"1.5rem",padding:"1.5rem",background:"rgba(239, 68, 68, 0.05)",borderRadius:"1rem",border:"1px solid rgba(239, 68, 68, 0.2)"},children:[e.jsxs("h4",{style:{margin:"0 0 1rem",display:"flex",alignItems:"center",gap:"0.5rem",color:"#f59e0b"},children:[e.jsx(pe,{size:18})," Proctoring Violations"]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(2, 1fr)",gap:"1rem"},children:[t.tabSwitches>0&&e.jsxs("div",{style:{padding:"0.75rem",background:"rgba(245, 158, 11, 0.1)",borderRadius:"0.5rem",display:"flex",alignItems:"center",gap:"0.75rem"},children:[e.jsx(ve,{size:18,color:"#f59e0b"}),e.jsxs("div",{children:[e.jsxs("div",{style:{fontWeight:600,color:"#f59e0b"},children:[t.tabSwitches," Tab Switches"]}),e.jsxs("div",{style:{fontSize:"0.75rem",color:"var(--text-muted)"},children:["Penalty: -",Math.min(t.tabSwitches*5,25)," pts"]})]})]}),t.copyPasteAttempts>0&&e.jsxs("div",{style:{padding:"0.75rem",background:"rgba(245, 158, 11, 0.1)",borderRadius:"0.5rem",display:"flex",alignItems:"center",gap:"0.75rem"},children:[e.jsx("span",{style:{fontSize:"1.1rem"},children:"ðŸ“‹"}),e.jsxs("div",{children:[e.jsxs("div",{style:{fontWeight:600,color:"#f59e0b"},children:[t.copyPasteAttempts," Copy/Paste"]}),e.jsxs("div",{style:{fontSize:"0.75rem",color:"var(--text-muted)"},children:["Penalty: -",Math.min(t.copyPasteAttempts*3,15)," pts"]})]})]}),t.cameraBlockedCount>0&&e.jsxs("div",{style:{padding:"0.75rem",background:"rgba(239, 68, 68, 0.1)",borderRadius:"0.5rem",display:"flex",alignItems:"center",gap:"0.75rem"},children:[e.jsx("span",{style:{fontSize:"1.1rem"},children:"ðŸ“·"}),e.jsxs("div",{children:[e.jsxs("div",{style:{fontWeight:600,color:"#ef4444"},children:[t.cameraBlockedCount," Camera Blocked"]}),e.jsxs("div",{style:{fontSize:"0.75rem",color:"var(--text-muted)"},children:["Penalty: -",Math.min(t.cameraBlockedCount*10,30)," pts"]})]})]}),t.phoneDetectionCount>0&&e.jsxs("div",{style:{padding:"0.75rem",background:"rgba(239, 68, 68, 0.1)",borderRadius:"0.5rem",display:"flex",alignItems:"center",gap:"0.75rem"},children:[e.jsx("span",{style:{fontSize:"1.1rem"},children:"ðŸ“±"}),e.jsxs("div",{children:[e.jsxs("div",{style:{fontWeight:600,color:"#ef4444"},children:[t.phoneDetectionCount," Phone Detected"]}),e.jsxs("div",{style:{fontSize:"0.75rem",color:"var(--text-muted)"},children:["Penalty: -",Math.min(t.phoneDetectionCount*15,45)," pts"]})]})]})]}),t.proctoringVideo&&e.jsxs("div",{style:{marginTop:"1rem",padding:"0.75rem",background:"rgba(59, 130, 246, 0.1)",borderRadius:"0.5rem",display:"flex",alignItems:"center",gap:"0.5rem"},children:[e.jsx("span",{style:{fontSize:"1rem"},children:"ðŸŽ¥"}),e.jsxs("span",{style:{fontSize:"0.85rem",color:"#3b82f6"},children:["Proctoring video recorded: ",t.proctoringVideo]})]})]}),e.jsxs("div",{style:{marginBottom:"1.5rem"},children:[e.jsxs("h4",{style:{margin:"0 0 0.75rem",display:"flex",alignItems:"center",gap:"0.5rem"},children:[e.jsx(oe,{size:18,color:"#3b82f6"})," AI Feedback"]}),e.jsx("p",{style:{color:"var(--text-muted)",lineHeight:"1.6",background:"var(--bg-tertiary)",padding:"1rem",borderRadius:"0.5rem",border:"1px solid var(--border-color)"},children:t.feedback||"No feedback provided."})]}),t.aiExplanation&&e.jsxs("div",{style:{marginBottom:"1.5rem"},children:[e.jsxs("h4",{style:{margin:"0 0 0.75rem",display:"flex",alignItems:"center",gap:"0.5rem"},children:[e.jsx(De,{size:18,color:"#8b5cf6"})," AI Explanation (Why this score?)"]}),e.jsx("p",{style:{color:"var(--text-muted)",lineHeight:"1.6",background:"rgba(139, 92, 246, 0.05)",padding:"1rem",borderRadius:"0.5rem",border:"1px solid rgba(139, 92, 246, 0.1)"},children:t.aiExplanation})]}),t.analysis&&e.jsxs("div",{style:{marginBottom:"1.5rem"},children:[e.jsxs("h4",{style:{margin:"0 0 1rem",display:"flex",alignItems:"center",gap:"0.5rem"},children:[e.jsx(Fe,{size:18,color:"var(--primary)"})," Detailed Analysis"]}),e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"0.75rem"},children:[t.analysis.correctness!==void 0&&e.jsxs("div",{style:{background:"var(--bg-tertiary)",padding:"1rem 1.25rem",borderRadius:"0.75rem",display:"flex",alignItems:"center",gap:"1rem",border:"1px solid rgba(59, 130, 246, 0.2)"},children:[e.jsx("div",{style:{width:"42px",height:"42px",borderRadius:"10px",background:"rgba(59, 130, 246, 0.15)",display:"flex",alignItems:"center",justifyContent:"center",flexShrink:0},children:e.jsx(oe,{size:22,color:"#3b82f6"})}),e.jsxs("div",{style:{flex:1},children:[e.jsx("span",{style:{color:"var(--text-muted)",fontSize:"0.8rem",display:"block",marginBottom:"0.25rem"},children:"Correctness"}),e.jsx("p",{style:{margin:0,fontWeight:700,fontSize:"1.1rem",color:"#3b82f6"},children:t.analysis.correctness})]})]}),t.analysis.efficiency!==void 0&&e.jsxs("div",{style:{background:"var(--bg-tertiary)",padding:"1rem 1.25rem",borderRadius:"0.75rem",display:"flex",alignItems:"center",gap:"1rem",border:"1px solid rgba(16, 185, 129, 0.2)"},children:[e.jsx("div",{style:{width:"42px",height:"42px",borderRadius:"10px",background:"rgba(16, 185, 129, 0.15)",display:"flex",alignItems:"center",justifyContent:"center",flexShrink:0},children:e.jsx(Ze,{size:22,color:"#10b981"})}),e.jsxs("div",{style:{flex:1},children:[e.jsx("span",{style:{color:"var(--text-muted)",fontSize:"0.8rem",display:"block",marginBottom:"0.25rem"},children:"Efficiency"}),e.jsx("p",{style:{margin:0,fontWeight:700,fontSize:"1.1rem",color:"#10b981"},children:t.analysis.efficiency})]})]}),t.analysis.codeStyle!==void 0&&e.jsxs("div",{style:{background:"var(--bg-tertiary)",padding:"1rem 1.25rem",borderRadius:"0.75rem",display:"flex",alignItems:"center",gap:"1rem",border:"1px solid rgba(139, 92, 246, 0.2)"},children:[e.jsx("div",{style:{width:"42px",height:"42px",borderRadius:"10px",background:"rgba(139, 92, 246, 0.15)",display:"flex",alignItems:"center",justifyContent:"center",flexShrink:0},children:e.jsx(Re,{size:22,color:"#8b5cf6"})}),e.jsxs("div",{style:{flex:1},children:[e.jsx("span",{style:{color:"var(--text-muted)",fontSize:"0.8rem",display:"block",marginBottom:"0.25rem"},children:"Code Style"}),e.jsx("p",{style:{margin:0,fontWeight:700,fontSize:"1.1rem",color:"#8b5cf6"},children:t.analysis.codeStyle})]})]}),t.analysis.bestPractices!==void 0&&e.jsxs("div",{style:{background:"var(--bg-tertiary)",padding:"1rem 1.25rem",borderRadius:"0.75rem",display:"flex",alignItems:"center",gap:"1rem",border:"1px solid rgba(245, 158, 11, 0.2)"},children:[e.jsx("div",{style:{width:"42px",height:"42px",borderRadius:"10px",background:"rgba(245, 158, 11, 0.15)",display:"flex",alignItems:"center",justifyContent:"center",flexShrink:0},children:e.jsx(mt,{size:22,color:"#f59e0b"})}),e.jsxs("div",{style:{flex:1},children:[e.jsx("span",{style:{color:"var(--text-muted)",fontSize:"0.8rem",display:"block",marginBottom:"0.25rem"},children:"Best Practices"}),e.jsx("p",{style:{margin:0,fontWeight:700,fontSize:"1.1rem",color:"#f59e0b"},children:t.analysis.bestPractices})]})]})]})]}),e.jsxs("div",{children:[e.jsx("h4",{style:{margin:"0 0 0.75rem"},children:"Submitted Code"}),e.jsx("pre",{style:{background:"#020617",padding:"1.5rem",borderRadius:"0.5rem",overflow:"auto",maxHeight:"300px",fontSize:"0.85rem",fontFamily:"monospace",color:"#e2e8f0",border:"1px solid #334155"},children:t.code})]})]})]})})}function Kr(){const[t,j]=i.useState([]),[W,N]=i.useState(!0),[y,b]=i.useState(!1),[x,k]=i.useState(!1),[f,u]=i.useState(!1),c=i.useRef(null),[d,n]=i.useState({title:"",type:"machine_learning",difficulty:"medium",description:"",requirements:"",deadline:"",maxAttempts:0}),[E,D]=i.useState(!1),[g,S]=i.useState([]),[A,C]=i.useState([]),[o,M]=i.useState(null),[w,L]=i.useState(""),[$,te]=i.useState(""),X=p=>{n({title:p.title||"",type:p.type||"machine_learning",difficulty:p.difficulty||"medium",description:p.description||"",requirements:p.requirements||"",deadline:d.deadline,maxAttempts:d.maxAttempts}),k(!1),b(!0)},ee=()=>{I.get(`${Q}/tasks?mentorId=${We}`).then(p=>{j(Array.isArray(p.data)?p.data:p.data?.data||[]),N(!1)}).catch(p=>N(!1))};i.useEffect(()=>{ee()},[]);const ne=async()=>{try{const p=await I.get(`${Q}/users?role=student`);S(Array.isArray(p.data)?p.data:[])}catch(p){console.error("Error fetching students:",p)}},v=async p=>{M(p),L(""),C([]),await ne();try{const G=await I.get(`${Q}/tests/${p}/allocated-students`);C(G.data.studentIds||[])}catch(G){console.error(G),C([])}D(!0)},Y=p=>{C(G=>G.includes(p)?G.filter(h=>h!==p):[...G,p])},z=async()=>{try{await I.post(`${Q}/tests/${o}/allocate-students`,{studentIds:A}),alert("Students assigned successfully!"),D(!1)}catch(p){alert("Error assigning students: "+(p.response?.data?.error||p.message))}},_=async p=>{p.preventDefault();try{await I.post(`${Q}/tasks`,{...d,mentorId:We}),b(!1),n({title:"",type:"machine_learning",difficulty:"medium",description:"",requirements:"",deadline:"",maxAttempts:0}),ee()}catch{alert("Error creating global task")}},J=async p=>{if(window.confirm("Are you sure you want to delete this task?"))try{await I.delete(`${Q}/tasks/${p}`),ee()}catch{alert("Error deleting task")}},we=async p=>{const G=p.target.files[0];if(G){p.target.value="",u(!0);try{const B=(await G.text()).split(`
`).map(ye=>ye.trim()).filter(Boolean);if(B.length<2){alert("CSV must have a header row and at least one data row"),u(!1);return}const Z=B[0].split(",").map(ye=>ye.trim().toLowerCase()),xe=B.slice(1);let ge=0;for(const ye of xe){const ke=ye.match(/(".*?"|[^,]*)/g)?.map(ie=>ie.replace(/^"|"$/g,"").trim())||[],l={};Z.forEach((ie,r)=>{l[ie]=ke[r]||""});const H={title:l.title||l.name||"",type:l.type||"machine_learning",difficulty:l.difficulty||"medium",description:l.description||"",requirements:l.requirements||"",deadline:l.deadline||"",mentorId:We};H.title&&(await I.post(`${Q}/tasks`,H),ge++)}alert(`Successfully created ${ge} tasks from CSV!`),ee()}catch(h){alert("Error parsing CSV: "+h.message)}u(!1)}};return W?e.jsx("div",{className:"loading-spinner"}):e.jsxs("div",{className:"animate-fadeIn",children:[e.jsxs("div",{className:"admin-hero-card glass",style:{background:"var(--bg-card)",borderRadius:"1.5rem",padding:"2rem",marginBottom:"2rem",border:"1px solid var(--border-color)",position:"relative",overflow:"hidden"},children:[e.jsx("div",{style:{position:"absolute",top:"-50px",right:"-50px",width:"200px",height:"200px",background:"radial-gradient(circle, var(--primary-alpha) 0%, transparent 70%)",borderRadius:"50%"}}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",position:"relative",zIndex:1},children:[e.jsx("div",{children:e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"1rem",marginBottom:"0.5rem"},children:[e.jsx("div",{style:{width:"50px",height:"50px",borderRadius:"1rem",background:"var(--primary)",display:"flex",alignItems:"center",justifyContent:"center",boxShadow:"0 8px 32px var(--primary-alpha)"},children:e.jsx(Oe,{size:24,color:"white"})}),e.jsxs("div",{children:[e.jsx("h2",{style:{margin:0,fontSize:"1.75rem",fontWeight:800,color:"var(--text-main)"},children:"Global Tasks Management"}),e.jsx("p",{style:{margin:0,color:"var(--text-muted)",fontSize:"0.95rem"},children:"Create ML/AI tasks visible to all mentors and their students"})]})]})}),e.jsxs("div",{style:{display:"flex",gap:"0.75rem",flexWrap:"wrap",alignItems:"center"},children:[e.jsxs("div",{style:{position:"relative"},children:[e.jsx(Se,{size:18,style:{position:"absolute",left:"12px",top:"50%",transform:"translateY(-50%)",color:"var(--text-muted)"}}),e.jsx("input",{type:"text",placeholder:"Search tasks...",value:$,onChange:p=>te(p.target.value),style:{padding:"0.75rem 1rem 0.75rem 2.5rem",borderRadius:"0.75rem",background:"var(--bg-card)",border:"1px solid var(--border-color)",color:"var(--text-main)",fontSize:"0.9rem",width:"220px",outline:"none"}})]}),e.jsx("input",{type:"file",ref:c,accept:".csv",style:{display:"none"},onChange:we}),e.jsxs("button",{onClick:()=>c.current?.click(),className:"btn-create-new premium-btn",disabled:f,style:{padding:"0.85rem 1.25rem",background:"linear-gradient(135deg, #10b981, #059669)",borderRadius:"0.75rem",fontSize:"0.9rem",fontWeight:600,display:"flex",alignItems:"center",gap:"0.4rem",opacity:f?.6:1},children:[e.jsx(Nt,{size:18})," ",f?"Uploading...":"CSV Upload"]}),e.jsxs("button",{onClick:()=>k(!0),className:"btn-create-new premium-btn",style:{padding:"0.85rem 1.25rem",background:"linear-gradient(135deg, #8b5cf6, #6366f1)",borderRadius:"0.75rem",fontSize:"0.9rem",fontWeight:600,display:"flex",alignItems:"center",gap:"0.4rem"},children:[e.jsx(Ve,{size:18})," AI Generate"]}),e.jsxs("button",{onClick:()=>b(!0),className:"btn-create-new premium-btn",style:{padding:"0.85rem 1.5rem",background:"var(--primary)",borderRadius:"0.75rem",fontSize:"0.9rem",fontWeight:600},children:[e.jsx(Ae,{size:18})," Create Manual"]})]})]})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(3, 1fr)",gap:"1.5rem",marginBottom:"2rem"},children:[e.jsxs("div",{className:"stat-card glass",children:[e.jsx("div",{className:"stat-icon",style:{background:"var(--primary-alpha)",color:"var(--primary)"},children:e.jsx(Ne,{size:24})}),e.jsxs("div",{className:"stat-info",children:[e.jsx("span",{className:"stat-label",children:"Total Tasks"}),e.jsx("span",{className:"stat-value",children:t.length})]})]}),e.jsxs("div",{className:"stat-card glass",children:[e.jsx("div",{className:"stat-icon",style:{background:"var(--success-alpha)",color:"var(--success)"},children:e.jsx(Ze,{size:24})}),e.jsxs("div",{className:"stat-info",children:[e.jsx("span",{className:"stat-label",children:"Live Tasks"}),e.jsx("span",{className:"stat-value",children:t.filter(p=>p.status==="live").length})]})]}),e.jsxs("div",{className:"stat-card glass",children:[e.jsx("div",{className:"stat-icon",style:{background:"var(--secondary-alpha)",color:"var(--secondary)"},children:e.jsx(re,{size:24})}),e.jsxs("div",{className:"stat-info",children:[e.jsx("span",{className:"stat-label",children:"Total Completions"}),e.jsx("span",{className:"stat-value",children:t.reduce((p,G)=>p+(G.completedBy?.length||0),0)})]})]})]}),e.jsx("div",{className:"cards-grid",style:{gridTemplateColumns:"repeat(auto-fill, minmax(380px, 1fr))"},children:t.filter(p=>(p.title||"").toLowerCase().includes($.toLowerCase())||(p.description||"").toLowerCase().includes($.toLowerCase())).length===0?e.jsxs("div",{style:{gridColumn:"1 / -1",textAlign:"center",padding:"4rem",opacity:.5},children:[e.jsx(Oe,{size:64,style:{marginBottom:"1rem",opacity:.3}}),e.jsx("h3",{children:$?"No matching tasks":"No Global Tasks Yet"}),e.jsx("p",{children:$?"Try a different search term.":"Create your first global task to make it visible to all students!"})]}):t.filter(p=>(p.title||"").toLowerCase().includes($.toLowerCase())||(p.description||"").toLowerCase().includes($.toLowerCase())).map(p=>e.jsxs("div",{className:"item-card glass",style:{minHeight:"280px",background:"var(--bg-secondary)",border:"1px solid var(--border-color)"},children:[e.jsxs("div",{className:"item-card-header",children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.75rem"},children:[e.jsx("div",{style:{padding:"10px",background:"linear-gradient(135deg, rgba(59, 130, 246, 0.2), rgba(139, 92, 246, 0.2))",borderRadius:"10px"},children:e.jsx(Oe,{size:20,color:"#3b82f6"})}),e.jsxs("div",{children:[e.jsx("span",{style:{fontSize:"0.65rem",color:"#8b5cf6",fontWeight:700,textTransform:"uppercase",letterSpacing:"0.1em"},children:"GLOBAL TASK"}),e.jsx("h3",{style:{margin:0,fontSize:"1.1rem"},children:p.title})]})]}),e.jsx("span",{className:`status-badge ${p.status}`,children:p.status})]}),e.jsx("p",{style:{color:"var(--text-muted)",fontSize:"0.9rem",lineHeight:"1.6",marginBottom:"1rem"},children:p.description}),p.requirements&&e.jsxs("div",{style:{background:"rgba(59, 130, 246, 0.05)",padding:"0.75rem",borderRadius:"0.5rem",marginBottom:"1rem",fontSize:"0.8rem",color:"var(--text-muted)"},children:[e.jsx("strong",{style:{color:"#60a5fa"},children:"Requirements:"}),e.jsx("br",{}),p.requirements.split(`
`).slice(0,2).join(`
`),"..."]}),e.jsxs("div",{className:"item-card-footer",style:{paddingTop:"1rem",marginTop:"auto"},children:[e.jsxs("div",{style:{display:"flex",gap:"0.5rem",alignItems:"center"},children:[e.jsx("span",{className:`difficulty-badge ${p.difficulty?.toLowerCase()}`,children:p.difficulty}),e.jsxs("span",{style:{fontSize:"0.75rem",color:"var(--text-muted)"},children:[p.completedBy?.length||0," completed"]}),p.maxAttempts>0&&e.jsxs("span",{style:{fontSize:"0.7rem",padding:"2px 6px",borderRadius:"4px",background:"rgba(239, 68, 68, 0.1)",color:"#ef4444",border:"1px solid rgba(239, 68, 68, 0.2)"},children:["Max Attempts: ",p.maxAttempts]})]}),e.jsxs("button",{onClick:()=>v(p.id),className:"btn-create-new",style:{padding:"0.5rem 1rem",fontSize:"0.8rem",background:"rgba(139, 92, 246, 0.1)",color:"#8b5cf6",border:"1px solid rgba(139, 92, 246, 0.2)",borderRadius:"8px",display:"flex",alignItems:"center",gap:"0.4rem",fontWeight:600,transition:"all 0.2s"},onMouseEnter:G=>G.currentTarget.style.background="rgba(139, 92, 246, 0.2)",onMouseLeave:G=>G.currentTarget.style.background="rgba(139, 92, 246, 0.1)",children:[e.jsx(re,{size:16})," Assign"]}),e.jsx("button",{onClick:()=>J(p.id),style:{background:"rgba(239, 68, 68, 0.1)",border:"none",color:"#ef4444",padding:"0.5rem 1rem",borderRadius:"0.5rem",cursor:"pointer",fontSize:"0.8rem"},children:"Delete"})]})]},p.id))}),E&&e.jsx("div",{className:"modal-overlay",onClick:()=>{D(!1),L("")},children:e.jsxs("div",{className:"modal-content",onClick:p=>p.stopPropagation(),style:{maxWidth:"700px",maxHeight:"85vh",overflow:"hidden",display:"flex",flexDirection:"column"},children:[e.jsxs("div",{className:"modal-header",style:{padding:"1.5rem",borderBottom:"1px solid var(--border-color)"},children:[e.jsxs("div",{className:"modal-title-with-icon",children:[e.jsx("div",{style:{width:"40px",height:"40px",borderRadius:"10px",background:"linear-gradient(135deg, #8b5cf6, #6366f1)",display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsx(re,{size:20,color:"white"})}),e.jsxs("div",{children:[e.jsx("h2",{style:{margin:0,fontSize:"1.25rem"},children:"Assign Students"}),e.jsx("p",{style:{margin:0,fontSize:"0.8rem",color:"var(--text-muted)"},children:"Select students for this task"})]})]}),e.jsx("button",{onClick:()=>{D(!1),L("")},className:"modal-close",children:e.jsx(le,{size:20})})]}),e.jsxs("div",{style:{padding:"1rem 1.5rem",background:"var(--bg-secondary)",borderBottom:"1px solid var(--border-color)",display:"flex",gap:"1rem",alignItems:"center"},children:[e.jsxs("div",{style:{position:"relative",flex:1},children:[e.jsx(Se,{size:18,style:{position:"absolute",left:"12px",top:"50%",transform:"translateY(-50%)",color:"var(--text-muted)"}}),e.jsx("input",{type:"text",placeholder:"Search by name or batch...",value:w,onChange:p=>L(p.target.value),style:{width:"100%",padding:"0.7rem 1rem 0.7rem 2.5rem",borderRadius:"10px",background:"var(--bg-card)",border:"1px solid var(--border-color)",color:"var(--text-main)",fontSize:"0.9rem"}})]}),e.jsx("button",{onClick:()=>{const p=g.filter(h=>(h.name||h.username||"").toLowerCase().includes(w.toLowerCase())||(h.batch||"").toLowerCase().includes(w.toLowerCase())),G=p.every(h=>A.includes(h.id));C(G?h=>h.filter(B=>!p.map(Z=>Z.id).includes(B)):h=>[...new Set([...h,...p.map(B=>B.id)])])},style:{padding:"0.7rem 1.2rem",borderRadius:"10px",background:"var(--bg-card)",border:"1px solid var(--border-color)",color:"var(--text-main)",fontSize:"0.85rem",fontWeight:600,cursor:"pointer",whiteSpace:"nowrap"},children:g.filter(p=>(p.name||p.username||"").toLowerCase().includes(w.toLowerCase())||(p.batch||"").toLowerCase().includes(w.toLowerCase())).every(p=>A.includes(p.id))?"Deselect All":"Select All"})]}),e.jsx("div",{className:"modal-body",style:{overflowY:"auto",padding:"1.5rem",background:"var(--bg-primary)"},children:e.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(250px, 1fr))",gap:"1rem"},children:g.filter(p=>(p.name||p.username||"").toLowerCase().includes(w.toLowerCase())||(p.batch||"").toLowerCase().includes(w.toLowerCase())).length===0?e.jsxs("div",{style:{gridColumn:"1 / -1",textAlign:"center",padding:"3rem",opacity:.5},children:[e.jsx(re,{size:48,style:{marginBottom:"1rem",opacity:.2}}),e.jsx("p",{children:"No students found matching your search."})]}):g.filter(p=>(p.name||p.username||"").toLowerCase().includes(w.toLowerCase())||(p.batch||"").toLowerCase().includes(w.toLowerCase())).map(p=>e.jsxs("div",{onClick:()=>Y(p.id),style:{padding:"1rem",borderRadius:"1rem",background:A.includes(p.id)?"var(--primary-alpha)":"var(--bg-card)",border:`1.5px solid ${A.includes(p.id)?"var(--primary)":"var(--border-color)"}`,cursor:"pointer",display:"flex",alignItems:"center",gap:"1rem",transition:"all 0.2s",boxShadow:A.includes(p.id)?"0 4px 12px var(--primary-alpha)":"none"},children:[e.jsx("div",{style:{width:"36px",height:"36px",borderRadius:"50%",background:A.includes(p.id)?"var(--primary)":"var(--bg-secondary)",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"0.9rem",fontWeight:700,color:"white"},children:(p.name||p.username||"S").charAt(0).toUpperCase()}),e.jsxs("div",{style:{flex:1,minWidth:0},children:[e.jsx("div",{style:{fontWeight:600,fontSize:"0.9rem",color:"var(--text-main)",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:p.name||p.username}),e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--text-muted)",display:"flex",alignItems:"center",gap:"4px"},children:e.jsx("span",{style:{padding:"2px 6px",borderRadius:"4px",background:"var(--bg-secondary)",border:"1px solid var(--border-color)"},children:p.batch||"No Batch"})})]}),A.includes(p.id)&&e.jsx(oe,{size:18,color:"var(--primary)"})]},p.id))})}),e.jsxs("div",{className:"modal-footer",style:{padding:"1.2rem 1.5rem",borderTop:"1px solid var(--border-color)",display:"flex",justifyContent:"space-between",alignItems:"center",background:"var(--bg-secondary)"},children:[e.jsxs("div",{style:{fontSize:"0.95rem",color:"var(--text-main)",fontWeight:500},children:[e.jsx("span",{style:{color:"var(--primary)",fontWeight:800,fontSize:"1.1rem"},children:A.length})," students selected"]}),e.jsxs("div",{style:{display:"flex",gap:"1rem"},children:[e.jsx("button",{className:"btn-reset",onClick:()=>{D(!1),L("")},children:"Cancel"}),e.jsx("button",{className:"btn-create-new",onClick:z,style:{background:"var(--primary)",padding:"0.7rem 2rem",borderRadius:"10px",boxShadow:"0 4px 15px var(--primary-alpha)"},children:"Confirm Assignment"})]})]})]})}),y&&e.jsx("div",{className:"modal-overlay",onClick:()=>b(!1),children:e.jsxs("div",{className:"modal-content",onClick:p=>p.stopPropagation(),style:{maxWidth:"700px"},children:[e.jsxs("div",{className:"modal-header",children:[e.jsxs("div",{className:"modal-title-with-icon",children:[e.jsx("div",{style:{width:"40px",height:"40px",borderRadius:"10px",background:"linear-gradient(135deg, #3b82f6, #8b5cf6)",display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsx(Oe,{size:20,color:"white"})}),e.jsx("h2",{children:"Create Global Task"})]}),e.jsx("button",{onClick:()=>b(!1),className:"modal-close",children:e.jsx(le,{size:20})})]}),e.jsx("div",{className:"modal-body premium-form",children:e.jsxs("form",{onSubmit:_,children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Task Title"}),e.jsx("input",{type:"text",placeholder:"e.g., Sentiment Analysis Challenge",value:d.title,onChange:p=>n({...d,title:p.target.value}),required:!0})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"1.5rem"},children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Task Type"}),e.jsxs("select",{value:d.type,onChange:p=>n({...d,type:p.target.value}),children:[e.jsx("option",{value:"machine_learning",children:"Machine Learning"}),e.jsx("option",{value:"deep_learning",children:"Deep Learning"}),e.jsx("option",{value:"data_science",children:"Data Science"}),e.jsx("option",{value:"nlp",children:"NLP"}),e.jsx("option",{value:"computer_vision",children:"Computer Vision"})]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Difficulty"}),e.jsxs("select",{value:d.difficulty,onChange:p=>n({...d,difficulty:p.target.value}),children:[e.jsx("option",{value:"easy",children:"Easy"}),e.jsx("option",{value:"medium",children:"Medium"}),e.jsx("option",{value:"hard",children:"Hard"})]})]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Description"}),e.jsx("textarea",{rows:"4",placeholder:"Describe the task in detail...",value:d.description,onChange:p=>n({...d,description:p.target.value}),required:!0})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Requirements (one per line)"}),e.jsx("textarea",{rows:"4",placeholder:`1. Data Preprocessing
2. Model Training
3. Evaluation Metrics`,value:d.requirements,onChange:p=>n({...d,requirements:p.target.value})})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"1.5rem"},children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Deadline (Optional)"}),e.jsx("input",{type:"date",value:d.deadline,onChange:p=>n({...d,deadline:p.target.value})})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Max Attempts (0 = Unlimited)"}),e.jsx("input",{type:"number",min:"0",placeholder:"0",value:d.maxAttempts,onChange:p=>n({...d,maxAttempts:parseInt(p.target.value)||0})})]})]}),e.jsxs("div",{className:"form-actions",children:[e.jsx("button",{type:"button",className:"btn-reset",onClick:()=>b(!1),children:"Cancel"}),e.jsxs("button",{type:"submit",className:"btn-create-new",style:{background:"linear-gradient(135deg, #3b82f6, #8b5cf6)"},children:[e.jsx(Oe,{size:18})," Create Global Task"]})]})]})})]})}),e.jsx(hs,{context:"task",isOpen:x,onClose:()=>k(!1),onGenerate:X})]})}function Xr(){const[t,j]=i.useState([]),[W,N]=i.useState(!0),[y,b]=i.useState(!1),[x,k]=i.useState(!1),[f,u]=i.useState(!1),c=i.useRef(null),[d,n]=i.useState("coding"),[E,D]=i.useState(null),[g,S]=i.useState({title:"",type:"Coding",language:"Python",difficulty:"Medium",description:"",sampleInput:"",expectedOutput:"",deadline:"",status:"live",maxAttempts:0,sqlSchema:"",expectedQueryResult:"",enableProctoring:!1,enableVideoAudio:!1,disableCopyPaste:!1,trackTabSwitches:!1,maxTabSwitches:3,enableFaceDetection:!1,detectMultipleFaces:!1,trackFaceLookaway:!1}),[A,C]=i.useState(!1),[o,M]=i.useState([]),[w,L]=i.useState([]),[$,te]=i.useState(null),[X,ee]=i.useState(""),[ne,v]=i.useState(""),Y=g.type==="SQL"||g.language==="SQL",z=l=>{const H=l.type==="SQL"||l.language==="SQL";S({title:l.title||"",type:l.type||"Coding",language:l.language||"Python",difficulty:l.difficulty||"Medium",description:l.description||"",sampleInput:H?"":l.sampleInput||"",expectedOutput:H?"":l.expectedOutput||"",sqlSchema:H&&(l.sqlSchema||l.schema)||"",expectedQueryResult:H&&(l.expectedQueryResult||l.expectedResult)||"",deadline:g.deadline,status:l.status||"live",maxAttempts:g.maxAttempts,enableProctoring:g.enableProctoring,enableVideoAudio:g.enableVideoAudio,disableCopyPaste:g.disableCopyPaste,trackTabSwitches:g.trackTabSwitches,maxTabSwitches:g.maxTabSwitches,enableFaceDetection:g.enableFaceDetection,detectMultipleFaces:g.detectMultipleFaces,trackFaceLookaway:g.trackFaceLookaway}),k(!1),b(!0)},_=()=>{I.get(`${Q}/problems?mentorId=${We}`).then(l=>{j(Array.isArray(l.data)?l.data:l.data?.data||[]),N(!1)}).catch(l=>N(!1))};i.useEffect(()=>{_()},[]);const J=async()=>{try{const l=await I.get(`${Q}/users?role=student`);M(Array.isArray(l.data)?l.data:[])}catch(l){console.error("Error fetching students:",l)}},we=async l=>{te(l),ee(""),L([]),await J();try{const H=await I.get(`${Q}/tests/${l}/allocated-students`);L(H.data.studentIds||[])}catch(H){console.error(H),L([])}C(!0)},p=l=>{L(H=>H.includes(l)?H.filter(ie=>ie!==l):[...H,l])},G=async()=>{try{await I.post(`${Q}/problems/${$}/allocate-students`,{studentIds:w}),alert("Students assigned successfully!"),C(!1)}catch(l){alert("Error assigning students: "+(l.response?.data?.error||l.message))}},h=async l=>{l.preventDefault();try{await I.post(`${Q}/problems`,{...g,mentorId:We}),b(!1),S({title:"",type:"Coding",language:"Python",difficulty:"Medium",description:"",sampleInput:"",expectedOutput:"",deadline:"",status:"live",maxAttempts:0,sqlSchema:"",expectedQueryResult:"",enableProctoring:!1,enableVideoAudio:!1,disableCopyPaste:!1,trackTabSwitches:!1,maxTabSwitches:3,enableFaceDetection:!1,detectMultipleFaces:!1,trackFaceLookaway:!1}),_()}catch{alert("Error creating global problem")}},B=async l=>{if(window.confirm("Are you sure you want to delete this problem?"))try{await I.delete(`${Q}/problems/${l}`),_()}catch{alert("Error deleting problem")}},Z=async(l,H)=>{try{await I.put(`${Q}/problems/${l}`,{maxAttempts:H}),_()}catch(ie){console.error("Update max attempts error:",ie.response?.data||ie.message),alert("Error updating max attempts: "+(ie.response?.data?.error||ie.message))}},xe=async l=>{const H=l.target.files[0];if(H){l.target.value="",u(!0);try{const r=(await H.text()).split(`
`).filter(V=>V.trim()).map(V=>V.trim());if(r.length<2){alert("CSV must have a header row and at least one data row"),u(!1);return}const R=V=>{const de=[];let U="",ue=!1;for(let je=0;je<V.length;je++){const Pe=V[je];Pe==='"'?ue=!ue:Pe===","&&!ue?(de.push(U.trim()),U=""):U+=Pe}return de.push(U.trim()),de},a=R(r[0]).map(V=>V.toLowerCase()),q=r.slice(1);let P=0;for(const V of q){if(!V.trim())continue;const de=R(V),U={};a.forEach((Jt,Rt)=>{U[Jt]=de[Rt]||""});const ue=(U.type||"").toUpperCase()==="SQL"||(U.language||"").toUpperCase()==="SQL",je=()=>U.sample_input||U.sampleinput||U.testinput||U.test_input||U["sample input"]||U["test input"]||"",Pe=()=>U.expected_output||U.expectedoutput||U.expectedresult||U.expected_result||U["expected output"]||U["expected result"]||"",ce=()=>U.sql_schema||U.sqlschema||U.schema||U["sql schema"]||"",Ye=()=>U.expected_query_result||U.expectedqueryresult||U.expected_result||U.expectedresult||U["expected query result"]||"",Je={title:U.title||U.name||"",type:ue?"SQL":U.type||"Coding",language:ue?"SQL":U.language||"Python",difficulty:(U.difficulty||"Medium").charAt(0).toUpperCase()+(U.difficulty||"Medium").slice(1).toLowerCase(),description:U.description||"",sampleInput:je(),expectedOutput:Pe(),sqlSchema:ue?ce():"",expectedQueryResult:ue?Ye():"",maxAttempts:parseInt(U.max_attempts||U.maxattempts||U.attempts)||0,status:U.status||"live",mentorId:We};!Je.title||!Je.description||(await I.post(`${Q}/problems`,Je),P++)}alert(`Successfully created ${P} problems from CSV!`),_()}catch(ie){alert("Error parsing CSV: "+ie.message)}u(!1)}};if(W)return e.jsx("div",{className:"loading-spinner"});const ge=t.filter(l=>l.language!=="SQL"&&l.type!=="SQL"),ye=t.filter(l=>l.language==="SQL"||l.type==="SQL"),ke=(d==="coding"?ge:ye).filter(l=>(l.title||"").toLowerCase().includes(ne.toLowerCase())||(l.description||"").toLowerCase().includes(ne.toLowerCase())||(l.language||"").toLowerCase().includes(ne.toLowerCase()));return e.jsxs("div",{className:"animate-fadeIn",children:[e.jsxs("div",{className:"admin-hero-card glass",style:{background:"var(--bg-card)",borderRadius:"1.5rem",padding:"2rem",marginBottom:"2rem",border:"1px solid var(--border-color)",position:"relative",overflow:"hidden"},children:[e.jsx("div",{style:{position:"absolute",top:"-50px",right:"-50px",width:"200px",height:"200px",background:"radial-gradient(circle, var(--primary-alpha) 0%, transparent 70%)",borderRadius:"50%"}}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",position:"relative",zIndex:1},children:[e.jsx("div",{children:e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"1rem",marginBottom:"0.5rem"},children:[e.jsx("div",{style:{width:"50px",height:"50px",borderRadius:"1rem",background:"var(--primary)",display:"flex",alignItems:"center",justifyContent:"center",boxShadow:"0 8px 32px var(--primary-alpha)"},children:e.jsx(Re,{size:24,color:"white"})}),e.jsxs("div",{children:[e.jsx("h2",{style:{margin:0,fontSize:"1.75rem",fontWeight:800,color:"var(--text-main)"},children:"Global Problems Management"}),e.jsx("p",{style:{margin:0,color:"var(--text-muted)",fontSize:"0.95rem"},children:"Create coding challenges visible to all students platform-wide"})]})]})}),e.jsxs("div",{style:{display:"flex",gap:"1rem",flexWrap:"wrap",alignItems:"center"},children:[e.jsxs("div",{style:{position:"relative"},children:[e.jsx(Se,{size:18,style:{position:"absolute",left:"12px",top:"50%",transform:"translateY(-50%)",color:"var(--text-muted)"}}),e.jsx("input",{type:"text",placeholder:"Search problems...",value:ne,onChange:l=>v(l.target.value),style:{padding:"0.75rem 1rem 0.75rem 2.5rem",borderRadius:"1rem",background:"var(--bg-card)",border:"1px solid var(--border-color)",color:"var(--text-main)",fontSize:"0.9rem",width:"250px"}})]}),e.jsx("input",{type:"file",accept:".csv",ref:c,style:{display:"none"},onChange:xe}),e.jsxs("button",{onClick:()=>c.current?.click(),disabled:f,className:"btn-create-new premium-btn",style:{padding:"0.75rem 1.25rem",background:"linear-gradient(135deg, #10b981, #059669)",borderRadius:"1rem",fontSize:"0.95rem",fontWeight:600,transition:"all 0.3s ease",display:"flex",alignItems:"center",gap:"0.5rem"},children:[e.jsx(Nt,{size:18})," ",f?"Uploading...":"CSV Upload"]}),e.jsxs("button",{onClick:()=>k(!0),className:"btn-create-new premium-btn",style:{padding:"0.75rem 1.25rem",background:"linear-gradient(135deg, #8b5cf6, #6366f1)",borderRadius:"1rem",fontSize:"0.95rem",fontWeight:600,transition:"all 0.3s ease",display:"flex",alignItems:"center",gap:"0.5rem"},children:[e.jsx(Ve,{size:20})," AI Generate"]}),e.jsxs("button",{onClick:()=>b(!0),className:"btn-create-new premium-btn",style:{padding:"0.75rem 1.25rem",background:"var(--primary)",borderRadius:"1rem",fontSize:"0.95rem",fontWeight:600,transition:"all 0.3s ease"},children:[e.jsx(Ae,{size:20})," Create Manually"]})]})]})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(3, 1fr)",gap:"1.5rem",marginBottom:"2rem"},children:[e.jsxs("div",{className:"stat-card glass",children:[e.jsx("div",{className:"stat-icon",style:{background:"var(--primary-alpha)",color:"var(--primary)"},children:e.jsx(wt,{size:24})}),e.jsxs("div",{className:"stat-info",children:[e.jsx("span",{className:"stat-label",children:"Total Problems"}),e.jsx("span",{className:"stat-value",children:t.length})]})]}),e.jsxs("div",{className:"stat-card glass",children:[e.jsx("div",{className:"stat-icon",style:{background:"var(--success-alpha)",color:"var(--success)"},children:e.jsx(oe,{size:24})}),e.jsxs("div",{className:"stat-info",children:[e.jsx("span",{className:"stat-label",children:"Active Problems"}),e.jsx("span",{className:"stat-value",children:t.filter(l=>l.status==="live").length})]})]}),e.jsxs("div",{className:"stat-card glass",children:[e.jsx("div",{className:"stat-icon",style:{background:"var(--warning-alpha)",color:"var(--warning)"},children:e.jsx(et,{size:24})}),e.jsxs("div",{className:"stat-info",children:[e.jsx("span",{className:"stat-label",children:"Total Solutions"}),e.jsx("span",{className:"stat-value",children:t.reduce((l,H)=>l+(H.completedBy?.length||0),0)})]})]})]}),e.jsxs("div",{style:{display:"flex",gap:"1rem",marginBottom:"1.5rem",padding:"0.5rem",background:"var(--bg-card)",borderRadius:"12px",width:"fit-content"},children:[e.jsxs("button",{onClick:()=>n("coding"),style:{padding:"0.75rem 1.5rem",borderRadius:"8px",border:"none",cursor:"pointer",fontWeight:600,fontSize:"0.9rem",display:"flex",alignItems:"center",gap:"0.5rem",transition:"all 0.2s ease",background:d==="coding"?"var(--primary)":"transparent",color:d==="coding"?"white":"var(--text-muted)"},children:[e.jsx(Re,{size:18}),"Coding Problems",e.jsx("span",{style:{background:d==="coding"?"rgba(255,255,255,0.2)":"var(--bg-dark)",padding:"2px 8px",borderRadius:"12px",fontSize:"0.75rem"},children:ge.length})]}),e.jsxs("button",{onClick:()=>n("sql"),style:{padding:"0.75rem 1.5rem",borderRadius:"8px",border:"none",cursor:"pointer",fontWeight:600,fontSize:"0.9rem",display:"flex",alignItems:"center",gap:"0.5rem",transition:"all 0.2s ease",background:d==="sql"?"linear-gradient(135deg, #06b6d4, #0891b2)":"transparent",color:d==="sql"?"white":"var(--text-muted)"},children:[e.jsx($e,{size:18}),"SQL Problems",e.jsx("span",{style:{background:d==="sql"?"rgba(255,255,255,0.2)":"var(--bg-dark)",padding:"2px 8px",borderRadius:"12px",fontSize:"0.75rem"},children:ye.length})]})]}),e.jsx("div",{className:"problem-list-grid",style:{gridTemplateColumns:"repeat(auto-fill, minmax(350px, 1fr))"},children:ke.length===0?e.jsxs("div",{style:{gridColumn:"1 / -1",textAlign:"center",padding:"4rem",opacity:.5},children:[e.jsx(Re,{size:64,style:{marginBottom:"1rem",opacity:.3}}),e.jsxs("h3",{children:["No ",d==="sql"?"SQL":"Coding"," Problems Yet"]}),e.jsxs("p",{children:["Create your first ",d==="sql"?"SQL":"coding"," problem!"]})]}):ke.map(l=>e.jsxs("div",{className:"problem-card card glass",style:{background:"var(--bg-secondary)",border:"1px solid var(--border-color)"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start"},children:[e.jsxs("div",{style:{display:"flex",gap:"8px",alignItems:"center",flexWrap:"wrap"},children:[e.jsx("span",{style:{fontSize:"0.65rem",padding:"3px 8px",borderRadius:"4px",background:"linear-gradient(135deg, rgba(16, 185, 129, 0.2), rgba(6, 182, 212, 0.2))",color:"#10b981",fontWeight:700},children:"GLOBAL"}),e.jsx("span",{className:"problem-badge",children:l.type?.toUpperCase()}),e.jsx("span",{className:`status-badge ${l.status||"live"}`,style:{fontSize:"0.65rem"},children:l.status||"Active"}),l.proctoring?.enabled&&e.jsxs("span",{style:{fontSize:"0.6rem",padding:"3px 8px",borderRadius:"4px",background:"rgba(239, 68, 68, 0.15)",color:"#ef4444",fontWeight:700,display:"flex",alignItems:"center",gap:"4px"},children:[e.jsx(Be,{size:10})," PROCTORED"]})]}),e.jsx("span",{style:{fontSize:"0.75rem",color:"var(--text-muted)",background:"rgba(59, 130, 246, 0.1)",padding:"2px 8px",borderRadius:"4px"},children:l.language})]}),e.jsx("h3",{style:{margin:"0.75rem 0",fontSize:"1.2rem"},children:l.title}),e.jsx("p",{style:{fontSize:"0.85rem",color:"var(--text-muted)",display:"-webkit-box",WebkitLineClamp:2,WebkitBoxOrient:"vertical",overflow:"hidden",marginBottom:"1rem"},children:l.description}),l.deadline&&e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px",fontSize:"0.75rem",color:"#f87171",marginBottom:"1rem",background:"rgba(248, 113, 113, 0.05)",padding:"4px 8px",borderRadius:"4px",width:"fit-content"},children:[e.jsx(Ce,{size:12})," Deadline: ",new Date(l.deadline).toLocaleDateString()]}),(l.maxAttempts||l.max_attempts)>0&&e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px",fontSize:"0.75rem",color:"#8b5cf6",marginBottom:"1rem",background:"rgba(139, 92, 246, 0.05)",padding:"4px 8px",borderRadius:"4px",width:"fit-content"},children:["ðŸ”„ Max Attempts: ",l.maxAttempts||l.max_attempts,e.jsx("button",{onClick:()=>{const H=prompt("Set max attempts (0 = unlimited):",l.maxAttempts||l.max_attempts||0);H!==null&&Z(l.id,parseInt(H)||0)},style:{background:"none",border:"none",color:"#8b5cf6",cursor:"pointer",padding:"0 2px",fontSize:"0.7rem"},title:"Edit max attempts",children:"âœï¸"})]}),!(l.maxAttempts||l.max_attempts)&&e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px",fontSize:"0.75rem",color:"var(--text-muted)",marginBottom:"1rem",background:"rgba(100, 116, 139, 0.05)",padding:"4px 8px",borderRadius:"4px",width:"fit-content"},children:["ðŸ”„ Attempts: Unlimited",e.jsx("button",{onClick:()=>{const H=prompt("Set max attempts (0 = unlimited):","0");H!==null&&parseInt(H)>0&&Z(l.id,parseInt(H))},style:{background:"none",border:"none",color:"#8b5cf6",cursor:"pointer",padding:"0 2px",fontSize:"0.7rem"},title:"Set attempt limit",children:"âœï¸"})]}),e.jsxs("div",{style:{marginTop:"auto",display:"flex",justifyContent:"space-between",alignItems:"center",paddingTop:"1rem",borderTop:"1px solid rgba(255,255,255,0.05)"},children:[e.jsxs("div",{style:{display:"flex",gap:"0.5rem",alignItems:"center"},children:[e.jsx("span",{style:{fontSize:"0.75rem",color:l.difficulty==="Easy"?"#10b981":l.difficulty==="Medium"?"#f59e0b":"#ef4444",fontWeight:700},children:l.difficulty}),e.jsxs("span",{style:{fontSize:"0.7rem",color:"var(--text-muted)"},children:["â€¢ ",l.completedBy?.length||0," solved"]})]}),e.jsxs("div",{style:{display:"flex",gap:"0.5rem"},children:[e.jsxs("button",{onClick:()=>D(l),disabled:l.language==="SQL"||l.type==="SQL",style:{background:l.language==="SQL"||l.type==="SQL"?"rgba(100, 116, 139, 0.1)":"rgba(16, 185, 129, 0.1)",border:"none",color:l.language==="SQL"||l.type==="SQL"?"#64748b":"#10b981",padding:"0.5rem 0.75rem",borderRadius:"0.5rem",cursor:l.language==="SQL"||l.type==="SQL"?"not-allowed":"pointer",fontSize:"0.8rem",display:"flex",alignItems:"center",gap:"4px",opacity:l.language==="SQL"||l.type==="SQL"?.5:1},title:l.language==="SQL"||l.type==="SQL"?"Test cases not available for SQL problems":"Manage Test Cases",children:[e.jsx(rt,{size:14})," Tests"]}),e.jsxs("button",{onClick:()=>we(l.id),className:"btn-create-new",style:{padding:"0.5rem 1rem",fontSize:"0.8rem",background:"rgba(139, 92, 246, 0.1)",color:"#8b5cf6",border:"1px solid rgba(139, 92, 246, 0.2)",borderRadius:"8px",display:"flex",alignItems:"center",gap:"0.4rem",fontWeight:600,transition:"all 0.2s"},onMouseEnter:H=>H.currentTarget.style.background="rgba(139, 92, 246, 0.2)",onMouseLeave:H=>H.currentTarget.style.background="rgba(139, 92, 246, 0.1)",children:[e.jsx(re,{size:16})," Assign"]}),e.jsx("button",{onClick:()=>B(l.id),style:{background:"rgba(239, 68, 68, 0.1)",border:"none",color:"#ef4444",padding:"0.5rem 1rem",borderRadius:"0.5rem",cursor:"pointer",fontSize:"0.8rem"},children:"Delete"})]})]})]},l.id))}),A&&e.jsx("div",{className:"modal-overlay",onClick:()=>{C(!1),ee("")},children:e.jsxs("div",{className:"modal-content",onClick:l=>l.stopPropagation(),style:{maxWidth:"700px",maxHeight:"85vh",overflow:"hidden",display:"flex",flexDirection:"column"},children:[e.jsxs("div",{className:"modal-header",style:{padding:"1.5rem",borderBottom:"1px solid var(--border-color)"},children:[e.jsxs("div",{className:"modal-title-with-icon",children:[e.jsx("div",{style:{width:"40px",height:"40px",borderRadius:"10px",background:"linear-gradient(135deg, #8b5cf6, #6366f1)",display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsx(re,{size:20,color:"white"})}),e.jsxs("div",{children:[e.jsx("h2",{style:{margin:0,fontSize:"1.25rem"},children:"Assign Students"}),e.jsx("p",{style:{margin:0,fontSize:"0.8rem",color:"var(--text-muted)"},children:"Select students for this problem"})]})]}),e.jsx("button",{onClick:()=>{C(!1),ee("")},className:"modal-close",children:e.jsx(le,{size:20})})]}),e.jsxs("div",{style:{padding:"1rem 1.5rem",background:"var(--bg-secondary)",borderBottom:"1px solid var(--border-color)",display:"flex",gap:"1rem",alignItems:"center"},children:[e.jsxs("div",{style:{position:"relative",flex:1},children:[e.jsx(Se,{size:18,style:{position:"absolute",left:"12px",top:"50%",transform:"translateY(-50%)",color:"var(--text-muted)"}}),e.jsx("input",{type:"text",placeholder:"Search by name or batch...",value:X,onChange:l=>ee(l.target.value),style:{width:"100%",padding:"0.7rem 1rem 0.7rem 2.5rem",borderRadius:"10px",background:"var(--bg-card)",border:"1px solid var(--border-color)",color:"var(--text-main)",fontSize:"0.9rem"}})]}),e.jsx("button",{onClick:()=>{const l=o.filter(ie=>(ie.name||ie.username||"").toLowerCase().includes(X.toLowerCase())||(ie.batch||"").toLowerCase().includes(X.toLowerCase())),H=l.every(ie=>w.includes(ie.id));L(H?ie=>ie.filter(r=>!l.map(R=>R.id).includes(r)):ie=>[...new Set([...ie,...l.map(r=>r.id)])])},style:{padding:"0.7rem 1.2rem",borderRadius:"10px",background:"var(--bg-card)",border:"1px solid var(--border-color)",color:"var(--text-main)",fontSize:"0.85rem",fontWeight:600,cursor:"pointer",whiteSpace:"nowrap"},children:o.filter(l=>(l.name||l.username||"").toLowerCase().includes(X.toLowerCase())||(l.batch||"").toLowerCase().includes(X.toLowerCase())).every(l=>w.includes(l.id))?"Deselect All":"Select All"})]}),e.jsx("div",{className:"modal-body",style:{overflowY:"auto",padding:"1.5rem",background:"var(--bg-primary)"},children:e.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(250px, 1fr))",gap:"1rem"},children:o.filter(l=>(l.name||l.username||"").toLowerCase().includes(X.toLowerCase())||(l.batch||"").toLowerCase().includes(X.toLowerCase())).length===0?e.jsxs("div",{style:{gridColumn:"1 / -1",textAlign:"center",padding:"3rem",opacity:.5},children:[e.jsx(re,{size:48,style:{marginBottom:"1rem",opacity:.2}}),e.jsx("p",{children:"No students found matching your search."})]}):o.filter(l=>(l.name||l.username||"").toLowerCase().includes(X.toLowerCase())||(l.batch||"").toLowerCase().includes(X.toLowerCase())).map(l=>e.jsxs("div",{onClick:()=>p(l.id),style:{padding:"1rem",borderRadius:"1rem",background:w.includes(l.id)?"var(--primary-alpha)":"var(--bg-card)",border:`1.5px solid ${w.includes(l.id)?"var(--primary)":"var(--border-color)"}`,cursor:"pointer",display:"flex",alignItems:"center",gap:"1rem",transition:"all 0.2s",boxShadow:w.includes(l.id)?"0 4px 12px var(--primary-alpha)":"none"},children:[e.jsx("div",{style:{width:"36px",height:"36px",borderRadius:"50%",background:w.includes(l.id)?"var(--primary)":"var(--bg-secondary)",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"0.9rem",fontWeight:700,color:"white"},children:(l.name||l.username||"S").charAt(0).toUpperCase()}),e.jsxs("div",{style:{flex:1,minWidth:0},children:[e.jsx("div",{style:{fontWeight:600,fontSize:"0.9rem",color:"var(--text-main)",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:l.name||l.username}),e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--text-muted)",display:"flex",alignItems:"center",gap:"4px"},children:e.jsx("span",{style:{padding:"2px 6px",borderRadius:"4px",background:"var(--bg-secondary)",border:"1px solid var(--border-color)"},children:l.batch||"No Batch"})})]}),w.includes(l.id)&&e.jsx(oe,{size:18,color:"var(--primary)"})]},l.id))})}),e.jsxs("div",{className:"modal-footer",style:{padding:"1.2rem 1.5rem",borderTop:"1px solid var(--border-color)",display:"flex",justifyContent:"space-between",alignItems:"center",background:"var(--bg-secondary)"},children:[e.jsxs("div",{style:{fontSize:"0.95rem",color:"var(--text-main)",fontWeight:500},children:[e.jsx("span",{style:{color:"var(--primary)",fontWeight:800,fontSize:"1.1rem"},children:w.length})," students selected"]}),e.jsxs("div",{style:{display:"flex",gap:"1rem"},children:[e.jsx("button",{className:"btn-reset",onClick:()=>{C(!1),ee("")},children:"Cancel"}),e.jsx("button",{className:"btn-create-new",onClick:G,style:{background:"var(--primary)",padding:"0.7rem 2rem",borderRadius:"10px",boxShadow:"0 4px 15px var(--primary-alpha)"},children:"Confirm Assignment"})]})]})]})}),y&&e.jsx("div",{className:"modal-overlay",onClick:()=>b(!1),children:e.jsxs("div",{className:"modal-content",onClick:l=>l.stopPropagation(),style:{maxWidth:"750px"},children:[e.jsxs("div",{className:"modal-header",children:[e.jsxs("div",{className:"modal-title-with-icon",children:[e.jsx("div",{style:{width:"40px",height:"40px",borderRadius:"10px",background:"linear-gradient(135deg, #10b981, #06b6d4)",display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsx(Re,{size:20,color:"white"})}),e.jsx("h2",{children:"Create Global Coding Problem"})]}),e.jsx("button",{onClick:()=>b(!1),className:"modal-close",children:e.jsx(le,{size:20})})]}),e.jsx("div",{className:"modal-body premium-form",children:e.jsxs("form",{onSubmit:h,children:[e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1.5fr 1fr",gap:"1.5rem",marginBottom:"1.5rem"},children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Problem Title"}),e.jsx("input",{type:"text",placeholder:"e.g., Two Sum Problem",value:g.title,onChange:l=>S({...g,title:l.target.value}),required:!0})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Problem Type"}),e.jsxs("select",{value:g.type,onChange:l=>{const H=l.target.value;S({...g,type:H,language:H==="SQL"?"SQL":g.language==="SQL"?"Python":g.language})},children:[e.jsx("option",{value:"Coding",children:"Coding"}),e.jsx("option",{value:"SQL",children:"SQL"}),e.jsx("option",{value:"Algorithm",children:"Algorithm"})]})]})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr 1fr",gap:"1.5rem",marginBottom:"1.5rem"},children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Language"}),e.jsxs("select",{value:g.language,onChange:l=>{const H=l.target.value;S({...g,language:H,type:H==="SQL"?"SQL":g.type==="SQL"?"Coding":g.type})},children:[e.jsx("option",{value:"Python",children:"Python"}),e.jsx("option",{value:"JavaScript",children:"JavaScript"}),e.jsx("option",{value:"Java",children:"Java"}),e.jsx("option",{value:"C++",children:"C++"}),e.jsx("option",{value:"SQL",children:"SQL"})]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Difficulty"}),e.jsxs("select",{value:g.difficulty,onChange:l=>S({...g,difficulty:l.target.value}),children:[e.jsx("option",{value:"Easy",children:"Easy"}),e.jsx("option",{value:"Medium",children:"Medium"}),e.jsx("option",{value:"Hard",children:"Hard"})]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Status"}),e.jsxs("select",{value:g.status,onChange:l=>S({...g,status:l.target.value}),children:[e.jsx("option",{value:"live",children:"Live"}),e.jsx("option",{value:"draft",children:"Draft"}),e.jsx("option",{value:"closed",children:"Closed"})]})]})]}),e.jsxs("div",{className:"form-group",style:{marginBottom:"1.5rem"},children:[e.jsx("label",{className:"form-label",children:"Problem Description"}),e.jsx("textarea",{rows:"5",placeholder:"Describe the problem in detail...",value:g.description,onChange:l=>S({...g,description:l.target.value}),required:!0})]}),Y?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"form-group",style:{marginBottom:"1.5rem"},children:[e.jsxs("label",{className:"form-label",style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[e.jsx(Re,{size:14,color:"#06b6d4"})," Database Schema (CREATE TABLE statements)"]}),e.jsx("textarea",{rows:"6",placeholder:`CREATE TABLE employees (
  id INT PRIMARY KEY,
  name VARCHAR(100),
  department VARCHAR(50),
  salary DECIMAL(10,2)
);

INSERT INTO employees VALUES (1, 'John', 'IT', 50000);`,value:g.sqlSchema,onChange:l=>S({...g,sqlSchema:l.target.value}),style:{fontFamily:"monospace",fontSize:"0.85rem"}}),e.jsx("small",{style:{color:"var(--text-muted)",fontSize:"0.75rem"},children:"Include CREATE TABLE and INSERT statements to set up the test database"})]}),e.jsxs("div",{className:"form-group",style:{marginBottom:"1.5rem"},children:[e.jsxs("label",{className:"form-label",style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[e.jsx(oe,{size:14,color:"#10b981"})," Expected Query Result"]}),e.jsx("textarea",{rows:"4",placeholder:`id | name | salary
1  | John | 50000
2  | Jane | 60000`,value:g.expectedQueryResult,onChange:l=>S({...g,expectedQueryResult:l.target.value}),style:{fontFamily:"monospace",fontSize:"0.85rem"}}),e.jsx("small",{style:{color:"var(--text-muted)",fontSize:"0.75rem"},children:"The expected output when the correct SQL query is executed"})]})]}):e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"1.5rem",marginBottom:"1.5rem"},children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Sample Input"}),e.jsx("input",{type:"text",placeholder:"e.g., [2, 7, 11, 15], target = 9",value:g.sampleInput,onChange:l=>S({...g,sampleInput:l.target.value})})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Expected Output"}),e.jsx("input",{type:"text",placeholder:"e.g., [0, 1]",value:g.expectedOutput,onChange:l=>S({...g,expectedOutput:l.target.value})})]})]}),e.jsxs("div",{className:"form-group",style:{marginBottom:"1.5rem"},children:[e.jsx("label",{className:"form-label",children:"Deadline (Optional)"}),e.jsx("input",{type:"date",value:g.deadline,onChange:l=>S({...g,deadline:l.target.value})})]}),e.jsxs("div",{className:"form-group",style:{marginBottom:"1.5rem"},children:[e.jsx("label",{className:"form-label",children:"Max Attempts (0 = Unlimited)"}),e.jsx("input",{type:"number",min:"0",max:"100",value:g.maxAttempts,onChange:l=>S({...g,maxAttempts:parseInt(l.target.value)||0}),placeholder:"0 = unlimited attempts"}),e.jsx("small",{style:{color:"var(--text-muted)",fontSize:"0.75rem",marginTop:"0.25rem",display:"block"},children:"Set how many times a student can submit. 0 means unlimited."})]}),e.jsxs("div",{style:{marginBottom:"1.5rem",padding:"1.25rem",background:"rgba(239, 68, 68, 0.05)",borderRadius:"1rem",border:"1px solid rgba(239, 68, 68, 0.15)"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.75rem",marginBottom:"1rem"},children:[e.jsx(ve,{size:20,color:"#ef4444"}),e.jsx("h4",{style:{margin:0,fontSize:"1rem",fontWeight:600,color:"#ef4444"},children:"Proctoring Settings"})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(2, 1fr)",gap:"1rem"},children:[e.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"0.75rem",cursor:"pointer",padding:"0.75rem",background:g.enableProctoring?"rgba(239, 68, 68, 0.1)":"transparent",borderRadius:"0.75rem",transition:"all 0.2s"},children:[e.jsx("input",{type:"checkbox",checked:g.enableProctoring,onChange:l=>S({...g,enableProctoring:l.target.checked}),style:{width:"18px",height:"18px",accentColor:"#ef4444"}}),e.jsx("span",{style:{fontSize:"0.9rem"},children:"Enable Proctoring"})]}),e.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"0.75rem",cursor:g.enableProctoring?"pointer":"not-allowed",opacity:g.enableProctoring?1:.5,padding:"0.75rem",background:g.enableVideoAudio?"rgba(139, 92, 246, 0.1)":"transparent",borderRadius:"0.75rem",transition:"all 0.2s"},children:[e.jsx("input",{type:"checkbox",checked:g.enableVideoAudio,onChange:l=>S({...g,enableVideoAudio:l.target.checked}),disabled:!g.enableProctoring,style:{width:"18px",height:"18px",accentColor:"#8b5cf6"}}),e.jsx("span",{style:{fontSize:"0.9rem"},children:"ðŸ“¹ Video/Audio Monitoring"})]}),e.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"0.75rem",cursor:g.enableProctoring?"pointer":"not-allowed",opacity:g.enableProctoring?1:.5,padding:"0.75rem",background:g.disableCopyPaste?"rgba(245, 158, 11, 0.1)":"transparent",borderRadius:"0.75rem",transition:"all 0.2s"},children:[e.jsx("input",{type:"checkbox",checked:g.disableCopyPaste,onChange:l=>S({...g,disableCopyPaste:l.target.checked}),disabled:!g.enableProctoring,style:{width:"18px",height:"18px",accentColor:"#f59e0b"}}),e.jsx("span",{style:{fontSize:"0.9rem"},children:"ðŸ“‹ Disable Copy/Paste"})]}),e.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"0.75rem",cursor:g.enableProctoring?"pointer":"not-allowed",opacity:g.enableProctoring?1:.5,padding:"0.75rem",background:g.trackTabSwitches?"rgba(16, 185, 129, 0.1)":"transparent",borderRadius:"0.75rem",transition:"all 0.2s"},children:[e.jsx("input",{type:"checkbox",checked:g.trackTabSwitches,onChange:l=>S({...g,trackTabSwitches:l.target.checked}),disabled:!g.enableProctoring,style:{width:"18px",height:"18px",accentColor:"#10b981"}}),e.jsx("span",{style:{fontSize:"0.9rem"},children:"ðŸ”’ Track Tab Switches"})]}),e.jsx("hr",{style:{margin:"0.5rem 0",borderColor:"var(--border-color)",opacity:.3}}),e.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"0.75rem",cursor:g.enableProctoring?"pointer":"not-allowed",opacity:g.enableProctoring?1:.5,padding:"0.75rem",background:g.enableFaceDetection?"rgba(236, 72, 153, 0.1)":"transparent",borderRadius:"0.75rem",transition:"all 0.2s"},children:[e.jsx("input",{type:"checkbox",checked:g.enableFaceDetection,onChange:l=>S({...g,enableFaceDetection:l.target.checked}),disabled:!g.enableProctoring,style:{width:"18px",height:"18px",accentColor:"#ec4899"}}),e.jsx("span",{style:{fontSize:"0.9rem"},children:"ðŸ‘ï¸ Enable Face Detection"})]}),e.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"0.75rem",cursor:g.enableProctoring?"pointer":"not-allowed",opacity:g.enableProctoring?1:.5,padding:"0.75rem",background:g.detectMultipleFaces?"rgba(239, 68, 68, 0.1)":"transparent",borderRadius:"0.75rem",transition:"all 0.2s"},children:[e.jsx("input",{type:"checkbox",checked:g.detectMultipleFaces,onChange:l=>S({...g,detectMultipleFaces:l.target.checked}),disabled:!g.enableProctoring,style:{width:"18px",height:"18px",accentColor:"#ef4444"}}),e.jsx("span",{style:{fontSize:"0.9rem"},children:"ðŸ‘¥ Detect Multiple Faces (Cheating)"})]}),e.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"0.75rem",cursor:g.enableProctoring?"pointer":"not-allowed",opacity:g.enableProctoring?1:.5,padding:"0.75rem",background:g.trackFaceLookaway?"rgba(59, 130, 246, 0.1)":"transparent",borderRadius:"0.75rem",transition:"all 0.2s"},children:[e.jsx("input",{type:"checkbox",checked:g.trackFaceLookaway,onChange:l=>S({...g,trackFaceLookaway:l.target.checked}),disabled:!g.enableProctoring,style:{width:"18px",height:"18px",accentColor:"#3b82f6"}}),e.jsx("span",{style:{fontSize:"0.9rem"},children:"ðŸ‘€ Track Face Lookaway"})]})]}),g.enableProctoring&&g.trackTabSwitches&&e.jsxs("div",{style:{marginTop:"1rem",display:"flex",alignItems:"center",gap:"1rem"},children:[e.jsx("label",{style:{fontSize:"0.9rem",color:"var(--text-muted)"},children:"Max Tab Switches:"}),e.jsx("input",{type:"number",min:"1",max:"10",value:g.maxTabSwitches,onChange:l=>S({...g,maxTabSwitches:parseInt(l.target.value)||3}),style:{width:"80px",padding:"0.5rem",borderRadius:"0.5rem",border:"1px solid var(--border-color)",background:"var(--bg-dark)",color:"var(--text-main)"}})]})]}),e.jsxs("div",{className:"form-actions",children:[e.jsx("button",{type:"button",className:"btn-reset",onClick:()=>b(!1),children:"Cancel"}),e.jsxs("button",{type:"submit",className:"btn-create-new",style:{background:"linear-gradient(135deg, #10b981, #06b6d4)"},children:[e.jsx(Ae,{size:18})," Create Global Problem"]})]})]})})]})}),e.jsx(hs,{context:"problem",isOpen:x,onClose:()=>k(!1),onGenerate:z}),E&&e.jsx(ir,{problemId:E.id,problemTitle:E.title,onClose:()=>D(null)})]})}const ut=[{id:"aptitude",label:"Aptitude",icon:"ðŸ“Š"},{id:"verbal",label:"Verbal",icon:"ðŸ“"},{id:"logical",label:"Logical",icon:"ðŸ§©"},{id:"coding",label:"Coding",icon:"ðŸ’»"},{id:"sql",label:"SQL",icon:"ðŸ—„ï¸"}];function Zr(){const[t,j]=i.useState([]),[W,N]=i.useState(!0),[y,b]=i.useState(!1),[x,k]=i.useState(1),[f,u]=i.useState(null),[c,d]=i.useState("aptitude"),[n,E]=i.useState(null),[D,g]=i.useState(!1),[S,A]=i.useState([]),[C,o]=i.useState([]),[M,w]=i.useState(null),[L,$]=i.useState(""),[te,X]=i.useState(""),[ee,ne]=i.useState(null),[v,Y]=i.useState({title:"",type:"comprehensive",difficulty:"Medium",duration:180,passingScore:60,description:"",startTime:"",deadline:"",maxAttempts:1,maxTabSwitches:3,status:"live",sectionConfig:{sections:[{id:"aptitude",enabled:!0,order:1,questionsCount:20,timeMinutes:30},{id:"verbal",enabled:!0,order:2,questionsCount:25,timeMinutes:25},{id:"logical",enabled:!0,order:3,questionsCount:20,timeMinutes:20},{id:"coding",enabled:!0,order:4,questionsCount:2,timeMinutes:50},{id:"sql",enabled:!0,order:5,questionsCount:1,timeMinutes:25}],totalDurationMinutes:180,sectionTimeMode:"fixed"}}),[z,_]=i.useState({aptitude:[],verbal:[],logical:[],coding:[],sql:[]}),[J,we]=i.useState({question:"",options:["","","",""],correctAnswer:0,category:"general",explanation:""}),[p,G]=i.useState({question:"",starterCode:"",language:"Python",testCases:[{input:"",expected_output:""}]}),[h,B]=i.useState({question:"",schema:"",expectedOutput:""}),[Z,xe]=i.useState([]),[ge,ye]=i.useState({topic:"",difficulty:"Medium",count:5}),[ke,l]=i.useState([]),[H,ie]=i.useState(!1),[r,R]=i.useState({enabled:!0,trackTabSwitches:!0,maxTabSwitches:3,enableVideoAudio:!0,disableCopyPaste:!0,detectCameraBlocking:!0,detectPhoneUsage:!0,enforceFullscreen:!0,autoSubmitOnViolation:!1}),[a,q]=i.useState({topic:"",difficulty:"Medium",language:"Python"}),[P,V]=i.useState({topic:"",difficulty:"Medium"}),[de,U]=i.useState([]),[ue,je]=i.useState([]),[Pe,ce]=i.useState(!1),[Ye,Je]=i.useState(!1),[Jt,Rt]=i.useState(!0),[Kt,Lt]=i.useState(!1),Xt=i.useRef(null),Is=async s=>{const m=s.target.files[0];if(m){Lt(!0);try{const O=(await m.text()).split(`
`).map(be=>be.trim()).filter(Boolean);if(O.length<2){alert("CSV must have header + at least one row");return}const K=O[0].split(",").map(be=>be.trim().toLowerCase().replace(/['"]/g,"")),F=[];for(let be=1;be<O.length;be++){const tt=O[be].match(/(".*?"|[^,]+)/g)?.map(Wt=>Wt.trim().replace(/^"|"$/g,""))||[],fe={};K.forEach((Wt,Gs)=>fe[Wt]=tt[Gs]||"");const rs=(fe.section||"aptitude").toLowerCase();["aptitude","verbal","logical"].includes(rs)&&F.push({section:rs,question:fe.question||"",options:[fe.option1||fe.option_1||"",fe.option2||fe.option_2||"",fe.option3||fe.option_3||"",fe.option4||fe.option_4||""],correctAnswer:parseInt(fe.correctanswer||fe.correct_answer||fe.answer||"0"),category:fe.category||"general",explanation:fe.explanation||""})}if(F.length===0){alert("No valid MCQ rows found. CSV needs: section,question,option1,option2,option3,option4,correctAnswer"),Lt(!1);return}const se={title:m.name.replace(".csv","")+" - CSV Import",type:"comprehensive",difficulty:"Medium",duration:180,passingScore:60,status:"draft",createdBy:We,sectionConfig:{sections:[{id:"aptitude",enabled:!0,order:1,questionsCount:F.filter(be=>be.section==="aptitude").length,timeMinutes:30},{id:"verbal",enabled:!0,order:2,questionsCount:F.filter(be=>be.section==="verbal").length,timeMinutes:25},{id:"logical",enabled:!0,order:3,questionsCount:F.filter(be=>be.section==="logical").length,timeMinutes:20},{id:"coding",enabled:!1,order:4,questionsCount:0,timeMinutes:0},{id:"sql",enabled:!1,order:5,questionsCount:0,timeMinutes:0}],totalDurationMinutes:75,sectionTimeMode:"fixed"}},ze=(await I.post(`${Q}/global-tests`,se)).data.id;for(const be of["aptitude","verbal","logical"]){const tt=F.filter(fe=>fe.section===be);tt.length!==0&&await I.post(`${Q}/global-tests/${ze}/questions`,{section:be,questions:tt})}alert(`Created test with ${F.length} questions from CSV!`),pt()}catch(T){alert("CSV upload failed: "+(T.response?.data?.error||T.message))}finally{Lt(!1),s.target.value=""}}},pt=async()=>{try{const s=await I.get(`${Q}/global-tests`);j(Array.isArray(s.data)?s.data:[])}catch(s){s.response?.status===503?j([]):console.error(s)}finally{N(!1)}},Ns=async()=>{try{const s=await I.get(`${Q}/global-test-submissions`);xe(Array.isArray(s.data)?s.data:[])}catch{xe([])}},Zt=async()=>{try{const s=await I.get(`${Q}/users?role=student`);A(s.data||[])}catch(s){console.error("Error fetching students:",s)}},Rs=async s=>{w(s),$(""),o([]),await Zt();try{const m=await I.get(`${Q}/tests/${s}/allocated-students`);o(m.data.studentIds||[])}catch{o([])}g(!0)},Ls=async()=>{if(M)try{await I.post(`${Q}/tests/${M}/allocate-students`,{studentIds:C}),alert(`âœ… Test allocated to ${C.length} student(s)`),g(!1),o([]),w(null)}catch(s){alert("âŒ Error allocating test: "+s.response?.data?.error||s.message)}},Bs=s=>{o(m=>m.includes(s)?m.filter(T=>T!==s):[...m,s])};i.useEffect(()=>{pt(),Ns(),Zt()},[]);const Bt=(s,m,T)=>{Y(O=>({...O,sectionConfig:{...O.sectionConfig,sections:O.sectionConfig.sections.map(K=>K.id===s?{...K,[m]:T}:K)}}))},_s=(s,m)=>{Bt(s,"enabled",m)},es=(s,m)=>{_(T=>({...T,[s]:(T[s]||[]).filter((O,K)=>K!==m)}))},Ws=(s,m)=>s==="coding"?m.map(T=>({questionType:"coding",question:T.question,starterCode:T.starterCode||"",testCases:T.testCases||{language:"Python",cases:[]},points:T.points??10})):s==="sql"?m.map(T=>({questionType:"sql",question:T.question,starterCode:T.starterCode||"",testCases:T.testCases||{expectedOutput:""},points:T.points??10})):m.map(T=>({questionType:"mcq",question:T.question,options:T.options||[T.option_1,T.option_2,T.option_3,T.option_4].filter(Boolean),correctAnswer:T.correctAnswer??T.options?.[T.correctAnswer],category:T.category||"general",explanation:T.explanation||""})),Ps=async()=>{if(!a.topic.trim()){alert("Please enter a topic for the coding problem");return}ce(!0);try{const s=await I.post(`${Q}/ai/generate-coding-problem`,{topic:a.topic,difficulty:a.difficulty,language:a.language});s.data.problem&&U([s.data.problem])}catch(s){console.error("AI Generation error:",s),U([{question:`Write a ${a.language} program to solve: ${a.topic}`,starterCode:a.language==="Python"?`# Write your solution here
def solution():
    pass

# Test your code
solution()`:"// Write your solution here",testCases:[{input:"",expected_output:""}],language:a.language,difficulty:a.difficulty}])}finally{ce(!1)}},Es=()=>{if(de.length===0)return;const s=de.map(m=>({questionType:"coding",question:m.question,starterCode:m.starterCode||"",solutionCode:m.solutionCode||"",language:m.language||a.language,testCases:{language:m.language||a.language,cases:Array.isArray(m.testCases)?m.testCases:m.testCases?.cases||[]},hints:m.hints||[],explanation:m.explanation||"",points:10}));_(m=>({...m,coding:[...m.coding||[],...s]})),U([]),q({topic:"",difficulty:"Medium",language:"Python"})},Ms=async()=>{if(!P.topic.trim()){alert("Please enter a topic for the SQL problem");return}Je(!0);try{const s=await I.post(`${Q}/ai/generate-sql-problem`,{topic:P.topic,difficulty:P.difficulty});s.data.problem&&je([s.data.problem])}catch(s){console.error("AI Generation error:",s),je([{question:`Write a SQL query to: ${P.topic}`,schema:`-- Sample schema
CREATE TABLE employees (
    id INTEGER PRIMARY KEY,
    name TEXT,
    department TEXT,
    salary INTEGER
);

INSERT INTO employees VALUES (1, 'John', 'Engineering', 50000);`,expectedOutput:`id|name|department|salary
1|John|Engineering|50000`,difficulty:P.difficulty}])}finally{Je(!1)}},Ds=()=>{if(ue.length===0)return;const s=ue.map(m=>({questionType:"sql",question:m.question,starterCode:`${m.schema||""}

-- Your query here:`,testCases:{expectedOutput:m.expectedOutput||""},solutionQuery:m.solutionQuery||"",hints:m.hints||[],explanation:m.explanation||"",points:10}));_(m=>({...m,sql:[...m.sql||[],...s]})),je([]),V({topic:"",difficulty:"Medium"})},$s=async()=>{if(!v.title.trim()){alert("Enter test title");return}if(Object.values(z).reduce((m,T)=>m+T.length,0)===0){alert("Add questions in sections");return}try{let m=null;if(v.startTime){const F=new Date(v.startTime);isNaN(F.getTime())||(m=F.toISOString())}let T=null;if(v.deadline){const F=new Date(v.deadline);isNaN(F.getTime())||(T=F.toISOString())}const O={...v,startTime:m,deadline:T,createdBy:f?void 0:We,proctoring:r.enabled?{enabled:!0,trackTabSwitches:r.trackTabSwitches,maxTabSwitches:r.maxTabSwitches,enableVideoAudio:r.enableVideoAudio,disableCopyPaste:r.disableCopyPaste,detectCameraBlocking:r.detectCameraBlocking,detectPhoneUsage:r.detectPhoneUsage,enforceFullscreen:r.enforceFullscreen,autoSubmitOnViolation:r.autoSubmitOnViolation}:{enabled:!1},maxTabSwitches:r.enabled&&r.trackTabSwitches?r.maxTabSwitches:0};let K=f;f?(await I.put(`${Q}/global-tests/${f}`,{...O,createdBy:void 0}),await I.delete(`${Q}/global-tests/${f}/questions`)):K=(await I.post(`${Q}/global-tests`,O)).data.id;for(const F of ut){const se=z[F.id]||[];if(se.length===0)continue;const _e=Ws(F.id,se);await I.post(`${Q}/global-tests/${K}/questions`,{section:F.id,questions:_e})}b(!1),k(1),u(null),_({aptitude:[],verbal:[],logical:[],coding:[],sql:[]}),Y({title:"",type:"comprehensive",difficulty:"Medium",duration:180,passingScore:60,description:"",startTime:"",deadline:"",maxAttempts:1,maxTabSwitches:3,status:"live",sectionConfig:v.sectionConfig}),pt()}catch(m){alert(m.response?.data?.error||"Failed to save test")}},qs=async s=>{if(window.confirm("Delete this global test? This cannot be undone."))try{await I.delete(`${Q}/global-tests/${s}`),pt()}catch(m){alert(m.response?.data?.error||"Delete failed")}},ts=async(s,m)=>{try{await I.put(`${Q}/global-tests/${s}`,{status:m}),pt()}catch(T){alert(T.response?.data?.error||"Status update failed")}},Os=async s=>{try{const[m,T]=await Promise.all([I.get(`${Q}/global-tests/${s.id}`),I.get(`${Q}/global-tests/${s.id}/questions`)]),O=m.data,K=Array.isArray(T.data)?T.data:[],F={aptitude:[],verbal:[],logical:[],coding:[],sql:[]};K.forEach(se=>{const _e=se.options||[];let ze=se.correctAnswer;if(se.questionType!=="coding"&&se.questionType!=="sql")if(typeof ze=="number"&&ze>=0&&ze<4)ze=ze;else if(typeof ze=="string"&&_e.length){const tt=_e.indexOf(ze);ze=tt>=0?tt:/^[0-3]$/.test(ze)?parseInt(ze,10):0}else ze=0;const be={id:se.id,question:se.question,options:_e.length?_e:["","","",""],correctAnswer:ze,category:se.category,explanation:se.explanation,questionType:se.questionType||"mcq",starterCode:se.starterCode,solutionCode:se.solutionCode,testCases:se.testCases,points:se.points};F[se.section]&&F[se.section].push(be)}),Rt((O.maxTabSwitches??0)>0),Y({title:O.title,type:O.type||"comprehensive",difficulty:O.difficulty||"Medium",duration:O.duration??180,passingScore:O.passingScore??60,description:O.description||"",startTime:O.startTime?O.startTime.slice(0,16):"",deadline:O.deadline?O.deadline.slice(0,16):"",maxAttempts:O.maxAttempts??1,maxTabSwitches:O.maxTabSwitches??3,status:O.status||"draft",sectionConfig:O.sectionConfig||v.sectionConfig}),_(F),u(O.id),k(1),b(!0)}catch(m){alert(m.response?.data?.error||"Failed to load test")}},Fs=async()=>{ie(!0);try{const s=await I.post(`${Q}/ai/generate-aptitude`,ge);s.data.questions&&l(s.data.questions)}catch{alert("Error generating questions")}finally{ie(!1)}},Qs=()=>{ke.length!==0&&(_(s=>({...s,[c]:[...s[c]||[],...ke.map(m=>({question:m.question,options:m.options||["","","",""],correctAnswer:m.correctAnswer??0,category:m.category||"general",explanation:m.explanation||""}))]})),l([]))},_t=(s,m,T,O)=>{_(K=>{const F=[...K[s]||[]];return F[m]?(T==="options"?F[m]={...F[m],options:O}:T==="correctAnswer"?F[m]={...F[m],correctAnswer:O}:F[m]={...F[m],[T]:O},{...K,[s]:F}):K})},Us=()=>{_(s=>({...s,[c]:[...s[c]||[],{question:"",options:["","","",""],correctAnswer:0,category:"general",explanation:""}]}))},Hs=()=>{if(!p.question.trim()){alert("Enter problem description");return}const s=p.testCases.filter(m=>m.input!==void 0||m.expected_output);if(s.length===0||!s.some(m=>(m.expected_output||"").trim())){alert("Add at least one test case with expected output");return}_(m=>({...m,coding:[...m.coding||[],{questionType:"coding",question:p.question,starterCode:p.starterCode,testCases:{language:p.language,cases:p.testCases.map(T=>({input:T.input||"",expected_output:T.expected_output||""}))},points:10}]})),G({question:"",starterCode:"",language:"Python",testCases:[{input:"",expected_output:""}]})},Vs=()=>{if(!h.question.trim()){alert("Enter question text");return}if(!h.schema.trim()){alert("Enter database schema");return}if(!h.expectedOutput.trim()){alert("Enter expected query result");return}_(s=>({...s,sql:[...s.sql||[],{questionType:"sql",question:h.question,starterCode:h.schema,testCases:{expectedOutput:h.expectedOutput},points:10}]})),B({question:"",schema:"",expectedOutput:""})};if(W)return e.jsx("div",{className:"loading-spinner"});const ss=t.filter(s=>(s.title||"").toLowerCase().includes(te.toLowerCase())||(s.description||"").toLowerCase().includes(te.toLowerCase())||(s.type||"").toLowerCase().includes(te.toLowerCase()));return e.jsxs("div",{className:"animate-fadeIn",children:[e.jsxs("div",{className:"admin-hero-card glass",style:{background:"var(--bg-card)",borderRadius:"1.5rem",padding:"2rem",marginBottom:"2rem",border:"1px solid var(--border-color)",position:"relative",overflow:"hidden"},children:[e.jsx("div",{style:{position:"absolute",top:"-50px",right:"-50px",width:"200px",height:"200px",background:"radial-gradient(circle, var(--primary-alpha) 0%, transparent 70%)",borderRadius:"50%"}}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",position:"relative",zIndex:1},children:[e.jsx("div",{children:e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"1rem",marginBottom:"0.5rem"},children:[e.jsx("div",{style:{width:"50px",height:"50px",borderRadius:"1rem",background:"var(--primary)",display:"flex",alignItems:"center",justifyContent:"center",boxShadow:"0 8px 32px var(--primary-alpha)"},children:e.jsx(rt,{size:24,color:"white"})}),e.jsxs("div",{children:[e.jsx("h2",{style:{margin:0,fontSize:"1.75rem",fontWeight:800,color:"var(--text-main)"},children:"Global Complete Tests"}),e.jsx("p",{style:{margin:0,color:"var(--text-muted)",fontSize:"0.95rem"},children:"Aptitude, Verbal, Logical, Coding, SQL â€“ create and manage"})]})]})}),e.jsxs("div",{style:{display:"flex",gap:"0.75rem",flexWrap:"wrap"},children:[e.jsx("input",{type:"file",accept:".csv",ref:Xt,style:{display:"none"},onChange:Is}),e.jsxs("button",{onClick:()=>Xt.current?.click(),disabled:Kt,className:"btn-create-new premium-btn",style:{padding:"0.75rem 1.25rem",background:"linear-gradient(135deg, #10b981, #059669)",borderRadius:"1rem",fontSize:"0.95rem",fontWeight:600,display:"flex",alignItems:"center",gap:"0.5rem"},children:[e.jsx(Nt,{size:18})," ",Kt?"Uploading...":"CSV Upload"]}),e.jsxs("button",{type:"button",onClick:()=>{b(!0),k(1),u(null),_({aptitude:[],verbal:[],logical:[],coding:[],sql:[]}),l([]),ye({topic:"",difficulty:"Medium",count:5})},className:"btn-create-new premium-btn",style:{padding:"0.75rem 1.25rem",background:"var(--primary)",borderRadius:"1rem",fontSize:"0.95rem",fontWeight:600,display:"flex",alignItems:"center",gap:"0.5rem"},children:[e.jsx(Ae,{size:20})," Create Global Test"]})]})]})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(3, 1fr)",gap:"1.5rem",marginBottom:"2rem"},children:[e.jsxs("div",{className:"stat-card glass",children:[e.jsx("div",{className:"stat-icon",style:{background:"var(--primary-alpha)",color:"var(--primary)"},children:e.jsx(rt,{size:24})}),e.jsxs("div",{className:"stat-info",children:[e.jsx("span",{className:"stat-label",children:"Total Tests"}),e.jsx("span",{className:"stat-value",children:t.length})]})]}),e.jsxs("div",{className:"stat-card glass",children:[e.jsx("div",{className:"stat-icon",style:{background:"var(--success-alpha)",color:"var(--success)"},children:e.jsx(oe,{size:24})}),e.jsxs("div",{className:"stat-info",children:[e.jsx("span",{className:"stat-label",children:"Live"}),e.jsx("span",{className:"stat-value",children:t.filter(s=>s.status==="live").length})]})]}),e.jsxs("div",{className:"stat-card glass",children:[e.jsx("div",{className:"stat-icon",style:{background:"var(--warning-alpha)",color:"var(--warning)"},children:e.jsx(Ne,{size:24})}),e.jsxs("div",{className:"stat-info",children:[e.jsx("span",{className:"stat-label",children:"Submissions"}),e.jsx("span",{className:"stat-value",children:Z.length})]})]})]}),e.jsx("div",{style:{display:"flex",justifyContent:"flex-end",marginBottom:"1.5rem"},children:e.jsxs("div",{style:{position:"relative"},children:[e.jsx(Se,{size:18,style:{position:"absolute",left:"12px",top:"50%",transform:"translateY(-50%)",color:"var(--text-muted)"}}),e.jsx("input",{type:"text",placeholder:"Search tests...",value:te,onChange:s=>X(s.target.value),style:{padding:"0.75rem 1rem 0.75rem 2.5rem",borderRadius:"1rem",background:"var(--bg-card)",border:"1px solid var(--border-color)",color:"var(--text-main)",fontSize:"0.9rem",width:"300px"}})]})}),ss.length===0&&!W?e.jsxs("div",{style:{textAlign:"center",padding:"4rem",opacity:.7},children:[e.jsx(rt,{size:64,style:{marginBottom:"1rem",opacity:.3}}),e.jsx("h3",{children:"No global tests yet"}),e.jsx("p",{style:{color:"var(--text-muted)"},children:"Create one to add Aptitude, Verbal, Logical, Coding, and SQL sections."}),e.jsxs("p",{style:{fontSize:"0.9rem",color:"var(--text-muted)"},children:["If you see 503, run: ",e.jsx("code",{children:"node migrate_global_tests.js"})]})]}):e.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"1rem"},children:ss.map(s=>{const m=ee===s.id,O=(s.sectionConfig?.sections||[]).filter(F=>F.enabled),K=O.map(F=>F.id.charAt(0).toUpperCase()+F.id.slice(1)).join(", ");return e.jsxs("div",{style:{background:"var(--bg-secondary)",border:`1px solid ${m?"rgba(99, 102, 241, 0.4)":"var(--border-color)"}`,borderRadius:"16px",overflow:"hidden",transition:"all 0.3s ease",boxShadow:m?"0 8px 32px rgba(99, 102, 241, 0.15)":"0 2px 8px rgba(0,0,0,0.1)"},children:[e.jsxs("div",{onClick:()=>ne(m?null:s.id),style:{display:"flex",alignItems:"center",gap:"1rem",padding:"1.25rem 1.5rem",cursor:"pointer",transition:"background 0.2s",background:m?"rgba(99, 102, 241, 0.05)":"transparent"},children:[e.jsx("div",{style:{width:"10px",height:"10px",borderRadius:"50%",background:s.status==="live"?"#10b981":"#ef4444",boxShadow:`0 0 8px ${s.status==="live"?"rgba(16, 185, 129, 0.5)":"rgba(239, 68, 68, 0.3)"}`,flexShrink:0}}),e.jsxs("div",{style:{flex:1,minWidth:0},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.75rem",marginBottom:"0.25rem"},children:[e.jsx("h3",{style:{margin:0,fontSize:"1.1rem",fontWeight:700,color:"var(--text-main)",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:s.title}),e.jsx("span",{style:{fontSize:"0.65rem",padding:"2px 8px",borderRadius:"4px",textTransform:"uppercase",fontWeight:700,background:s.status==="live"?"rgba(16, 185, 129, 0.15)":"rgba(239, 68, 68, 0.15)",color:s.status==="live"?"#10b981":"#ef4444",border:s.status==="live"?"1px solid rgba(16, 185, 129, 0.2)":"1px solid rgba(239, 68, 68, 0.2)",flexShrink:0},children:s.status==="live"?"LIVE":"ENDED"})]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"1rem",fontSize:"0.8rem",color:"var(--text-muted)"},children:[e.jsxs("span",{style:{display:"flex",alignItems:"center",gap:"0.3rem"},children:[e.jsx(Ce,{size:12})," ",s.duration," min"]}),e.jsx("span",{children:"Â·"}),e.jsxs("span",{children:[s.totalQuestions??0," questions"]}),e.jsx("span",{children:"Â·"}),e.jsxs("span",{children:["Pass ",s.passingScore,"%"]}),K&&e.jsxs(e.Fragment,{children:[e.jsx("span",{children:"Â·"}),e.jsx("span",{style:{color:"var(--text-muted)",opacity:.7},children:K})]})]})]}),e.jsx("div",{style:{width:"32px",height:"32px",borderRadius:"8px",background:"var(--bg-card)",display:"flex",alignItems:"center",justifyContent:"center",transition:"transform 0.3s",transform:m?"rotate(180deg)":"rotate(0)",flexShrink:0},children:e.jsx(Tt,{size:16,style:{color:"var(--text-muted)",transform:"rotate(90deg)"}})})]}),m&&e.jsxs("div",{style:{borderTop:"1px solid var(--border-color)",padding:"1.25rem 1.5rem",animation:"fadeIn 0.2s ease"},children:[s.description&&e.jsx("p",{style:{fontSize:"0.9rem",color:"var(--text-muted)",lineHeight:1.6,margin:"0 0 1rem"},children:s.description}),O.length>0&&e.jsx("div",{style:{display:"grid",gridTemplateColumns:`repeat(${Math.min(O.length,5)}, 1fr)`,gap:"0.75rem",marginBottom:"1.25rem"},children:O.map(F=>{const se={aptitude:{bg:"rgba(59, 130, 246, 0.1)",color:"#60a5fa",border:"rgba(59, 130, 246, 0.2)"},verbal:{bg:"rgba(139, 92, 246, 0.1)",color:"#a78bfa",border:"rgba(139, 92, 246, 0.2)"},logical:{bg:"rgba(6, 182, 212, 0.1)",color:"#22d3ee",border:"rgba(6, 182, 212, 0.2)"},coding:{bg:"rgba(16, 185, 129, 0.1)",color:"#34d399",border:"rgba(16, 185, 129, 0.2)"},sql:{bg:"rgba(245, 158, 11, 0.1)",color:"#fbbf24",border:"rgba(245, 158, 11, 0.2)"}},_e=se[F.id]||se.aptitude;return e.jsxs("div",{style:{padding:"0.75rem",background:_e.bg,border:`1px solid ${_e.border}`,borderRadius:"10px",textAlign:"center"},children:[e.jsx("div",{style:{fontSize:"0.7rem",fontWeight:600,color:_e.color,textTransform:"uppercase",letterSpacing:"0.5px",marginBottom:"0.3rem"},children:F.id}),e.jsx("div",{style:{fontSize:"1rem",fontWeight:800,color:"var(--text-main)"},children:F.questionsCount||0}),e.jsxs("div",{style:{fontSize:"0.65rem",color:"var(--text-muted)"},children:[F.timeMinutes||0," min"]})]},F.id)})}),e.jsxs("div",{style:{display:"flex",flexWrap:"wrap",gap:"0.75rem",marginBottom:"1.25rem",fontSize:"0.8rem",color:"var(--text-muted)"},children:[e.jsxs("span",{style:{padding:"0.3rem 0.75rem",background:"var(--bg-card)",borderRadius:"8px",border:"1px solid var(--border-color)"},children:["Type: ",e.jsx("strong",{style:{color:"var(--text-main)"},children:s.type||"Comprehensive"})]}),e.jsxs("span",{style:{padding:"0.3rem 0.75rem",background:"var(--bg-card)",borderRadius:"8px",border:"1px solid var(--border-color)"},children:["Difficulty: ",e.jsx("strong",{style:{color:{Easy:"#10b981",Medium:"#f59e0b",Hard:"#ef4444"}[s.difficulty]||"var(--text-main)"},children:s.difficulty||"Medium"})]}),e.jsxs("span",{style:{padding:"0.3rem 0.75rem",background:"var(--bg-card)",borderRadius:"8px",border:"1px solid var(--border-color)"},children:["Max Attempts: ",e.jsx("strong",{style:{color:"var(--text-main)"},children:s.maxAttempts||1})]}),s.startTime&&e.jsxs("span",{style:{padding:"0.3rem 0.75rem",background:"var(--bg-card)",borderRadius:"8px",border:"1px solid var(--border-color)"},children:["Start: ",e.jsx("strong",{style:{color:"var(--text-main)"},children:new Date(s.startTime).toLocaleString()})]}),s.deadline&&e.jsxs("span",{style:{padding:"0.3rem 0.75rem",background:"var(--bg-card)",borderRadius:"8px",border:"1px solid var(--border-color)"},children:["Deadline: ",e.jsx("strong",{style:{color:"var(--text-main)"},children:new Date(s.deadline).toLocaleString()})]})]}),e.jsxs("div",{style:{display:"flex",gap:"0.6rem",flexWrap:"wrap",paddingTop:"1rem",borderTop:"1px solid var(--border-color)"},children:[e.jsxs("button",{type:"button",onClick:F=>{F.stopPropagation(),Os(s)},style:{display:"flex",alignItems:"center",gap:"0.4rem",padding:"0.6rem 1.2rem",borderRadius:"10px",cursor:"pointer",fontSize:"0.8rem",fontWeight:600,transition:"all 0.2s",background:"rgba(59, 130, 246, 0.1)",color:"#93c5fd",border:"1px solid rgba(59, 130, 246, 0.25)"},children:[e.jsx(ve,{size:14})," View / Edit"]}),e.jsxs("button",{type:"button",onClick:F=>{F.stopPropagation(),Rs(s.id)},style:{display:"flex",alignItems:"center",gap:"0.4rem",padding:"0.6rem 1.2rem",borderRadius:"10px",cursor:"pointer",fontSize:"0.8rem",fontWeight:600,transition:"all 0.2s",background:"rgba(168, 85, 247, 0.1)",color:"#d8b4fe",border:"1px solid rgba(168, 85, 247, 0.25)"},children:[e.jsx(re,{size:14})," Assign Students"]}),s.status==="live"?e.jsxs("button",{type:"button",onClick:F=>{F.stopPropagation(),ts(s.id,"draft")},style:{display:"flex",alignItems:"center",gap:"0.4rem",padding:"0.6rem 1.2rem",borderRadius:"10px",cursor:"pointer",fontSize:"0.8rem",fontWeight:600,transition:"all 0.2s",background:"rgba(245, 158, 11, 0.1)",color:"#fbbf24",border:"1px solid rgba(245, 158, 11, 0.25)"},children:[e.jsx(Me,{size:14})," End Test"]}):e.jsxs("button",{type:"button",onClick:F=>{F.stopPropagation(),ts(s.id,"live")},style:{display:"flex",alignItems:"center",gap:"0.4rem",padding:"0.6rem 1.2rem",borderRadius:"10px",cursor:"pointer",fontSize:"0.8rem",fontWeight:600,transition:"all 0.2s",background:"rgba(16, 185, 129, 0.1)",color:"#6ee7b7",border:"1px solid rgba(16, 185, 129, 0.25)"},children:[e.jsx(oe,{size:14})," Activate"]}),e.jsxs("button",{type:"button",onClick:F=>{F.stopPropagation(),qs(s.id)},style:{display:"flex",alignItems:"center",gap:"0.4rem",padding:"0.6rem 1.2rem",borderRadius:"10px",cursor:"pointer",fontSize:"0.8rem",fontWeight:600,transition:"all 0.2s",background:"rgba(239, 68, 68, 0.1)",color:"#fca5a5",border:"1px solid rgba(239, 68, 68, 0.25)",marginLeft:"auto"},children:[e.jsx(Le,{size:14})," Delete"]})]})]})]},s.id)})}),D&&e.jsx("div",{className:"modal-overlay",onClick:()=>{g(!1),$("")},children:e.jsxs("div",{className:"modal-content",onClick:s=>s.stopPropagation(),style:{maxWidth:"700px",maxHeight:"85vh",overflow:"hidden",display:"flex",flexDirection:"column"},children:[e.jsxs("div",{className:"modal-header",style:{padding:"1.5rem",borderBottom:"1px solid var(--border-color)"},children:[e.jsxs("div",{className:"modal-title-with-icon",children:[e.jsx("div",{style:{width:"40px",height:"40px",borderRadius:"10px",background:"linear-gradient(135deg, #8b5cf6, #6366f1)",display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsx(re,{size:20,color:"white"})}),e.jsxs("div",{children:[e.jsx("h2",{style:{margin:0,fontSize:"1.25rem"},children:"Assign Students"}),e.jsx("p",{style:{margin:0,fontSize:"0.8rem",color:"var(--text-muted)"},children:"Select students for this global test"})]})]}),e.jsx("button",{onClick:()=>{g(!1),$("")},className:"modal-close",children:e.jsx(le,{size:20})})]}),e.jsxs("div",{style:{padding:"1rem 1.5rem",background:"var(--bg-secondary)",borderBottom:"1px solid var(--border-color)",display:"flex",gap:"1rem",alignItems:"center"},children:[e.jsxs("div",{style:{position:"relative",flex:1},children:[e.jsx(Se,{size:18,style:{position:"absolute",left:"12px",top:"50%",transform:"translateY(-50%)",color:"var(--text-muted)"}}),e.jsx("input",{type:"text",placeholder:"Search by name or batch...",value:L,onChange:s=>$(s.target.value),style:{width:"100%",padding:"0.7rem 1rem 0.7rem 2.5rem",borderRadius:"10px",background:"var(--bg-card)",border:"1px solid var(--border-color)",color:"var(--text-main)",fontSize:"0.9rem"}})]}),e.jsx("button",{onClick:()=>{const s=S.filter(T=>(T.name||T.username||"").toLowerCase().includes(L.toLowerCase())||(T.batch||"").toLowerCase().includes(L.toLowerCase())),m=s.every(T=>C.includes(T.id));o(m?T=>T.filter(O=>!s.map(K=>K.id).includes(O)):T=>[...new Set([...T,...s.map(O=>O.id)])])},style:{padding:"0.7rem 1.2rem",borderRadius:"10px",background:"var(--bg-card)",border:"1px solid var(--border-color)",color:"var(--text-main)",fontSize:"0.85rem",fontWeight:600,cursor:"pointer",whiteSpace:"nowrap"},children:S.filter(s=>(s.name||s.username||"").toLowerCase().includes(L.toLowerCase())||(s.batch||"").toLowerCase().includes(L.toLowerCase())).every(s=>C.includes(s.id))?"Deselect All":"Select All"})]}),e.jsx("div",{className:"modal-body",style:{overflowY:"auto",padding:"1.5rem",background:"var(--bg-primary)"},children:e.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(250px, 1fr))",gap:"1rem"},children:S.filter(s=>(s.name||s.username||"").toLowerCase().includes(L.toLowerCase())||(s.batch||"").toLowerCase().includes(L.toLowerCase())).length===0?e.jsxs("div",{style:{gridColumn:"1 / -1",textAlign:"center",padding:"3rem",opacity:.5},children:[e.jsx(re,{size:48,style:{marginBottom:"1rem",opacity:.2}}),e.jsx("p",{children:"No students found matching your search."})]}):S.filter(s=>(s.name||s.username||"").toLowerCase().includes(L.toLowerCase())||(s.batch||"").toLowerCase().includes(L.toLowerCase())).map(s=>e.jsxs("div",{onClick:()=>Bs(s.id),style:{padding:"1rem",borderRadius:"1rem",background:C.includes(s.id)?"var(--primary-alpha)":"var(--bg-card)",border:`1.5px solid ${C.includes(s.id)?"var(--primary)":"var(--border-color)"}`,cursor:"pointer",display:"flex",alignItems:"center",gap:"1rem",transition:"all 0.2s",boxShadow:C.includes(s.id)?"0 4px 12px var(--primary-alpha)":"none"},children:[e.jsx("div",{style:{width:"36px",height:"36px",borderRadius:"50%",background:C.includes(s.id)?"var(--primary)":"var(--bg-secondary)",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"0.9rem",fontWeight:700,color:"white"},children:(s.name||s.username||"S").charAt(0).toUpperCase()}),e.jsxs("div",{style:{flex:1,minWidth:0},children:[e.jsx("div",{style:{fontWeight:600,fontSize:"0.9rem",color:"var(--text-main)",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:s.name||s.username}),e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--text-muted)",display:"flex",alignItems:"center",gap:"4px"},children:e.jsx("span",{style:{padding:"2px 6px",borderRadius:"4px",background:"var(--bg-secondary)",border:"1px solid var(--border-color)"},children:s.batch||"No Batch"})})]}),C.includes(s.id)&&e.jsx(oe,{size:18,color:"var(--primary)"})]},s.id))})}),e.jsxs("div",{className:"modal-footer",style:{padding:"1.2rem 1.5rem",borderTop:"1px solid var(--border-color)",display:"flex",justifyContent:"space-between",alignItems:"center",background:"var(--bg-secondary)"},children:[e.jsxs("div",{style:{fontSize:"0.95rem",color:"var(--text-main)",fontWeight:500},children:[e.jsx("span",{style:{color:"var(--primary)",fontWeight:800,fontSize:"1.1rem"},children:C.length})," students selected"]}),e.jsxs("div",{style:{display:"flex",gap:"1rem"},children:[e.jsx("button",{className:"btn-reset",onClick:()=>{g(!1),$("")},children:"Cancel"}),e.jsx("button",{className:"btn-create-new",onClick:Ls,style:{background:"var(--primary)",padding:"0.7rem 2rem",borderRadius:"10px",boxShadow:"0 4px 15px var(--primary-alpha)"},children:"Confirm Assignment"})]})]})]})}),y&&e.jsx("div",{className:"modal-overlay",style:{position:"fixed",top:0,left:0,right:0,bottom:0,display:"flex",alignItems:"center",justifyContent:"center",padding:"1rem",zIndex:1500,backdropFilter:"blur(5px)",backgroundColor:"rgba(0, 0, 0, 0.5)"},children:e.jsxs("div",{className:"modal-content",style:{width:"100%",maxWidth:x===1?"min(800px, calc(100vw - 2rem))":"min(900px, calc(100vw - 2rem))",maxHeight:"80vh",overflow:"hidden",display:"flex",flexDirection:"column",borderRadius:"16px",background:"#1e293b",backgroundImage:"linear-gradient(145deg, rgba(30,41,59,1), rgba(15,23,42,1))",border:"1px solid rgba(139,92,246,0.2)",boxShadow:"0 25px 50px rgba(0,0,0,0.5)"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"1rem 1.5rem",borderBottom:"1px solid rgba(139,92,246,0.15)",background:"rgba(15, 23, 42, 0.95)",backdropFilter:"blur(10px)",flexShrink:0,zIndex:10},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.75rem"},children:[e.jsx("div",{style:{padding:"0.5rem",background:"linear-gradient(135deg, rgba(139,92,246,0.2), rgba(6,182,212,0.2))",borderRadius:"10px"},children:e.jsx(Oe,{size:22,color:"#a78bfa"})}),e.jsxs("div",{children:[e.jsxs("h2",{style:{margin:0,fontSize:"1.25rem"},children:[f?"Edit":"Create"," Global Test"]}),e.jsx("p",{style:{margin:0,fontSize:"0.8rem",color:"rgba(255,255,255,0.5)"},children:x===1?"Step 1: Basic Settings & Sections":"Step 2: Add Questions to Sections"})]})]}),e.jsx("button",{type:"button",onClick:()=>{b(!1),k(1),u(null)},style:{background:"rgba(255,255,255,0.1)",border:"none",borderRadius:"10px",padding:"0.5rem",cursor:"pointer",color:"white",transition:"all 0.2s"},children:e.jsx(le,{size:20})})]}),e.jsxs("div",{style:{flex:1,overflowY:"auto",padding:"1.5rem"},children:[x===1&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"form-group",style:{marginBottom:"1rem"},children:[e.jsx("label",{className:"form-label",children:"Test Title"}),e.jsx("input",{type:"text",placeholder:"e.g. Global Complete Assessment - Feb 2026",value:v.title,onChange:s=>Y({...v,title:s.target.value}),style:{width:"100%"}})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(160px, 1fr))",gap:"1rem",marginBottom:"1rem"},children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Duration (min) â€” default 180 for Coding+SQL"}),e.jsx("input",{type:"number",min:"30",max:"300",value:v.duration,onChange:s=>Y({...v,duration:parseInt(s.target.value)||180})})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Passing Score (%)"}),e.jsx("input",{type:"number",min:"0",max:"100",value:v.passingScore,onChange:s=>Y({...v,passingScore:parseInt(s.target.value)||60})})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Status"}),e.jsxs("select",{value:v.status,onChange:s=>Y({...v,status:s.target.value}),children:[e.jsx("option",{value:"draft",children:"Draft"}),e.jsx("option",{value:"live",children:"Live"})]})]})]}),e.jsxs("div",{className:"form-group",style:{marginBottom:"1rem"},children:[e.jsx("label",{className:"form-label",children:"Max Attempts"}),e.jsx("input",{type:"number",min:"1",max:"10",value:v.maxAttempts,onChange:s=>Y({...v,maxAttempts:parseInt(s.target.value)||1})})]}),e.jsxs("div",{style:{marginBottom:"1.5rem",padding:"1.25rem",background:"linear-gradient(135deg, rgba(239,68,68,0.05), rgba(251,191,36,0.05))",borderRadius:"16px",border:"1px solid rgba(239,68,68,0.2)"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.75rem",marginBottom:"1rem"},children:[e.jsx("div",{style:{padding:"0.5rem",background:"rgba(239,68,68,0.1)",borderRadius:"8px"},children:e.jsx(Be,{size:20,color:"#ef4444"})}),e.jsxs("div",{children:[e.jsx("h4",{style:{margin:0,fontSize:"1rem",color:"#ef4444"},children:"Proctoring Settings"}),e.jsx("p",{style:{margin:0,fontSize:"0.75rem",color:"rgba(255,255,255,0.6)"},children:"Configure security measures for exam integrity"})]}),e.jsxs("label",{style:{marginLeft:"auto",display:"flex",alignItems:"center",gap:"0.5rem"},children:[e.jsx("input",{type:"checkbox",checked:r.enabled,onChange:s=>R({...r,enabled:s.target.checked})}),e.jsx("span",{style:{fontSize:"0.85rem",fontWeight:600},children:"Enable Proctoring"})]})]}),r.enabled&&e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(220px, 1fr))",gap:"0.75rem"},children:[e.jsxs("div",{style:{padding:"0.75rem",background:"rgba(0,0,0,0.2)",borderRadius:"10px",border:"1px solid rgba(255,255,255,0.1)"},children:[e.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"0.5rem",marginBottom:"0.5rem",fontSize:"0.85rem"},children:[e.jsx("input",{type:"checkbox",checked:r.trackTabSwitches,onChange:s=>R({...r,trackTabSwitches:s.target.checked})}),e.jsx(ve,{size:16,color:"#f59e0b"}),"Track Tab Switches"]}),r.trackTabSwitches&&e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem",marginLeft:"1.5rem"},children:[e.jsx("span",{style:{fontSize:"0.75rem",color:"rgba(255,255,255,0.6)"},children:"Max:"}),e.jsx("input",{type:"number",min:"1",max:"10",value:r.maxTabSwitches,onChange:s=>R({...r,maxTabSwitches:parseInt(s.target.value)||3}),style:{width:50,padding:"0.25rem 0.5rem",fontSize:"0.85rem"}})]})]}),e.jsxs("div",{style:{padding:"0.75rem",background:"rgba(0,0,0,0.2)",borderRadius:"10px",border:"1px solid rgba(255,255,255,0.1)"},children:[e.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"0.5rem",fontSize:"0.85rem"},children:[e.jsx("input",{type:"checkbox",checked:r.enableVideoAudio,onChange:s=>R({...r,enableVideoAudio:s.target.checked})}),e.jsx("span",{style:{fontSize:"1rem"},children:"ðŸ“¹"}),"Video/Audio Recording"]}),e.jsx("p",{style:{margin:"0.25rem 0 0 1.5rem",fontSize:"0.7rem",color:"rgba(255,255,255,0.5)"},children:"Record student during test"})]}),e.jsxs("div",{style:{padding:"0.75rem",background:"rgba(0,0,0,0.2)",borderRadius:"10px",border:"1px solid rgba(255,255,255,0.1)"},children:[e.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"0.5rem",fontSize:"0.85rem"},children:[e.jsx("input",{type:"checkbox",checked:r.detectCameraBlocking,onChange:s=>R({...r,detectCameraBlocking:s.target.checked})}),e.jsx("span",{style:{fontSize:"1rem"},children:"ðŸš«"}),"Detect Camera Blocking"]}),e.jsx("p",{style:{margin:"0.25rem 0 0 1.5rem",fontSize:"0.7rem",color:"rgba(255,255,255,0.5)"},children:"Flag covered/blocked camera"})]}),e.jsxs("div",{style:{padding:"0.75rem",background:"rgba(0,0,0,0.2)",borderRadius:"10px",border:"1px solid rgba(255,255,255,0.1)"},children:[e.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"0.5rem",fontSize:"0.85rem"},children:[e.jsx("input",{type:"checkbox",checked:r.detectPhoneUsage,onChange:s=>R({...r,detectPhoneUsage:s.target.checked})}),e.jsx("span",{style:{fontSize:"1rem"},children:"ðŸ“±"}),"AI Phone Detection"]}),e.jsx("p",{style:{margin:"0.25rem 0 0 1.5rem",fontSize:"0.7rem",color:"rgba(255,255,255,0.5)"},children:"Detect mobile phones in view"})]}),e.jsxs("div",{style:{padding:"0.75rem",background:"rgba(0,0,0,0.2)",borderRadius:"10px",border:"1px solid rgba(255,255,255,0.1)"},children:[e.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"0.5rem",fontSize:"0.85rem"},children:[e.jsx("input",{type:"checkbox",checked:r.disableCopyPaste,onChange:s=>R({...r,disableCopyPaste:s.target.checked})}),e.jsx("span",{style:{fontSize:"1rem"},children:"ðŸ“‹"}),"Disable Copy/Paste"]}),e.jsx("p",{style:{margin:"0.25rem 0 0 1.5rem",fontSize:"0.7rem",color:"rgba(255,255,255,0.5)"},children:"Block clipboard actions"})]}),e.jsxs("div",{style:{padding:"0.75rem",background:"rgba(0,0,0,0.2)",borderRadius:"10px",border:"1px solid rgba(255,255,255,0.1)"},children:[e.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"0.5rem",fontSize:"0.85rem"},children:[e.jsx("input",{type:"checkbox",checked:r.enforceFullscreen,onChange:s=>R({...r,enforceFullscreen:s.target.checked})}),e.jsx("span",{style:{fontSize:"1rem"},children:"ðŸ–¥ï¸"}),"Enforce Fullscreen"]}),e.jsx("p",{style:{margin:"0.25rem 0 0 1.5rem",fontSize:"0.7rem",color:"rgba(255,255,255,0.5)"},children:"Required during test"})]}),e.jsxs("div",{style:{padding:"0.75rem",background:"rgba(239,68,68,0.1)",borderRadius:"10px",border:"1px solid rgba(239,68,68,0.2)"},children:[e.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"0.5rem",fontSize:"0.85rem"},children:[e.jsx("input",{type:"checkbox",checked:r.autoSubmitOnViolation,onChange:s=>R({...r,autoSubmitOnViolation:s.target.checked})}),e.jsx(pe,{size:16,color:"#ef4444"}),"Auto-Submit on Max Violations"]}),e.jsx("p",{style:{margin:"0.25rem 0 0 1.5rem",fontSize:"0.7rem",color:"rgba(239,68,68,0.7)"},children:"Submit test when violations exceed limit"})]})]})]}),e.jsxs("div",{className:"form-group",style:{marginBottom:"1rem"},children:[e.jsx("label",{className:"form-label",children:"Description (optional)"}),e.jsx("textarea",{placeholder:"Instructions for students",value:v.description,onChange:s=>Y({...v,description:s.target.value}),rows:2,style:{width:"100%",resize:"vertical"}})]}),e.jsxs("div",{style:{marginBottom:"1.5rem"},children:[e.jsx("h4",{style:{margin:"0 0 0.75rem"},children:"Sections â€” Coding min 2, SQL min 1 (max set by you)"}),(v.sectionConfig?.sections||[]).map(s=>e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"1rem",marginBottom:"0.5rem",flexWrap:"wrap"},children:[e.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"0.5rem",minWidth:120},children:[e.jsx("input",{type:"checkbox",checked:!!s.enabled,onChange:m=>_s(s.id,m.target.checked)}),ut.find(m=>m.id===s.id)?.icon," ",ut.find(m=>m.id===s.id)?.label,s.id==="coding"&&e.jsx("span",{style:{fontSize:"0.7rem",color:"var(--text-muted)"},children:"(min 2)"}),s.id==="sql"&&e.jsx("span",{style:{fontSize:"0.7rem",color:"var(--text-muted)"},children:"(min 1)"})]}),e.jsx("input",{type:"number",min:s.id==="coding"?2:s.id==="sql"?1:0,placeholder:"Count",value:s.questionsCount??"",onChange:m=>Bt(s.id,"questionsCount",parseInt(m.target.value)||0),style:{width:70}}),e.jsx("input",{type:"number",min:"0",placeholder:"Min",value:s.timeMinutes??"",onChange:m=>Bt(s.id,"timeMinutes",parseInt(m.target.value)||0),style:{width:70}})]},s.id))]}),e.jsxs("div",{style:{display:"flex",gap:"0.5rem",justifyContent:"flex-end"},children:[e.jsx("button",{type:"button",className:"btn-reset",onClick:()=>b(!1),children:"Cancel"}),e.jsx("button",{type:"button",className:"btn-create-new",onClick:()=>k(2),children:"Next: Add Questions"})]})]}),x===2&&e.jsxs(e.Fragment,{children:[e.jsx("div",{style:{display:"flex",gap:"0.5rem",marginBottom:"1.5rem",flexWrap:"wrap",padding:"0.5rem",background:"rgba(0,0,0,0.2)",borderRadius:"14px",border:"1px solid rgba(255,255,255,0.05)"},children:ut.map(s=>{const m=c===s.id,T=(z[s.id]||[]).length,O={aptitude:{bg:"rgba(139,92,246,0.15)",border:"rgba(139,92,246,0.4)",color:"#a78bfa"},verbal:{bg:"rgba(59,130,246,0.15)",border:"rgba(59,130,246,0.4)",color:"#60a5fa"},logical:{bg:"rgba(245,158,11,0.15)",border:"rgba(245,158,11,0.4)",color:"#fbbf24"},coding:{bg:"rgba(16,185,129,0.15)",border:"rgba(16,185,129,0.4)",color:"#34d399"},sql:{bg:"rgba(6,182,212,0.15)",border:"rgba(6,182,212,0.4)",color:"#22d3ee"}},K=O[s.id]||O.aptitude;return e.jsxs("button",{type:"button",onClick:()=>d(s.id),style:{padding:"0.75rem 1.25rem",borderRadius:"10px",border:m?`2px solid ${K.border}`:"2px solid transparent",background:m?K.bg:"transparent",color:m?K.color:"rgba(255,255,255,0.6)",cursor:"pointer",display:"flex",alignItems:"center",gap:"0.5rem",fontSize:"0.9rem",fontWeight:m?600:400,transition:"all 0.2s ease",flex:"1 1 auto",justifyContent:"center",minWidth:"120px"},children:[e.jsx("span",{style:{fontSize:"1.1rem"},children:s.icon}),e.jsx("span",{children:s.label}),e.jsx("span",{style:{background:T>0?m?K.color:"rgba(255,255,255,0.2)":"rgba(255,255,255,0.1)",color:T>0?m?"#0f172a":"rgba(255,255,255,0.8)":"rgba(255,255,255,0.4)",padding:"0.15rem 0.5rem",borderRadius:"6px",fontSize:"0.75rem",fontWeight:700,minWidth:"24px",textAlign:"center"},children:T})]},s.id)})}),c==="coding"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"card glass",style:{marginBottom:"1.5rem",padding:"1.5rem",background:"linear-gradient(135deg, rgba(16,185,129,0.1), rgba(6,182,212,0.05))",border:"1px solid rgba(16,185,129,0.3)",borderRadius:"16px"},children:[e.jsxs("h4",{style:{display:"flex",alignItems:"center",gap:"0.5rem",margin:"0 0 1rem",fontSize:"1.1rem",color:"#10b981"},children:[e.jsx(qt,{size:20})," AI Coding Problem Generator"]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(140px, 1fr))",gap:"0.75rem",alignItems:"end"},children:[e.jsxs("div",{className:"form-group",style:{marginBottom:0},children:[e.jsx("label",{className:"form-label",style:{fontSize:"0.75rem",color:"rgba(255,255,255,0.7)"},children:"TOPIC / CONCEPT"}),e.jsx("input",{type:"text",placeholder:"e.g., Two Sum, Binary Search, Linked Lists",value:a.topic,onChange:s=>q({...a,topic:s.target.value}),style:{width:"100%"}})]}),e.jsxs("div",{className:"form-group",style:{marginBottom:0},children:[e.jsx("label",{className:"form-label",style:{fontSize:"0.75rem",color:"rgba(255,255,255,0.7)"},children:"DIFFICULTY"}),e.jsxs("select",{value:a.difficulty,onChange:s=>q({...a,difficulty:s.target.value}),children:[e.jsx("option",{value:"Easy",children:"Easy"}),e.jsx("option",{value:"Medium",children:"Medium"}),e.jsx("option",{value:"Hard",children:"Hard"})]})]}),e.jsxs("div",{className:"form-group",style:{marginBottom:0},children:[e.jsx("label",{className:"form-label",style:{fontSize:"0.75rem",color:"rgba(255,255,255,0.7)"},children:"LANGUAGE"}),e.jsxs("select",{value:a.language,onChange:s=>q({...a,language:s.target.value}),children:[e.jsx("option",{value:"Python",children:"Python"}),e.jsx("option",{value:"JavaScript",children:"JavaScript"}),e.jsx("option",{value:"Java",children:"Java"}),e.jsx("option",{value:"C++",children:"C++"})]})]}),e.jsx("button",{type:"button",className:"btn-create-new",onClick:Ps,disabled:Pe,style:{background:"linear-gradient(135deg, #10b981, #06b6d4)"},children:Pe?e.jsxs(e.Fragment,{children:[e.jsx(Te,{size:16,className:"spin"})," Generating..."]}):e.jsxs(e.Fragment,{children:[e.jsx(ps,{size:16})," Generate"]})})]}),de.length>0&&e.jsxs("div",{style:{marginTop:"1rem",padding:"1rem",background:"rgba(16,185,129,0.1)",borderRadius:"12px",border:"1px solid rgba(16,185,129,0.2)"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"0.75rem"},children:[e.jsxs("span",{style:{fontWeight:600,color:"#10b981"},children:["âœ“ Generated ",de.length," Problem(s)"]}),e.jsxs("button",{type:"button",className:"btn-create-new",onClick:Es,style:{background:"linear-gradient(135deg, #10b981, #059669)"},children:[e.jsx(Ae,{size:16})," Add to Section"]})]}),de.map((s,m)=>e.jsxs("div",{style:{padding:"0.75rem",background:"rgba(0,0,0,0.2)",borderRadius:"8px",marginTop:"0.5rem"},children:[e.jsxs("p",{style:{margin:"0 0 0.5rem",fontWeight:500,color:"white"},children:[s.question?.substring(0,150),"..."]}),e.jsxs("span",{style:{fontSize:"0.75rem",color:"rgba(255,255,255,0.6)"},children:[s.testCases?.length||0," test cases"]})]},m))]})]}),e.jsxs("div",{style:{padding:"1.5rem",background:"var(--bg-secondary)",borderRadius:"16px",border:"1px solid var(--border-color)"},children:[e.jsxs("h4",{style:{display:"flex",alignItems:"center",gap:"0.5rem",margin:"0 0 1rem",fontSize:"1rem",color:"var(--text)"},children:[e.jsx(Re,{size:18})," Manual Entry"]}),e.jsxs("div",{className:"form-group",style:{marginBottom:"1rem"},children:[e.jsx("label",{className:"form-label",children:"Problem description"}),e.jsx("textarea",{value:p.question,onChange:s=>G({...p,question:s.target.value}),placeholder:"Describe the coding problem...",rows:3,style:{width:"100%",resize:"vertical"}})]}),e.jsxs("div",{className:"form-group",style:{marginBottom:"1rem"},children:[e.jsx("label",{className:"form-label",children:"Starter code (optional)"}),e.jsx("textarea",{value:p.starterCode,onChange:s=>G({...p,starterCode:s.target.value}),placeholder:"def solution():\\n    pass",rows:4,style:{width:"100%",fontFamily:"monospace",fontSize:"0.85rem",resize:"vertical"}})]}),e.jsxs("div",{className:"form-group",style:{marginBottom:"1rem"},children:[e.jsx("label",{className:"form-label",children:"Language"}),e.jsxs("select",{value:p.language,onChange:s=>G({...p,language:s.target.value}),children:[e.jsx("option",{value:"Python",children:"Python"}),e.jsx("option",{value:"JavaScript",children:"JavaScript"}),e.jsx("option",{value:"Java",children:"Java"}),e.jsx("option",{value:"C++",children:"C++"})]})]}),e.jsxs("div",{style:{marginBottom:"1rem"},children:[e.jsx("label",{className:"form-label",children:"Test cases (input â†’ expected output)"}),p.testCases.map((s,m)=>e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr auto",gap:"0.5rem",marginBottom:"0.5rem",alignItems:"center"},children:[e.jsx("input",{type:"text",placeholder:"Sample Input",value:s.input||"",onChange:T=>{const O=[...p.testCases];O[m]={...O[m],input:T.target.value},G({...p,testCases:O})}}),e.jsx("input",{type:"text",placeholder:"Sample Output",value:s.expected_output||"",onChange:T=>{const O=[...p.testCases];O[m]={...O[m],expected_output:T.target.value},G({...p,testCases:O})}}),e.jsx("button",{type:"button",onClick:()=>G({...p,testCases:p.testCases.filter((T,O)=>O!==m)}),className:"btn-reset",style:{color:"var(--danger)"},children:e.jsx(le,{size:18})})]},m)),e.jsx("button",{type:"button",className:"btn-reset",style:{fontSize:"0.85rem",marginTop:"0.25rem"},onClick:()=>G({...p,testCases:[...p.testCases,{input:"",expected_output:""}]}),children:"+ Add test case"})]}),e.jsx("button",{type:"button",className:"btn-create-new",onClick:Hs,children:"Add this coding problem"})]}),e.jsxs("div",{style:{marginTop:"2rem"},children:[z.coding?.length>0&&e.jsxs("h4",{style:{color:"white",marginBottom:"1rem",fontSize:"1rem"},children:["Added Coding Problems (",z.coding.length,")"]}),z.coding?.map((s,m)=>e.jsx("div",{className:"card glass",style:{marginBottom:"1rem",padding:"1rem",background:"rgba(59, 130, 246, 0.05)",border:"1px solid rgba(59, 130, 246, 0.2)",borderRadius:"12px"},children:e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start"},children:[e.jsxs("div",{children:[e.jsxs("h5",{style:{margin:"0 0 0.5rem",color:"#60a5fa",fontSize:"1rem"},children:[s.question?.substring(0,100),"..."]}),e.jsxs("span",{style:{fontSize:"0.8rem",color:"rgba(255,255,255,0.6)"},children:[s.testCases?.language||(s.testCases?.cases||Array.isArray(s.testCases)?"Coding":"Python")," â€¢ ",(Array.isArray(s.testCases)?s.testCases:s.testCases?.cases||[]).length," test cases"]})]}),e.jsxs("div",{style:{display:"flex",gap:"0.5rem"},children:[e.jsxs("button",{type:"button",onClick:()=>E({index:m,section:"coding"}),style:{padding:"0.5rem 0.75rem",background:"#3b82f6",border:"none",borderRadius:"8px",color:"white",cursor:"pointer",display:"flex",alignItems:"center",gap:"0.5rem",fontSize:"0.85rem"},children:[e.jsx(rt,{size:16})," Manage Test Cases"]}),e.jsx("button",{type:"button",onClick:()=>{_(T=>({...T,coding:T.coding.filter((O,K)=>K!==m)}))},style:{padding:"0.5rem",background:"rgba(239, 68, 68, 0.2)",border:"none",borderRadius:"8px",color:"#ef4444",cursor:"pointer"},children:e.jsx(Le,{size:16})})]})]})},m))]}),n&&z[n.section]?.[n.index]&&e.jsx(Ar,{title:z[n.section][n.index].question?.substring(0,50),inputLabel:n.section==="sql"?"Database Schema (SQL)":"Sample Input",outputLabel:n.section==="sql"?"Expected Result (Table/Text)":"Sample Output",initialTestCases:(()=>{const s=z[n.section][n.index];if(Array.isArray(s.testCases))return s.testCases.map(m=>({...m,expectedOutput:m.expected_output||m.expectedOutput,isHidden:m.isHidden||!1,points:m.points||10,description:m.description||""}));if(n.section==="sql"){const m=s.schema||s.starterCode||"",T=s.expectedOutput||s.testCases?.expectedOutput||"";if(m||T)return[{input:m,expectedOutput:T,isHidden:!1,points:s.points||10,description:"Default Case"}]}return s.testCases?.cases?s.testCases.cases.map(m=>({...m,expectedOutput:m.expected_output||m.expectedOutput,isHidden:m.isHidden||!1,points:m.points||10,description:m.description||""})):[]})(),onClose:()=>E(null),onUpdate:s=>{const m=s.map(T=>({input:T.input,expected_output:T.expectedOutput,isHidden:T.isHidden,points:T.points,description:T.description}));_(T=>{const O=n.section,K=[...T[O]||[]];if(K[n.index]){const F=K[n.index];if(O==="sql"){const se=s[0]||{input:"",expectedOutput:""};K[n.index]={...F,schema:se.input,starterCode:se.input,expectedOutput:se.expectedOutput,testCases:m}}else{const se=F.testCases?.language||"Python";F.testCases?.language||!Array.isArray(F.testCases)?K[n.index]={...F,testCases:{language:se,cases:m}}:K[n.index]={...F,testCases:m}}}return{...T,[O]:K}})}})]}),c==="sql"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"card glass",style:{marginBottom:"1.5rem",padding:"1.5rem",background:"linear-gradient(135deg, rgba(6,182,212,0.1), rgba(139,92,246,0.05))",border:"1px solid rgba(6,182,212,0.3)",borderRadius:"16px"},children:[e.jsxs("h4",{style:{display:"flex",alignItems:"center",gap:"0.5rem",margin:"0 0 1rem",fontSize:"1.1rem",color:"#06b6d4"},children:[e.jsx(qt,{size:20})," AI SQL Problem Generator"]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(140px, 1fr))",gap:"0.75rem",alignItems:"end"},children:[e.jsxs("div",{className:"form-group",style:{marginBottom:0},children:[e.jsx("label",{className:"form-label",style:{fontSize:"0.75rem",color:"rgba(255,255,255,0.7)"},children:"TOPIC / CONCEPT"}),e.jsx("input",{type:"text",placeholder:"e.g., JOINs, Aggregate Functions, Subqueries",value:P.topic,onChange:s=>V({...P,topic:s.target.value}),style:{width:"100%"}})]}),e.jsxs("div",{className:"form-group",style:{marginBottom:0},children:[e.jsx("label",{className:"form-label",style:{fontSize:"0.75rem",color:"rgba(255,255,255,0.7)"},children:"DIFFICULTY"}),e.jsxs("select",{value:P.difficulty,onChange:s=>V({...P,difficulty:s.target.value}),children:[e.jsx("option",{value:"Easy",children:"Easy"}),e.jsx("option",{value:"Medium",children:"Medium"}),e.jsx("option",{value:"Hard",children:"Hard"})]})]}),e.jsx("button",{type:"button",className:"btn-create-new",onClick:Ms,disabled:Ye,style:{background:"linear-gradient(135deg, #06b6d4, #8b5cf6)"},children:Ye?e.jsxs(e.Fragment,{children:[e.jsx(Te,{size:16,className:"spin"})," Generating..."]}):e.jsxs(e.Fragment,{children:[e.jsx(ps,{size:16})," Generate"]})})]}),ue.length>0&&e.jsxs("div",{style:{marginTop:"1rem",padding:"1rem",background:"rgba(6,182,212,0.1)",borderRadius:"12px",border:"1px solid rgba(6,182,212,0.2)"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"0.75rem"},children:[e.jsxs("span",{style:{fontWeight:600,color:"#06b6d4"},children:["âœ“ Generated ",ue.length," Problem(s)"]}),e.jsxs("button",{type:"button",className:"btn-create-new",onClick:Ds,style:{background:"linear-gradient(135deg, #06b6d4, #0891b2)"},children:[e.jsx(Ae,{size:16})," Add to Section"]})]}),ue.map((s,m)=>e.jsxs("div",{style:{padding:"0.75rem",background:"rgba(0,0,0,0.2)",borderRadius:"8px",marginTop:"0.5rem"},children:[e.jsxs("p",{style:{margin:"0 0 0.5rem",fontWeight:500,color:"white"},children:[s.question?.substring(0,150),"..."]}),e.jsx("span",{style:{fontSize:"0.75rem",color:"rgba(255,255,255,0.6)"},children:"Schema included"})]},m))]})]}),e.jsxs("div",{style:{padding:"1.5rem",background:"var(--bg-secondary)",borderRadius:"16px",border:"1px solid var(--border-color)"},children:[e.jsxs("h4",{style:{display:"flex",alignItems:"center",gap:"0.5rem",margin:"0 0 1rem",fontSize:"1rem",color:"var(--text)"},children:[e.jsx(Qe,{size:18})," Manual Entry"]}),e.jsxs("div",{className:"form-group",style:{marginBottom:"1rem"},children:[e.jsx("label",{className:"form-label",children:"Question / instruction"}),e.jsx("textarea",{value:h.question,onChange:s=>B({...h,question:s.target.value}),placeholder:"e.g. Write a query to return the top 5 employees by salary",rows:2,style:{width:"100%",resize:"vertical"}})]}),e.jsxs("div",{className:"form-group",style:{marginBottom:"1rem"},children:[e.jsx("label",{className:"form-label",children:"Database schema (CREATE TABLE + INSERT)"}),e.jsx("textarea",{value:h.schema,onChange:s=>B({...h,schema:s.target.value}),placeholder:`CREATE TABLE employees (id INT, name TEXT, salary INT);
INSERT INTO employees VALUES (1,'A',100);`,rows:6,style:{width:"100%",fontFamily:"monospace",fontSize:"0.85rem",resize:"vertical"}})]}),e.jsxs("div",{className:"form-group",style:{marginBottom:"1rem"},children:[e.jsx("label",{className:"form-label",children:"Expected query result (exact output to match)"}),e.jsx("textarea",{value:h.expectedOutput,onChange:s=>B({...h,expectedOutput:s.target.value}),placeholder:"Paste the expected result as shown by SQLite",rows:4,style:{width:"100%",fontFamily:"monospace",fontSize:"0.85rem",resize:"vertical"}})]}),e.jsx("button",{type:"button",className:"btn-create-new",onClick:Vs,children:"Add this SQL question"})]}),e.jsxs("div",{style:{marginTop:"2rem"},children:[z.sql?.length>0&&e.jsxs("h4",{style:{color:"white",marginBottom:"1rem",fontSize:"1rem"},children:["Added SQL Problems (",z.sql.length,")"]}),z.sql?.map((s,m)=>e.jsx("div",{className:"card glass",style:{marginBottom:"1rem",padding:"1rem",background:"rgba(6, 182, 212, 0.05)",border:"1px solid rgba(6, 182, 212, 0.2)",borderRadius:"12px"},children:e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start"},children:[e.jsxs("div",{children:[e.jsxs("h5",{style:{margin:"0 0 0.5rem",color:"#60a5fa",fontSize:"1rem"},children:[s.question?.substring(0,100),"..."]}),e.jsxs("span",{style:{fontSize:"0.8rem",color:"rgba(255,255,255,0.6)"},children:["SQL Problem â€¢ ",Array.isArray(s.testCases)?s.testCases:s.schema?1:0," test case(s)"]})]}),e.jsxs("div",{style:{display:"flex",gap:"0.5rem"},children:[e.jsxs("button",{type:"button",onClick:()=>E({index:m,section:"sql"}),style:{padding:"0.5rem 0.75rem",background:"#06b6d4",border:"none",borderRadius:"8px",color:"white",cursor:"pointer",display:"flex",alignItems:"center",gap:"0.5rem",fontSize:"0.85rem"},children:[e.jsx(rt,{size:16})," Manage Data"]}),e.jsx("button",{type:"button",onClick:()=>{_(T=>({...T,sql:T.sql.filter((O,K)=>K!==m)}))},style:{padding:"0.5rem",background:"rgba(239, 68, 68, 0.2)",border:"none",borderRadius:"8px",color:"#ef4444",cursor:"pointer"},children:e.jsx(Le,{size:16})})]})]})},m))]})]}),c!=="coding"&&c!=="sql"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"card glass",style:{marginBottom:"1.5rem",padding:"1.25rem",background:"var(--bg-secondary)",border:"1px solid var(--border-color)",borderRadius:"12px"},children:[e.jsxs("h4",{style:{display:"flex",alignItems:"center",gap:"0.5rem",margin:"0 0 1rem",fontSize:"1rem"},children:[e.jsx(Ve,{size:18,style:{color:"var(--primary)"}})," AI Question Generator"]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr auto auto auto",gap:"0.75rem",alignItems:"end",flexWrap:"wrap"},children:[e.jsxs("div",{className:"form-group",style:{marginBottom:0},children:[e.jsx("label",{className:"form-label",children:"TOPIC"}),e.jsx("input",{type:"text",placeholder:"e.g., Number Series, Logical Reasoning",value:ge.topic,onChange:s=>ye({...ge,topic:s.target.value}),style:{width:"100%"}})]}),e.jsxs("div",{className:"form-group",style:{marginBottom:0},children:[e.jsx("label",{className:"form-label",children:"DIFFICULTY"}),e.jsxs("select",{value:ge.difficulty,onChange:s=>ye({...ge,difficulty:s.target.value}),children:[e.jsx("option",{value:"Easy",children:"Easy"}),e.jsx("option",{value:"Medium",children:"Medium"}),e.jsx("option",{value:"Hard",children:"Hard"})]})]}),e.jsxs("div",{className:"form-group",style:{marginBottom:0},children:[e.jsx("label",{className:"form-label",children:"COUNT"}),e.jsx("input",{type:"number",min:"1",max:"20",value:ge.count,onChange:s=>ye({...ge,count:parseInt(s.target.value)||1}),style:{width:70}})]}),e.jsxs("button",{type:"button",className:"btn-create-new",onClick:Fs,disabled:H,style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[e.jsx(Ve,{size:16})," ",H?"Generatingâ€¦":"Generate"]})]}),ke.length>0&&e.jsxs("div",{style:{marginTop:"1rem",display:"flex",alignItems:"center",gap:"0.5rem"},children:[e.jsxs("span",{style:{fontSize:"0.9rem",color:"var(--text-muted)"},children:[ke.length," question(s) generated."]}),e.jsx("button",{type:"button",className:"btn-create-new",onClick:Qs,style:{fontSize:"0.9rem"},children:"Add All to Test"})]})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"1rem"},children:[e.jsxs("h4",{style:{display:"flex",alignItems:"center",gap:"0.5rem",margin:0,fontSize:"1rem"},children:[e.jsx(vs,{size:18,style:{color:"var(--text-muted)"}})," Questions"]}),e.jsxs("span",{style:{fontSize:"0.9rem",color:"var(--text-muted)"},children:[(z[c]||[]).length," questions"]})]}),e.jsxs("div",{style:{maxHeight:"50vh",overflowY:"auto",marginBottom:"1rem"},children:[(z[c]||[]).map((s,m)=>e.jsxs("div",{className:"card glass",style:{marginBottom:"1rem",padding:"1.25rem",background:"var(--bg-card)",border:"1px solid var(--border-color)",borderRadius:"12px"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",marginBottom:"0.75rem"},children:[e.jsxs("span",{style:{background:"var(--primary)",color:"white",padding:"0.25rem 0.6rem",borderRadius:"8px",fontWeight:600,fontSize:"0.85rem"},children:["Q",m+1]}),e.jsx("button",{type:"button",onClick:()=>es(c,m),className:"btn-reset",style:{color:"var(--danger)",padding:"0.25rem"},title:"Delete question",children:e.jsx(Le,{size:18})})]}),e.jsxs("div",{className:"form-group",style:{marginBottom:"1rem"},children:[e.jsx("label",{className:"form-label",children:"QUESTION TEXT"}),e.jsx("textarea",{value:s.question||"",onChange:T=>_t(c,m,"question",T.target.value),placeholder:"Enter question text...",rows:2,style:{width:"100%",resize:"vertical"}})]}),e.jsxs("div",{className:"form-group",style:{marginBottom:"0.75rem"},children:[e.jsx("label",{className:"form-label",children:"ANSWER OPTIONS"}),e.jsx("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"0.5rem"},children:[0,1,2,3].map(T=>{const O=s.options||["","","",""],K=(s.correctAnswer??0)===T;return e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[e.jsx("button",{type:"button",onClick:()=>_t(c,m,"correctAnswer",T),style:{minWidth:36,height:36,borderRadius:"8px",border:"2px solid "+(K?"var(--success)":"var(--border-color)"),background:K?"var(--success-alpha)":"var(--bg-secondary)",color:K?"var(--success)":"var(--text-muted)",fontWeight:700,cursor:"pointer",flexShrink:0},children:String.fromCharCode(65+T)}),e.jsx("input",{type:"text",value:O[T]||"",onChange:F=>{const se=[...O];se[T]=F.target.value,_t(c,m,"options",se)},placeholder:`Option ${String.fromCharCode(65+T)}`,style:{flex:1}})]},T)})})]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem",padding:"0.5rem 0.75rem",background:"var(--success-alpha)",borderRadius:"8px",border:"1px solid var(--success)"},children:[e.jsx(js,{size:18,style:{color:"var(--success)",flexShrink:0}}),e.jsx("span",{style:{fontSize:"0.9rem",color:"var(--success)",fontWeight:500},children:"Correct Answer:"}),e.jsxs("span",{style:{background:"var(--success)",color:"white",padding:"0.2rem 0.5rem",borderRadius:"6px",fontSize:"0.85rem"},children:["Option ",String.fromCharCode(65+(s.correctAnswer??0))]}),e.jsx("span",{style:{marginLeft:"auto",fontSize:"0.8rem",color:"var(--text-muted)"},children:"Click any option badge to change"})]})]},m)),e.jsxs("button",{type:"button",onClick:Us,style:{width:"100%",padding:"1.25rem",border:"2px dashed var(--border-color)",borderRadius:"12px",background:"transparent",color:"var(--text-muted)",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",gap:"0.5rem",fontSize:"1rem"},children:[e.jsx(Ae,{size:20})," Add New Question"]})]})]}),(c==="coding"||c==="sql")&&e.jsxs("div",{style:{marginTop:"1rem",marginBottom:"1rem"},children:[e.jsxs("strong",{children:["Added in ",ut.find(s=>s.id===c)?.label,":"]}),e.jsx("ul",{style:{margin:"0.5rem 0",paddingLeft:"1.5rem",maxHeight:200,overflow:"auto"},children:(z[c]||[]).map((s,m)=>e.jsxs("li",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsx("span",{style:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",maxWidth:400},children:s.question}),e.jsx("button",{type:"button",onClick:()=>es(c,m),className:"btn-reset",style:{color:"var(--danger)"},children:e.jsx(le,{size:16})})]},m))})]}),e.jsxs("div",{style:{display:"flex",gap:"0.5rem",justifyContent:"space-between"},children:[e.jsx("button",{type:"button",className:"btn-reset",onClick:()=>k(1),children:"Back"}),e.jsxs("button",{type:"button",className:"btn-create-new",onClick:$s,children:[f?"Update":"Create"," Test"]})]})]})]})," "]})})]})}function ei(){const[t,j]=i.useState([]),[W,N]=i.useState(!0),[y,b]=i.useState(!1),[x,k]=i.useState(!1),[f,u]=i.useState(null),[c,d]=i.useState(!1),[n,E]=i.useState([]),[D,g]=i.useState({topic:"",difficulty:"Medium",count:5}),[S,A]=i.useState([]),[C,o]=i.useState(!1),M=i.useRef(null),[w,L]=i.useState(!1),[$,te]=i.useState([]),[X,ee]=i.useState([]),[ne,v]=i.useState(null),[Y,z]=i.useState(""),[_,J]=i.useState({title:"",difficulty:"Medium",duration:30,passingScore:60,maxTabSwitches:3,maxAttempts:1,startTime:"",deadline:"",description:"",status:"live",questions:[]}),[we,p]=i.useState({question:"",options:["","","",""],correctAnswer:0,category:"general",explanation:""});i.useEffect(()=>{h(),B(),G()},[]);const G=async()=>{try{const a=await I.get(`${Q}/users?role=student`);te(a.data||[])}catch(a){console.error("Error fetching students:",a)}},h=async()=>{try{const a=await I.get(`${Q}/aptitude`);j(a.data),N(!1)}catch(a){console.error("Error fetching tests:",a),N(!1)}},B=async()=>{try{const a=await I.get(`${Q}/aptitude-submissions`);A(a.data)}catch(a){console.error("Error fetching submissions:",a)}},Z=async a=>{v(a);try{const q=await I.get(`${Q}/aptitude/${a}/allocated-students`);ee(q.data.studentIds||[])}catch{ee([])}L(!0)},xe=async()=>{if(ne)try{await I.post(`${Q}/aptitude/${ne}/allocate-students`,{studentIds:X}),alert(`âœ… Test allocated to ${X.length} student(s)`),L(!1),ee([]),v(null)}catch(a){alert("âŒ Error allocating test: "+a.response?.data?.error||a.message)}},ge=a=>{ee(q=>q.includes(a)?q.filter(P=>P!==a):[...q,a])},ye=async()=>{d(!0);try{const a=await I.post(`${Q}/ai/generate-aptitude`,D);a.data.questions&&E(a.data.questions)}catch{alert("Error generating questions")}finally{d(!1)}},ke=()=>{J(a=>({...a,questions:[...a.questions,...n]})),E([])},l=async a=>{if(a&&a.preventDefault(),_.questions.length===0){alert("Please add at least one question");return}if(_.questions.filter(P=>!P.question.trim()||P.options.some(V=>!V.trim())).length>0){alert("Please fill in all questions and options");return}try{const P={..._,createdBy:We};if(P.startTime){const V=new Date(P.startTime);isNaN(V.getTime())||(P.startTime=V.toISOString())}if(P.deadline){const V=new Date(P.deadline);isNaN(V.getTime())||(P.deadline=V.toISOString())}await I.post(`${Q}/aptitude`,P),b(!1),J({title:"",difficulty:"Medium",duration:30,passingScore:60,maxTabSwitches:3,maxAttempts:1,startTime:"",deadline:"",description:"",status:"live",questions:[]}),h()}catch(P){console.error(P),alert(P.response?.data?.error||"Error creating test")}},H=async a=>{const q=a.target.files[0];if(q){o(!0);try{const V=(await q.text()).split(`
`).map(je=>je.trim()).filter(Boolean);if(V.length<2){alert("CSV must have header + at least one row");return}const de=V[0].split(",").map(je=>je.trim().toLowerCase().replace(/['"]/g,"")),U=[];for(let je=1;je<V.length;je++){const Pe=V[je].match(/(".*?"|[^,]+)/g)?.map(Ye=>Ye.trim().replace(/^"|"$/g,""))||[],ce={};de.forEach((Ye,Je)=>ce[Ye]=Pe[Je]||""),ce.question&&U.push({question:ce.question,options:[ce.option1||ce.option_1||"",ce.option2||ce.option_2||"",ce.option3||ce.option_3||"",ce.option4||ce.option_4||""],correctAnswer:parseInt(ce.correctanswer||ce.correct_answer||ce.answer||"0"),category:ce.category||"general",explanation:ce.explanation||""})}if(U.length===0){alert("No valid rows. CSV needs: question,option1,option2,option3,option4,correctAnswer"),o(!1);return}const ue={title:q.name.replace(".csv","")+" - CSV Import",difficulty:"Medium",duration:Math.max(30,U.length*2),passingScore:60,maxTabSwitches:3,maxAttempts:1,status:"draft",createdBy:We,questions:U};await I.post(`${Q}/aptitude`,ue),alert(`Created aptitude test with ${U.length} questions from CSV!`),h()}catch(P){alert("CSV upload failed: "+(P.response?.data?.error||P.message))}finally{o(!1),a.target.value=""}}},ie=async a=>{const q=a.status==="live"?"ended":"live",P=q==="live"?"make this test visible to students":"hide this test from students";if(window.confirm(`Are you sure you want to ${P}?`))try{await I.patch(`${Q}/aptitude/${a.id}/status`,{status:q}),h()}catch{alert("Error updating test status")}},r=async a=>{if(window.confirm("Delete this aptitude test?"))try{await I.delete(`${Q}/aptitude/${a}`),h()}catch(q){console.error(q),alert("Error deleting test")}},R=a=>{J(q=>({...q,questions:q.questions.filter((P,V)=>V!==a)}))};return W?e.jsx("div",{className:"loading-spinner"}):e.jsxs("div",{className:"animate-fadeIn",children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"2rem"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"1rem"},children:[e.jsx("div",{style:{width:"56px",height:"56px",borderRadius:"16px",background:"linear-gradient(135deg, #8b5cf6, #6366f1)",display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsx(Ne,{size:28,color:"white"})}),e.jsxs("div",{children:[e.jsx("h2",{style:{margin:0,fontSize:"1.5rem",fontWeight:700},children:"Aptitude Tests"}),e.jsx("p",{style:{margin:0,color:"var(--text-muted)"},children:"Create and manage aptitude tests for students"})]})]}),e.jsxs("div",{style:{display:"flex",gap:"0.75rem",flexWrap:"wrap"},children:[e.jsx("input",{type:"file",accept:".csv",ref:M,style:{display:"none"},onChange:H}),e.jsxs("button",{onClick:()=>M.current?.click(),disabled:C,className:"btn-create-new premium-btn",style:{padding:"0.75rem 1.25rem",background:"linear-gradient(135deg, #10b981, #059669)",borderRadius:"1rem",fontSize:"0.95rem",fontWeight:600,display:"flex",alignItems:"center",gap:"0.5rem"},children:[e.jsx(Nt,{size:18})," ",C?"Uploading...":"CSV Upload"]}),e.jsxs("button",{onClick:()=>b(!0),className:"btn-create-new premium-btn",style:{padding:"0.75rem 1.25rem",background:"linear-gradient(135deg, #8b5cf6, #6366f1)",borderRadius:"1rem",fontSize:"0.95rem",fontWeight:600,display:"flex",alignItems:"center",gap:"0.5rem"},children:[e.jsx(Ae,{size:20})," Create New Test"]})]})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(4, 1fr)",gap:"1rem",marginBottom:"2rem"},children:[e.jsxs("div",{className:"stat-card glass",children:[e.jsx("div",{className:"stat-icon",style:{background:"rgba(139, 92, 246, 0.1)",color:"#8b5cf6"},children:e.jsx(Ne,{size:24})}),e.jsxs("div",{className:"stat-info",children:[e.jsx("span",{className:"stat-label",children:"Total Tests"}),e.jsx("span",{className:"stat-value",children:t.length})]})]}),e.jsxs("div",{className:"stat-card glass",children:[e.jsx("div",{className:"stat-icon",style:{background:"rgba(16, 185, 129, 0.1)",color:"#10b981"},children:e.jsx(oe,{size:24})}),e.jsxs("div",{className:"stat-info",children:[e.jsx("span",{className:"stat-label",children:"Live Tests"}),e.jsx("span",{className:"stat-value",children:t.filter(a=>a.status==="live").length})]})]}),e.jsxs("div",{className:"stat-card glass",children:[e.jsx("div",{className:"stat-icon",style:{background:"rgba(59, 130, 246, 0.1)",color:"#3b82f6"},children:e.jsx(Gt,{size:24})}),e.jsxs("div",{className:"stat-info",children:[e.jsx("span",{className:"stat-label",children:"Submissions"}),e.jsx("span",{className:"stat-value",children:S.length})]})]}),e.jsxs("div",{className:"stat-card glass",children:[e.jsx("div",{className:"stat-icon",style:{background:"rgba(245, 158, 11, 0.1)",color:"#f59e0b"},children:e.jsx(et,{size:24})}),e.jsxs("div",{className:"stat-info",children:[e.jsx("span",{className:"stat-label",children:"Pass Rate"}),e.jsxs("span",{className:"stat-value",children:[S.length>0?Math.round(S.filter(a=>a.status==="passed").length/S.length*100):0,"%"]})]})]})]}),e.jsxs("div",{className:"card glass",children:[e.jsxs("h3",{style:{display:"flex",alignItems:"center",gap:"8px",marginBottom:"24px"},children:[e.jsx(Ne,{size:20,style:{color:"#8b5cf6"}})," All Aptitude Tests"]}),e.jsx("div",{className:"table-container",style:{border:"none"},children:e.jsxs("table",{className:"modern-table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Test Title"}),e.jsx("th",{children:"Difficulty"}),e.jsx("th",{children:"Questions"}),e.jsx("th",{children:"Duration"}),e.jsx("th",{children:"Pass %"}),e.jsx("th",{children:"Status"}),e.jsx("th",{children:"Actions"})]})}),e.jsx("tbody",{children:t.map(a=>e.jsxs("tr",{children:[e.jsx("td",{children:e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.75rem"},children:[e.jsx("div",{style:{width:"36px",height:"36px",borderRadius:"8px",background:"linear-gradient(135deg, #8b5cf6, #6366f1)",display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsx(Ne,{size:16,color:"white"})}),e.jsx("span",{style:{fontWeight:500},children:a.title})]})}),e.jsx("td",{children:e.jsx("span",{className:`difficulty-badge ${a.difficulty?.toLowerCase()}`,children:a.difficulty})}),e.jsx("td",{children:a.questionCount||a.totalQuestions}),e.jsxs("td",{children:[a.duration," min"]}),e.jsxs("td",{children:[a.passingScore,"%"]}),e.jsx("td",{children:e.jsx("span",{style:{padding:"0.25rem 0.75rem",borderRadius:"20px",background:a.status==="live"?"rgba(16, 185, 129, 0.15)":a.status==="ended"?"rgba(239, 68, 68, 0.15)":"rgba(107, 114, 128, 0.15)",color:a.status==="live"?"#10b981":a.status==="ended"?"#ef4444":"#6b7280",fontSize:"0.8rem",fontWeight:500},children:a.status})}),e.jsx("td",{children:e.jsxs("div",{style:{display:"flex",gap:"0.5rem",flexWrap:"wrap"},children:[e.jsx("button",{onClick:()=>{u(a),k(!0)},style:{padding:"0.4rem 0.8rem",background:"rgba(59, 130, 246, 0.1)",border:"1px solid rgba(59, 130, 246, 0.3)",borderRadius:"6px",color:"#3b82f6",cursor:"pointer",fontSize:"0.8rem"},children:"View"}),e.jsx("button",{onClick:()=>Z(a.id),style:{padding:"0.4rem 0.8rem",background:"rgba(168, 85, 247, 0.1)",border:"1px solid rgba(168, 85, 247, 0.3)",borderRadius:"6px",color:"#a855f7",cursor:"pointer",fontSize:"0.8rem",whiteSpace:"nowrap"},title:"Assign this test to specific students",children:"ðŸ‘¥ Assign"}),e.jsx("button",{onClick:()=>ie(a),style:{padding:"0.4rem 0.8rem",background:a.status==="live"?"rgba(245, 158, 11, 0.1)":"rgba(16, 185, 129, 0.1)",border:a.status==="live"?"1px solid rgba(245, 158, 11, 0.3)":"1px solid rgba(16, 185, 129, 0.3)",borderRadius:"6px",color:a.status==="live"?"#f59e0b":"#10b981",cursor:"pointer",fontSize:"0.8rem"},title:a.status==="live"?"End test (hide from students)":"Make test live (show to students)",children:a.status==="live"?"End":"Activate"}),e.jsx("button",{onClick:()=>r(a.id),style:{padding:"0.4rem 0.8rem",background:"rgba(239, 68, 68, 0.1)",border:"1px solid rgba(239, 68, 68, 0.3)",borderRadius:"6px",color:"#ef4444",cursor:"pointer",fontSize:"0.8rem"},children:"Delete"})]})})]},a.id))})]})})]}),y&&e.jsx("div",{className:"modal-overlay",onClick:()=>b(!1),children:e.jsxs("div",{className:"modal-content",onClick:a=>a.stopPropagation(),style:{maxWidth:"800px",maxHeight:"90vh",overflowY:"auto"},children:[e.jsxs("div",{className:"modal-header",children:[e.jsxs("div",{className:"modal-title-with-icon",children:[e.jsx("div",{style:{width:"40px",height:"40px",borderRadius:"10px",background:"linear-gradient(135deg, #8b5cf6, #6366f1)",display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsx(Ne,{size:20,color:"white"})}),e.jsx("h2",{children:"Create Aptitude Test"})]}),e.jsx("button",{onClick:()=>b(!1),className:"modal-close",children:e.jsx(le,{size:20})})]}),e.jsxs("form",{onSubmit:l,className:"modal-body",children:[e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"2fr 1fr 1fr",gap:"1rem",marginBottom:"1rem"},children:[e.jsxs("div",{className:"form-group",children:[e.jsxs("label",{className:"form-label",children:[e.jsx($e,{size:14,style:{marginRight:"0.5rem"}})," Test Title"]}),e.jsx("input",{type:"text",placeholder:"Enter test title...",value:_.title,onChange:a=>J({..._,title:a.target.value}),required:!0})]}),e.jsxs("div",{className:"form-group",children:[e.jsxs("label",{className:"form-label",children:[e.jsx(Ce,{size:14,style:{marginRight:"0.5rem"}})," Duration (mins)"]}),e.jsx("input",{type:"number",min:"5",max:"180",value:_.duration,onChange:a=>J({..._,duration:parseInt(a.target.value)})})]}),e.jsxs("div",{className:"form-group",children:[e.jsxs("label",{className:"form-label",children:[e.jsx(Te,{size:14,style:{marginRight:"0.5rem"}})," Attempts"]}),e.jsxs("select",{value:_.maxAttempts,onChange:a=>J({..._,maxAttempts:parseInt(a.target.value)}),children:[e.jsx("option",{value:1,children:"1 Attempt"}),e.jsx("option",{value:2,children:"2 Attempts"}),e.jsx("option",{value:3,children:"3 Attempts"}),e.jsx("option",{value:5,children:"5 Attempts"}),e.jsx("option",{value:-1,children:"Unlimited"})]})]})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr 1fr 1fr",gap:"1rem",marginBottom:"1rem"},children:[e.jsxs("div",{className:"form-group",children:[e.jsxs("label",{className:"form-label",children:[e.jsx(pe,{size:14,style:{marginRight:"0.5rem"}})," Max Tab Switches (Violations)"]}),e.jsx("input",{type:"number",min:"0",max:"20",value:_.maxTabSwitches,onChange:a=>J({..._,maxTabSwitches:parseInt(a.target.value)})}),e.jsx("small",{style:{color:"var(--text-muted)",fontSize:"0.75rem"},children:"Test auto-submits if exceeded"})]}),e.jsxs("div",{className:"form-group",children:[e.jsxs("label",{className:"form-label",children:[e.jsx(ms,{size:14,style:{marginRight:"0.5rem"}})," Start Time"]}),e.jsx("input",{type:"datetime-local",value:_.startTime,onChange:a=>J({..._,startTime:a.target.value})})]}),e.jsxs("div",{className:"form-group",children:[e.jsxs("label",{className:"form-label",children:[e.jsx(ms,{size:14,style:{marginRight:"0.5rem"}})," End Time (Deadline)"]}),e.jsx("input",{type:"datetime-local",value:_.deadline,onChange:a=>J({..._,deadline:a.target.value})})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Difficulty"}),e.jsxs("select",{value:_.difficulty,onChange:a=>J({..._,difficulty:a.target.value}),children:[e.jsx("option",{value:"Easy",children:"Easy"}),e.jsx("option",{value:"Medium",children:"Medium"}),e.jsx("option",{value:"Hard",children:"Hard"})]})]})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"1rem",marginBottom:"1rem"},children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Passing Score (%)"}),e.jsx("input",{type:"number",min:"0",max:"100",value:_.passingScore,onChange:a=>J({..._,passingScore:parseInt(a.target.value)})})]}),e.jsxs("div",{className:"form-group",children:[e.jsxs("label",{className:"form-label",children:[e.jsx(Ct,{size:14,style:{marginRight:"0.5rem"}})," Test Status"]}),e.jsxs("select",{value:_.status,onChange:a=>J({..._,status:a.target.value}),children:[e.jsx("option",{value:"live",children:"Live - Visible to students"}),e.jsx("option",{value:"ended",children:"Ended - Hidden from students"})]})]})]}),e.jsxs("div",{className:"form-group",style:{marginBottom:"1.5rem"},children:[e.jsxs("label",{className:"form-label",children:[e.jsx($e,{size:14,style:{marginRight:"0.5rem"}})," Description (Optional)"]}),e.jsx("textarea",{placeholder:"Brief description of the test...",value:_.description,onChange:a=>J({..._,description:a.target.value}),rows:3,style:{width:"100%",resize:"vertical"}})]}),e.jsxs("div",{style:{background:"var(--secondary-alpha)",border:"1px solid var(--secondary)",borderRadius:"12px",padding:"1.5rem",marginBottom:"1.5rem"},children:[e.jsxs("h4",{style:{display:"flex",alignItems:"center",gap:"0.5rem",margin:"0 0 1rem",color:"var(--text-primary)"},children:[e.jsx(Ve,{size:18,color:"var(--secondary)"})," AI Question Generator"]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"2fr 1fr 1fr auto",gap:"1rem",alignItems:"end"},children:[e.jsxs("div",{className:"form-group",style:{margin:0},children:[e.jsx("label",{className:"form-label",children:"TOPIC"}),e.jsx("input",{type:"text",placeholder:"e.g., Number Series, Logical Reasoning...",value:D.topic,onChange:a=>g({...D,topic:a.target.value})})]}),e.jsxs("div",{className:"form-group",style:{margin:0},children:[e.jsx("label",{className:"form-label",children:"DIFFICULTY"}),e.jsxs("select",{value:D.difficulty,onChange:a=>g({...D,difficulty:a.target.value}),children:[e.jsx("option",{value:"Easy",children:"Easy"}),e.jsx("option",{value:"Medium",children:"Medium"}),e.jsx("option",{value:"Hard",children:"Hard"})]})]}),e.jsxs("div",{className:"form-group",style:{margin:0},children:[e.jsx("label",{className:"form-label",children:"COUNT"}),e.jsx("input",{type:"number",min:"1",max:"20",value:D.count,onChange:a=>g({...D,count:parseInt(a.target.value)})})]}),e.jsxs("button",{type:"button",onClick:ye,disabled:c,style:{padding:"0.75rem 1.5rem",background:"var(--primary)",border:"none",borderRadius:"8px",color:"white",fontWeight:600,cursor:c?"not-allowed":"pointer",display:"flex",alignItems:"center",gap:"0.5rem"},children:[e.jsx(Ve,{size:16}),c?"Generating...":"Generate"]})]}),n.length>0&&e.jsxs("div",{style:{marginTop:"1rem"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"0.5rem"},children:[e.jsxs("span",{style:{fontSize:"0.9rem",color:"var(--secondary)",fontWeight:600},children:["âœ¨ Generated ",n.length," questions"]}),e.jsx("button",{type:"button",onClick:ke,style:{padding:"0.5rem 1rem",background:"var(--success-alpha)",border:"1px solid var(--success)",borderRadius:"6px",color:"var(--success)",fontSize:"0.85rem",fontWeight:600,cursor:"pointer"},children:"Add All to Test"})]}),e.jsx("div",{style:{maxHeight:"150px",overflowY:"auto",background:"var(--bg-tertiary)",borderRadius:"8px",padding:"0.75rem"},children:n.map((a,q)=>e.jsxs("div",{style:{padding:"0.5rem",borderBottom:q<n.length-1?"1px solid var(--border-color)":"none",fontSize:"0.85rem",color:"var(--text-primary)"},children:["Q",q+1,": ",a.question.substring(0,80),"..."]},q))})]})]}),e.jsxs("div",{style:{marginBottom:"1.5rem"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:"1.25rem",paddingBottom:"0.75rem",borderBottom:"1px solid var(--border-color)"},children:[e.jsxs("h4",{style:{display:"flex",alignItems:"center",gap:"0.5rem",margin:0,color:"var(--text-primary)",fontSize:"1rem",fontWeight:600},children:[e.jsx(vs,{size:18,style:{color:"var(--primary)"}})," Questions"]}),e.jsxs("span",{style:{fontSize:"0.8rem",color:"var(--primary)",background:"var(--primary-alpha)",padding:"0.35rem 0.75rem",borderRadius:"20px",fontWeight:500},children:[_.questions.length," question",_.questions.length!==1?"s":""]})]}),e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"1.25rem"},children:[_.questions.map((a,q)=>e.jsxs("div",{style:{background:"var(--bg-card)",borderRadius:"16px",padding:"1.5rem",border:"1px solid var(--border-color)",boxShadow:"var(--card-shadow)",transition:"all 0.2s ease"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"1.25rem"},children:[e.jsx("div",{style:{display:"flex",alignItems:"center",gap:"0.75rem"},children:e.jsxs("span",{style:{background:"linear-gradient(135deg, var(--primary), var(--secondary))",color:"white",padding:"0.4rem 0.8rem",borderRadius:"8px",fontSize:"0.75rem",fontWeight:700,letterSpacing:"0.5px",textTransform:"uppercase"},children:["Q",q+1]})}),e.jsx("button",{type:"button",onClick:()=>R(q),style:{background:"var(--danger-alpha)",border:"1px solid var(--danger)",borderRadius:"8px",padding:"0.5rem",cursor:"pointer",color:"var(--danger)",display:"flex",alignItems:"center",justifyContent:"center",transition:"all 0.2s"},onMouseOver:P=>{P.currentTarget.style.background="var(--danger)",P.currentTarget.style.color="white"},onMouseOut:P=>{P.currentTarget.style.background="var(--danger-alpha)",P.currentTarget.style.color="var(--danger)"},children:e.jsx(Le,{size:16})})]}),e.jsxs("div",{style:{marginBottom:"1.25rem"},children:[e.jsx("label",{style:{fontSize:"0.75rem",fontWeight:600,color:"var(--text-muted)",textTransform:"uppercase",letterSpacing:"0.5px",marginBottom:"0.5rem",display:"block"},children:"Question Text"}),e.jsx("input",{type:"text",value:a.question,onChange:P=>{const V=[..._.questions];V[q]={...V[q],question:P.target.value},J({..._,questions:V})},placeholder:"Enter your question here...",style:{width:"100%",padding:"0.875rem 1rem",fontSize:"0.95rem",borderRadius:"10px",border:"2px solid var(--border-color)",background:"var(--bg-primary)",color:"var(--text-primary)",transition:"border-color 0.2s"}})]}),e.jsxs("div",{style:{marginBottom:"1.25rem"},children:[e.jsx("label",{style:{fontSize:"0.75rem",fontWeight:600,color:"var(--text-muted)",textTransform:"uppercase",letterSpacing:"0.5px",marginBottom:"0.75rem",display:"block"},children:"Answer Options"}),e.jsx("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"0.875rem"},children:["A","B","C","D"].map((P,V)=>e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.75rem",background:a.correctAnswer===V?"var(--success-alpha)":"var(--bg-primary)",padding:"0.5rem",borderRadius:"10px",border:a.correctAnswer===V?"2px solid var(--success)":"2px solid var(--border-color)",transition:"all 0.2s"},children:[e.jsx("span",{onClick:()=>{const de=[..._.questions];de[q]={...de[q],correctAnswer:V},J({..._,questions:de})},style:{width:"32px",height:"32px",borderRadius:"8px",background:a.correctAnswer===V?"var(--success)":"var(--bg-tertiary)",display:"flex",alignItems:"center",justifyContent:"center",fontWeight:700,fontSize:"0.85rem",color:a.correctAnswer===V?"white":"var(--text-muted)",flexShrink:0,cursor:"pointer",transition:"all 0.2s",border:a.correctAnswer===V?"none":"1px solid var(--border-color)"},title:"Click to set as correct answer",children:P}),e.jsx("input",{type:"text",value:a.options[V]||"",onChange:de=>{const U=[..._.questions],ue=[...U[q].options];ue[V]=de.target.value,U[q]={...U[q],options:ue},J({..._,questions:U})},placeholder:`Option ${P}`,style:{flex:1,padding:"0.625rem 0.875rem",borderRadius:"8px",border:"none",background:"transparent",color:"var(--text-primary)",fontSize:"0.9rem"}})]},V))})]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.75rem",padding:"0.875rem 1rem",background:"var(--success-alpha)",borderRadius:"10px",border:"1px solid var(--success)"},children:[e.jsx(oe,{size:18,color:"var(--success)"}),e.jsx("span",{style:{fontSize:"0.875rem",fontWeight:500,color:"var(--text-primary)"},children:"Correct Answer:"}),e.jsxs("span",{style:{background:"var(--success)",color:"white",padding:"0.375rem 0.875rem",borderRadius:"6px",fontWeight:600,fontSize:"0.85rem"},children:["Option ",["A","B","C","D"][a.correctAnswer]]}),e.jsx("span",{style:{marginLeft:"auto",fontSize:"0.75rem",color:"var(--text-muted)"},children:"Click any option badge to change"})]})]},q)),e.jsxs("button",{type:"button",onClick:()=>{J(a=>({...a,questions:[...a.questions,{question:"",options:["","","",""],correctAnswer:0,category:"general",explanation:""}]}))},style:{padding:"1.25rem",background:"var(--bg-card)",border:"2px dashed var(--border-color)",borderRadius:"16px",color:"var(--text-muted)",fontWeight:600,cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",gap:"0.75rem",transition:"all 0.2s",fontSize:"0.95rem"},onMouseOver:a=>{a.currentTarget.style.borderColor="var(--primary)",a.currentTarget.style.color="var(--primary)",a.currentTarget.style.background="var(--primary-alpha)"},onMouseOut:a=>{a.currentTarget.style.borderColor="var(--border-color)",a.currentTarget.style.color="var(--text-muted)",a.currentTarget.style.background="var(--bg-card)"},children:[e.jsx(Ae,{size:20})," Add New Question"]})]})]}),e.jsxs("div",{className:"form-actions",style:{borderTop:"1px solid var(--border-color)",paddingTop:"1.5rem",marginTop:"0.5rem"},children:[e.jsxs("button",{type:"button",className:"btn-reset",onClick:()=>b(!1),children:[e.jsx(le,{size:16})," Cancel"]}),e.jsxs("button",{type:"submit",className:"btn-create-new",disabled:_.questions.length===0,children:[e.jsx(At,{size:16})," Create Test"]})]})]})]})}),x&&f&&e.jsx("div",{className:"modal-overlay",onClick:()=>k(!1),children:e.jsxs("div",{className:"modal-content",onClick:a=>a.stopPropagation(),style:{maxWidth:"700px",maxHeight:"80vh",overflowY:"auto"},children:[e.jsxs("div",{className:"modal-header",children:[e.jsxs("div",{className:"modal-title-with-icon",children:[e.jsx("div",{style:{width:"40px",height:"40px",borderRadius:"10px",background:"linear-gradient(135deg, #8b5cf6, #6366f1)",display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsx(Ne,{size:20,color:"white"})}),e.jsx("h2",{children:f.title})]}),e.jsx("button",{onClick:()=>k(!1),className:"modal-close",children:e.jsx(le,{size:20})})]}),e.jsxs("div",{className:"modal-body",children:[e.jsxs("p",{style:{color:"var(--text-muted)",marginBottom:"1.5rem"},children:[f.questionCount||f.totalQuestions," Questions â€¢ ",f.duration," minutes â€¢ Pass: ",f.passingScore,"%"]}),e.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"1rem"},children:f.questions?.map((a,q)=>e.jsxs("div",{style:{background:"var(--bg-tertiary)",borderRadius:"12px",padding:"1.25rem",border:"1px solid var(--border-color)"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"flex-start",gap:"0.75rem",marginBottom:"0.75rem"},children:[e.jsxs("span",{style:{background:"linear-gradient(135deg, #8b5cf6, #6366f1)",color:"white",padding:"0.25rem 0.5rem",borderRadius:"6px",fontSize:"0.8rem",fontWeight:600},children:["Q",q+1]}),e.jsx("span",{style:{fontWeight:500},children:a.question})]}),e.jsx("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"0.5rem",marginLeft:"2.5rem"},children:a.options?.map((P,V)=>e.jsxs("div",{style:{padding:"0.5rem 0.75rem",background:P===a.correctAnswer?"rgba(16, 185, 129, 0.2)":"rgba(71, 85, 105, 0.3)",borderRadius:"8px",fontSize:"0.85rem",border:P===a.correctAnswer?"1px solid #10b981":"1px solid transparent"},children:[["A","B","C","D"][V],". ",P]},V))})]},q))})]})]})}),w&&e.jsx("div",{className:"modal-overlay",onClick:()=>{L(!1),z("")},children:e.jsxs("div",{className:"modal-content",onClick:a=>a.stopPropagation(),style:{maxWidth:"700px",maxHeight:"85vh",overflow:"hidden",display:"flex",flexDirection:"column"},children:[e.jsxs("div",{className:"modal-header",style:{padding:"1.5rem",borderBottom:"1px solid var(--border-color)"},children:[e.jsxs("div",{className:"modal-title-with-icon",children:[e.jsx("div",{style:{width:"40px",height:"40px",borderRadius:"10px",background:"linear-gradient(135deg, #a855f7, #9333ea)",display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsx(re,{size:20,color:"white"})}),e.jsxs("div",{children:[e.jsx("h2",{style:{margin:0,fontSize:"1.25rem"},children:"Assign Students"}),e.jsx("p",{style:{margin:0,fontSize:"0.8rem",color:"var(--text-muted)"},children:"Select students for this aptitude test"})]})]}),e.jsx("button",{onClick:()=>{L(!1),z("")},className:"modal-close",children:e.jsx(le,{size:20})})]}),e.jsxs("div",{style:{padding:"1rem 1.5rem",background:"var(--bg-secondary)",borderBottom:"1px solid var(--border-color)",display:"flex",gap:"1rem",alignItems:"center"},children:[e.jsxs("div",{style:{position:"relative",flex:1},children:[e.jsx(Se,{size:18,style:{position:"absolute",left:"12px",top:"50%",transform:"translateY(-50%)",color:"var(--text-muted)"}}),e.jsx("input",{type:"text",placeholder:"Search by name or batch...",value:Y,onChange:a=>z(a.target.value),style:{width:"100%",padding:"0.7rem 1rem 0.7rem 2.5rem",borderRadius:"10px",background:"var(--bg-card)",border:"1px solid var(--border-color)",color:"var(--text-main)",fontSize:"0.9rem"}})]}),e.jsx("button",{onClick:()=>{const a=$.filter(P=>(P.name||P.username||"").toLowerCase().includes(Y.toLowerCase())||(P.batch||"").toLowerCase().includes(Y.toLowerCase())),q=a.every(P=>X.includes(P.id));ee(q?P=>P.filter(V=>!a.map(de=>de.id).includes(V)):P=>[...new Set([...P,...a.map(V=>V.id)])])},style:{padding:"0.7rem 1.2rem",borderRadius:"10px",background:"var(--bg-card)",border:"1px solid var(--border-color)",color:"var(--text-main)",fontSize:"0.85rem",fontWeight:600,cursor:"pointer",whiteSpace:"nowrap"},children:$.filter(a=>(a.name||a.username||"").toLowerCase().includes(Y.toLowerCase())||(a.batch||"").toLowerCase().includes(Y.toLowerCase())).every(a=>X.includes(a.id))?"Deselect All":"Select All"})]}),e.jsx("div",{className:"modal-body",style:{overflowY:"auto",padding:"1.5rem",background:"var(--bg-primary)"},children:e.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(250px, 1fr))",gap:"1rem"},children:$.filter(a=>(a.name||a.username||"").toLowerCase().includes(Y.toLowerCase())||(a.batch||"").toLowerCase().includes(Y.toLowerCase())).length===0?e.jsxs("div",{style:{gridColumn:"1 / -1",textAlign:"center",padding:"3rem",opacity:.5},children:[e.jsx(re,{size:48,style:{marginBottom:"1rem",opacity:.2}}),e.jsx("p",{children:"No students found matching your search."})]}):$.filter(a=>(a.name||a.username||"").toLowerCase().includes(Y.toLowerCase())||(a.batch||"").toLowerCase().includes(Y.toLowerCase())).map(a=>e.jsxs("div",{onClick:()=>ge(a.id),style:{padding:"1rem",borderRadius:"1rem",background:X.includes(a.id)?"var(--primary-alpha)":"var(--bg-card)",border:`1.5px solid ${X.includes(a.id)?"var(--primary)":"var(--border-color)"}`,cursor:"pointer",display:"flex",alignItems:"center",gap:"1rem",transition:"all 0.2s",boxShadow:X.includes(a.id)?"0 4px 12px var(--primary-alpha)":"none"},children:[e.jsx("div",{style:{width:"36px",height:"36px",borderRadius:"50%",background:X.includes(a.id)?"var(--primary)":"var(--bg-secondary)",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"0.9rem",fontWeight:700,color:"white"},children:(a.name||a.username||"S").charAt(0).toUpperCase()}),e.jsxs("div",{style:{flex:1,minWidth:0},children:[e.jsx("div",{style:{fontWeight:600,fontSize:"0.9rem",color:"var(--text-main)",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:a.name||a.username}),e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--text-muted)",display:"flex",alignItems:"center",gap:"4px"},children:e.jsx("span",{style:{padding:"2px 6px",borderRadius:"4px",background:"var(--bg-secondary)",border:"1px solid var(--border-color)"},children:a.batch||"No Batch"})})]}),X.includes(a.id)&&e.jsx(oe,{size:18,color:"var(--primary)"})]},a.id))})}),e.jsxs("div",{className:"modal-footer",style:{padding:"1.2rem 1.5rem",borderTop:"1px solid var(--border-color)",display:"flex",justifyContent:"space-between",alignItems:"center",background:"var(--bg-secondary)"},children:[e.jsxs("div",{style:{fontSize:"0.95rem",color:"var(--text-main)",fontWeight:500},children:[e.jsx("span",{style:{color:"var(--primary)",fontWeight:800,fontSize:"1.1rem"},children:X.length})," students selected"]}),e.jsxs("div",{style:{display:"flex",gap:"1rem"},children:[e.jsx("button",{className:"btn-reset",onClick:()=>{L(!1),z("")},children:"Cancel"}),e.jsx("button",{className:"btn-create-new",onClick:xe,style:{background:"var(--primary)",padding:"0.7rem 2rem",borderRadius:"10px",boxShadow:"0 4px 15px var(--primary-alpha)"},children:"Confirm Assignment"})]})]})]})})]})}function ti(){const{t}=Ts(),[j,W]=i.useState("overview"),[N,y]=i.useState(null),[b,x]=i.useState(null),[k,f]=i.useState(null),[u,c]=i.useState(null),[d,n]=i.useState(!0),[E,D]=i.useState(!1),[g,S]=i.useState("");i.useEffect(()=>{n(!0),Promise.all([I.get(`${Q}/analytics/time-to-solve`),I.get(`${Q}/analytics/topics`),I.get(`${Q}/proctoring/analytics`).catch(()=>({data:null})),I.get(`${Q}/proctoring/analytics/by-student`).catch(()=>({data:null}))]).then(([o,M,w,L])=>{y(o.data),x(M.data),f(w.data),c(L.data),n(!1)}).catch(o=>{console.error(o),n(!1)})},[]);const A=async o=>{D(!0);try{if(o==="csv"){const M=await I.get(`${Q}/analytics/export/csv`,{responseType:"blob"}),w=window.URL.createObjectURL(new Blob([M.data])),L=document.createElement("a");L.href=w,L.download=`platform_analytics_${new Date().toISOString().split("T")[0]}.csv`,L.click()}else{const M=await I.get(`${Q}/analytics/export/json`),w=new Blob([JSON.stringify(M.data,null,2)],{type:"application/json"}),L=window.URL.createObjectURL(w),$=document.createElement("a");$.href=L,$.download=`platform_analytics_${new Date().toISOString().split("T")[0]}.json`,$.click()}}catch(M){console.error(M)}D(!1)};if(d)return e.jsx("div",{className:"loading-spinner"});const C=[{id:"overview",label:t("topic_analysis"),icon:e.jsx(Fe,{size:16})},{id:"time-to-solve",label:t("time_to_solve"),icon:e.jsx(Ce,{size:16})},{id:"proctoring",label:"ðŸŽ¥ Proctoring",icon:e.jsx(ht,{size:16})},{id:"student-stats",label:"ðŸ‘¥ Student Stats",icon:e.jsx(re,{size:16})},{id:"export",label:t("export_report"),icon:e.jsx(Ue,{size:16})}];return e.jsxs("div",{className:"animate-fadeIn",children:[e.jsx("div",{style:{display:"flex",gap:"0.5rem",marginBottom:"1.5rem",flexWrap:"wrap"},children:C.map(o=>e.jsxs("button",{onClick:()=>W(o.id),style:{display:"flex",alignItems:"center",gap:"0.5rem",padding:"0.6rem 1.2rem",borderRadius:"10px",border:"none",cursor:"pointer",fontWeight:600,fontSize:"0.85rem",background:j===o.id?"var(--primary)":"var(--card-bg)",color:j===o.id?"#fff":"var(--text-secondary)",boxShadow:j===o.id?"0 4px 15px rgba(59,130,246,0.3)":"0 1px 3px rgba(0,0,0,0.1)",transition:"all 0.2s"},children:[o.icon," ",o.label]},o.id))}),j==="overview"&&b&&e.jsxs("div",{children:[e.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(280px, 1fr))",gap:"1.5rem",marginBottom:"1.5rem"},children:b.byType.map((o,M)=>e.jsxs("div",{style:{padding:"1.5rem",borderRadius:"16px",background:"var(--card-bg)",boxShadow:"0 2px 12px rgba(0,0,0,0.06)",border:"1px solid var(--border-color)"},children:[e.jsx("div",{style:{fontWeight:700,fontSize:"1.1rem",marginBottom:"1rem",textTransform:"capitalize"},children:o.type}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr 1fr",gap:"0.75rem",textAlign:"center"},children:[e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:"1.5rem",fontWeight:800},children:o.submissions}),e.jsx("div",{style:{fontSize:"0.7rem",color:"var(--text-muted)"},children:t("submissions")})]}),e.jsxs("div",{children:[e.jsxs("div",{style:{fontSize:"1.5rem",fontWeight:800,color:o.avgScore>=70?"#10b981":"#f59e0b"},children:[o.avgScore,"%"]}),e.jsx("div",{style:{fontSize:"0.7rem",color:"var(--text-muted)"},children:t("avg_score")})]}),e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:"1.5rem",fontWeight:800,color:"#3b82f6"},children:o.uniqueStudents}),e.jsx("div",{style:{fontSize:"0.7rem",color:"var(--text-muted)"},children:t("students")})]})]}),e.jsx("div",{style:{marginTop:"1rem",height:"8px",borderRadius:"4px",background:"rgba(0,0,0,0.08)",overflow:"hidden"},children:e.jsx("div",{style:{height:"100%",width:`${o.passRate}%`,borderRadius:"4px",background:"linear-gradient(90deg, #10b981, #34d399)",transition:"width 0.5s"}})}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginTop:"4px",fontSize:"0.7rem",color:"var(--text-muted)"},children:[e.jsxs("span",{children:[o.passRate,"% ",t("pass_rate")]}),e.jsxs("span",{children:[o.failRate,"% ",t("fail_rate")]})]})]},M))}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"1.5rem",marginBottom:"1.5rem"},children:[e.jsxs("div",{className:"dashboard-panel",children:[e.jsxs("h3",{className:"panel-title",children:[e.jsx(Ne,{size:18,color:"#f59e0b"})," ",t("by_difficulty")]}),b.byDifficulty.map((o,M)=>{const w={easy:"#10b981",medium:"#f59e0b",hard:"#ef4444"};return e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"1rem",padding:"0.75rem",borderRadius:"10px",background:"var(--bg-secondary)",marginBottom:"0.5rem"},children:[e.jsx("span",{style:{fontWeight:700,width:"70px",textTransform:"capitalize",color:w[o.difficulty]||"#3b82f6"},children:o.difficulty}),e.jsx("div",{style:{flex:1},children:e.jsx("div",{style:{height:"8px",borderRadius:"4px",background:"rgba(0,0,0,0.08)",overflow:"hidden"},children:e.jsx("div",{style:{height:"100%",width:`${o.passRate}%`,borderRadius:"4px",background:w[o.difficulty]||"#3b82f6"}})})}),e.jsxs("span",{style:{fontWeight:700,fontSize:"0.85rem",width:"45px",textAlign:"right"},children:[o.avgScore,"%"]}),e.jsx("span",{style:{fontSize:"0.7rem",color:"var(--text-muted)",width:"40px"},children:o.submissions})]},M)})]}),e.jsxs("div",{className:"dashboard-panel",children:[e.jsxs("h3",{className:"panel-title",children:[e.jsx(Re,{size:18,color:"#8b5cf6"})," ",t("by_language")]}),b.byLanguage.map((o,M)=>e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"1rem",padding:"0.75rem",borderRadius:"10px",background:"var(--bg-secondary)",marginBottom:"0.5rem"},children:[e.jsx("span",{style:{fontWeight:700,width:"90px"},children:o.language}),e.jsx("div",{style:{flex:1},children:e.jsx("div",{style:{height:"8px",borderRadius:"4px",background:"rgba(0,0,0,0.08)",overflow:"hidden"},children:e.jsx("div",{style:{height:"100%",width:`${o.passRate}%`,borderRadius:"4px",background:dt[M%dt.length]}})})}),e.jsxs("span",{style:{fontWeight:700,fontSize:"0.85rem",width:"45px",textAlign:"right"},children:[o.avgScore,"%"]}),e.jsx("span",{style:{fontSize:"0.7rem",color:"var(--text-muted)",width:"40px"},children:o.submissions})]},M))]})]}),b.topProblems.length>0&&e.jsxs("div",{className:"dashboard-panel",children:[e.jsxs("h3",{className:"panel-title",children:[e.jsx(Ze,{size:18,color:"#ef4444"})," ",t("most_attempted_problems")]}),e.jsx("div",{style:{overflowX:"auto"},children:e.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:"0.8rem"},children:[e.jsx("thead",{children:e.jsxs("tr",{style:{borderBottom:"2px solid var(--border-color)"},children:[e.jsx("th",{style:{textAlign:"left",padding:"0.6rem"},children:"#"}),e.jsx("th",{style:{textAlign:"left",padding:"0.6rem"},children:t("problem")}),e.jsx("th",{style:{textAlign:"center",padding:"0.6rem"},children:t("type")}),e.jsx("th",{style:{textAlign:"center",padding:"0.6rem"},children:t("difficulty")}),e.jsx("th",{style:{textAlign:"center",padding:"0.6rem"},children:t("attempts")}),e.jsx("th",{style:{textAlign:"center",padding:"0.6rem"},children:t("avg_score")}),e.jsx("th",{style:{textAlign:"center",padding:"0.6rem"},children:t("pass_rate")})]})}),e.jsx("tbody",{children:b.topProblems.map((o,M)=>e.jsxs("tr",{style:{borderBottom:"1px solid var(--border-color)"},children:[e.jsx("td",{style:{padding:"0.6rem",fontWeight:700,color:"#3b82f6"},children:M+1}),e.jsx("td",{style:{padding:"0.6rem",fontWeight:600},children:o.title}),e.jsx("td",{style:{padding:"0.6rem",textAlign:"center",textTransform:"capitalize"},children:o.type}),e.jsx("td",{style:{padding:"0.6rem",textAlign:"center"},children:e.jsx("span",{style:{padding:"0.15rem 0.5rem",borderRadius:"6px",fontSize:"0.7rem",fontWeight:600,background:o.difficulty==="easy"?"rgba(16,185,129,0.12)":o.difficulty==="medium"?"rgba(251,191,36,0.12)":"rgba(239,68,68,0.12)",color:o.difficulty==="easy"?"#10b981":o.difficulty==="medium"?"#f59e0b":"#ef4444"},children:o.difficulty})}),e.jsx("td",{style:{padding:"0.6rem",textAlign:"center",fontWeight:600},children:o.attempts}),e.jsxs("td",{style:{padding:"0.6rem",textAlign:"center",fontWeight:700,color:o.avgScore>=70?"#10b981":"#f59e0b"},children:[o.avgScore,"%"]}),e.jsxs("td",{style:{padding:"0.6rem",textAlign:"center"},children:[o.passRate,"%"]})]},M))})]})})]})]}),j==="time-to-solve"&&N&&e.jsxs("div",{children:[e.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(250px, 1fr))",gap:"1.5rem",marginBottom:"1.5rem"},children:N.difficultySummary.map((o,M)=>{const L={easy:{bg:"rgba(16,185,129,0.08)",border:"#10b981"},medium:{bg:"rgba(251,191,36,0.08)",border:"#f59e0b"},hard:{bg:"rgba(239,68,68,0.08)",border:"#ef4444"}}[o.difficulty]||{bg:"rgba(59,130,246,0.08)",border:"#3b82f6"};return e.jsxs("div",{style:{padding:"1.5rem",borderRadius:"16px",background:L.bg,border:`2px solid ${L.border}`},children:[e.jsx("div",{style:{fontWeight:800,fontSize:"1.2rem",textTransform:"capitalize",color:L.border,marginBottom:"1rem"},children:o.difficulty}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"1rem"},children:[e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:"0.65rem",color:"var(--text-muted)",textTransform:"uppercase"},children:t("problems")}),e.jsx("div",{style:{fontSize:"1.5rem",fontWeight:800},children:o.problems})]}),e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:"0.65rem",color:"var(--text-muted)",textTransform:"uppercase"},children:t("avg_time")}),e.jsxs("div",{style:{fontSize:"1.5rem",fontWeight:800},children:[o.avgTimeMinutes,"m"]})]}),e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:"0.65rem",color:"var(--text-muted)",textTransform:"uppercase"},children:t("avg_attempts")}),e.jsx("div",{style:{fontSize:"1.5rem",fontWeight:800},children:o.avgAttempts})]}),e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:"0.65rem",color:"var(--text-muted)",textTransform:"uppercase"},children:t("solve_rate")}),e.jsxs("div",{style:{fontSize:"1.5rem",fontWeight:800,color:L.border},children:[o.avgSolveRate,"%"]})]})]})]},M)})}),e.jsxs("div",{className:"dashboard-panel",children:[e.jsxs("h3",{className:"panel-title",children:[e.jsx(Ce,{size:18,color:"#3b82f6"})," ",t("all_problems_metrics")]}),e.jsx("div",{style:{overflowX:"auto"},children:e.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:"0.8rem"},children:[e.jsx("thead",{children:e.jsxs("tr",{style:{borderBottom:"2px solid var(--border-color)"},children:[e.jsx("th",{style:{textAlign:"left",padding:"0.6rem"},children:t("problem")}),e.jsx("th",{style:{textAlign:"center",padding:"0.6rem"},children:t("type")}),e.jsx("th",{style:{textAlign:"center",padding:"0.6rem"},children:t("difficulty")}),e.jsx("th",{style:{textAlign:"center",padding:"0.6rem"},children:t("students")}),e.jsx("th",{style:{textAlign:"center",padding:"0.6rem"},children:t("total_attempts")}),e.jsx("th",{style:{textAlign:"center",padding:"0.6rem"},children:t("avg_attempts")}),e.jsx("th",{style:{textAlign:"center",padding:"0.6rem"},children:t("avg_time")}),e.jsx("th",{style:{textAlign:"center",padding:"0.6rem"},children:t("solve_rate")})]})}),e.jsx("tbody",{children:N.problems.map((o,M)=>e.jsxs("tr",{style:{borderBottom:"1px solid var(--border-color)"},children:[e.jsx("td",{style:{padding:"0.6rem",fontWeight:600},children:o.title}),e.jsx("td",{style:{padding:"0.6rem",textAlign:"center",textTransform:"capitalize"},children:o.type}),e.jsx("td",{style:{padding:"0.6rem",textAlign:"center"},children:e.jsx("span",{style:{padding:"0.15rem 0.5rem",borderRadius:"6px",fontSize:"0.7rem",fontWeight:600,background:o.difficulty==="easy"?"rgba(16,185,129,0.12)":o.difficulty==="medium"?"rgba(251,191,36,0.12)":"rgba(239,68,68,0.12)",color:o.difficulty==="easy"?"#10b981":o.difficulty==="medium"?"#f59e0b":"#ef4444"},children:o.difficulty})}),e.jsx("td",{style:{padding:"0.6rem",textAlign:"center"},children:o.studentCount}),e.jsx("td",{style:{padding:"0.6rem",textAlign:"center"},children:o.totalAttempts}),e.jsx("td",{style:{padding:"0.6rem",textAlign:"center",fontWeight:600},children:o.avgAttempts}),e.jsx("td",{style:{padding:"0.6rem",textAlign:"center"},children:o.avgTimeMinutes?`${o.avgTimeMinutes}m`:"-"}),e.jsxs("td",{style:{padding:"0.6rem",textAlign:"center",fontWeight:700,color:o.solveRate>=70?"#10b981":o.solveRate>=40?"#f59e0b":"#ef4444"},children:[o.solveRate,"%"]})]},M))})]})})]})]}),j==="proctoring"&&k&&k.analytics?e.jsxs("div",{children:[e.jsxs("div",{style:{padding:"1rem",borderRadius:"12px",background:"rgba(59,130,246,0.08)",border:"1px solid rgba(59,130,246,0.3)",marginBottom:"1.5rem"},children:[e.jsx("strong",{style:{color:"#3b82f6"},children:"ðŸ“Š PROCTORING TAB EXPLANATION:"}),e.jsxs("ul",{style:{margin:"0.5rem 0 0 0",paddingLeft:"1.5rem",fontSize:"0.85rem",color:"var(--text-secondary)",lineHeight:"1.6"},children:[e.jsxs("li",{children:[e.jsx("strong",{children:"Total Sessions"})," = How many exams were taken with proctoring enabled (last 30 days)"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Completed"})," = How many exams finished without critical issues"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Flagged"})," = How many exams had violations (tab switches, camera blocked, phone detected, copy attempts)"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Avg Score"})," = Average violation intensity (0 = clean, 100 = severe violations)"]})]})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(220px, 1fr))",gap:"1rem",marginBottom:"1.5rem"},children:[e.jsxs("div",{style:{padding:"1.25rem",borderRadius:"14px",background:"var(--card-bg)",boxShadow:"0 2px 8px rgba(0,0,0,0.06)",borderLeft:"4px solid #3b82f6"},children:[e.jsx("div",{style:{fontSize:"0.7rem",color:"var(--text-muted)",textTransform:"uppercase",fontWeight:600},children:"ðŸ“¹ Total Sessions"}),e.jsx("div",{style:{fontSize:"2rem",fontWeight:800,color:"#3b82f6"},children:k.analytics.totalSessions||0}),e.jsx("div",{style:{fontSize:"0.7rem",color:"var(--text-muted)",marginTop:"0.5rem"},children:"Total exams with proctoring"})]}),e.jsxs("div",{style:{padding:"1.25rem",borderRadius:"14px",background:"var(--card-bg)",boxShadow:"0 2px 8px rgba(0,0,0,0.06)",borderLeft:"4px solid #10b981"},children:[e.jsx("div",{style:{fontSize:"0.7rem",color:"var(--text-muted)",textTransform:"uppercase",fontWeight:600},children:"ðŸŸ¢ Completed"}),e.jsx("div",{style:{fontSize:"2rem",fontWeight:800,color:"#10b981"},children:k.analytics.completedSessions||0}),e.jsx("div",{style:{fontSize:"0.7rem",color:"var(--text-muted)",marginTop:"0.5rem"},children:"Exams completed cleanly"})]}),e.jsxs("div",{style:{padding:"1.25rem",borderRadius:"14px",background:"var(--card-bg)",boxShadow:"0 2px 8px rgba(0,0,0,0.06)",borderLeft:"4px solid #f59e0b"},children:[e.jsx("div",{style:{fontSize:"0.7rem",color:"var(--text-muted)",textTransform:"uppercase",fontWeight:600},children:"âš ï¸ Flagged"}),e.jsx("div",{style:{fontSize:"2rem",fontWeight:800,color:"#f59e0b"},children:k.analytics.flaggedSessions||0}),e.jsx("div",{style:{fontSize:"0.7rem",color:"var(--text-muted)",marginTop:"0.5rem"},children:"Exams with violations"})]}),e.jsxs("div",{style:{padding:"1.25rem",borderRadius:"14px",background:"var(--card-bg)",boxShadow:"0 2px 8px rgba(0,0,0,0.06)",borderLeft:"4px solid #ef4444"},children:[e.jsx("div",{style:{fontSize:"0.7rem",color:"var(--text-muted)",textTransform:"uppercase",fontWeight:600},children:"ðŸš¨ Avg Score"}),e.jsxs("div",{style:{fontSize:"2rem",fontWeight:800,color:"#ef4444"},children:[Math.round(k.analytics.averageViolationScore||0),"/100"]}),e.jsx("div",{style:{fontSize:"0.7rem",color:"var(--text-muted)",marginTop:"0.5rem"},children:"0=clean, 100=severe"})]})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"1.5rem",marginBottom:"1.5rem"},children:[e.jsxs("div",{className:"dashboard-panel",children:[e.jsxs("h3",{className:"panel-title",children:[e.jsx(pe,{size:18})," Violations by Type"]}),e.jsxs("div",{style:{fontSize:"0.75rem",color:"var(--text-muted)",marginBottom:"1rem",padding:"0.75rem",borderRadius:"8px",background:"rgba(255,159,64,0.08)"},children:[e.jsx("strong",{children:"What each violation means:"}),e.jsxs("ul",{style:{margin:"0.5rem 0 0 0",paddingLeft:"1.2rem",lineHeight:"1.5"},children:[e.jsxs("li",{children:[e.jsx("strong",{children:"TABSWITCHES"})," - Student left exam tab (tried to look at other tabs) = ðŸš¨ Cheating Sign"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"CAMERABLOCKED"})," - Student's camera was covered/blocked = ðŸš¨ Cannot verify identity"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"PHONEDETECTION"})," - Phone detected near desk = ðŸš¨ Could use for cheating"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"COPYPASTE"})," - Tried to copy code = ðŸš¨ Using external code"]})]})]}),k.analytics.violationsByType&&Object.entries(k.analytics.violationsByType).length>0?Object.entries(k.analytics.violationsByType).sort((o,M)=>M[1]-o[1]).map(([o,M],w)=>{const L=["#ef4444","#f59e0b","#3b82f6","#8b5cf6","#06b6d4","#10b981"],$=L[w%L.length];return e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"1rem",padding:"0.75rem",borderRadius:"10px",background:"var(--bg-secondary)",marginBottom:"0.5rem"},children:[e.jsx("div",{style:{flex:1},children:e.jsx("div",{style:{fontWeight:700,fontSize:"0.9rem",textTransform:"uppercase"},children:o})}),e.jsx("div",{style:{height:"8px",borderRadius:"4px",background:"rgba(0,0,0,0.08)",overflow:"hidden",flex:1},children:e.jsx("div",{style:{height:"100%",width:`${Math.min(M/Math.max(...Object.values(k.analytics.violationsByType))*100,100)}%`,borderRadius:"4px",background:$}})}),e.jsx("span",{style:{fontWeight:700,fontSize:"0.85rem",width:"40px",textAlign:"right",color:$},children:M})]},o)}):e.jsx("div",{style:{textAlign:"center",color:"var(--text-muted)",padding:"1rem"},children:"No violations data"})]}),e.jsxs("div",{className:"dashboard-panel",children:[e.jsxs("h3",{className:"panel-title",children:[e.jsx(Ze,{size:18})," Severity Distribution"]}),e.jsxs("div",{style:{fontSize:"0.75rem",color:"var(--text-muted)",marginBottom:"1rem",padding:"0.75rem",borderRadius:"8px",background:"rgba(34,197,94,0.08)"},children:[e.jsx("strong",{children:"Status meanings:"}),e.jsxs("ul",{style:{margin:"0.5rem 0 0 0",paddingLeft:"1.2rem",lineHeight:"1.5"},children:[e.jsxs("li",{children:[e.jsx("strong",{children:"âœ… APPROVED"})," - Student exam is clean, no violations"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"âš ï¸ REQUIRES_REVIEW"})," - Some violations, admin review needed"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"âŒ REJECTED_FLAGGED"})," - Serious violations, exam flagged for rejection"]})]})]}),k.analytics.severityDistribution?["APPROVED","REQUIRES_REVIEW","REJECTED_FLAGGED"].map((o,M)=>{const w=k.analytics.severityDistribution[o]||0,$=["#10b981","#f59e0b","#ef4444"][M],te=["âœ…","âš ï¸","âŒ"];return e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"1rem",padding:"0.75rem",borderRadius:"10px",background:"var(--bg-secondary)",marginBottom:"0.5rem"},children:[e.jsx("span",{style:{fontSize:"1.5rem"},children:te[M]}),e.jsx("div",{style:{flex:1},children:e.jsx("div",{style:{fontWeight:700,fontSize:"0.9rem"},children:o.replace(/_/g," ")})}),e.jsx("div",{style:{height:"8px",borderRadius:"4px",background:"rgba(0,0,0,0.08)",overflow:"hidden",flex:1},children:e.jsx("div",{style:{height:"100%",width:`${w/(k.analytics.totalSessions||1)*100}%`,borderRadius:"4px",background:$}})}),e.jsx("span",{style:{fontWeight:700,fontSize:"0.85rem",width:"40px",textAlign:"right",color:$},children:w})]},o)}):e.jsx("div",{style:{textAlign:"center",color:"var(--text-muted)",padding:"1rem"},children:"No severity data"})]})]}),e.jsxs("div",{className:"dashboard-panel",children:[e.jsxs("h3",{className:"panel-title",children:[e.jsx(ht,{size:18})," Proctoring Summary"]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(200px, 1fr))",gap:"1rem"},children:[e.jsxs("div",{style:{padding:"1rem",borderRadius:"10px",background:"var(--bg-secondary)"},children:[e.jsx("div",{style:{fontSize:"0.7rem",color:"var(--text-muted)",textTransform:"uppercase",fontWeight:600},children:"Total Violations"}),e.jsx("div",{style:{fontSize:"1.8rem",fontWeight:800,color:"#ef4444"},children:k.analytics.totalViolations||0})]}),e.jsxs("div",{style:{padding:"1rem",borderRadius:"10px",background:"var(--bg-secondary)"},children:[e.jsx("div",{style:{fontSize:"0.7rem",color:"var(--text-muted)",textTransform:"uppercase",fontWeight:600},children:"Active Sessions"}),e.jsx("div",{style:{fontSize:"1.8rem",fontWeight:800,color:"#3b82f6"},children:k.analytics.activeSessions||0})]}),e.jsxs("div",{style:{padding:"1rem",borderRadius:"10px",background:"var(--bg-secondary)"},children:[e.jsx("div",{style:{fontSize:"0.7rem",color:"var(--text-muted)",textTransform:"uppercase",fontWeight:600},children:"Avg Score"}),e.jsx("div",{style:{fontSize:"1.8rem",fontWeight:800,color:"#f59e0b"},children:Math.round(k.analytics.averageViolationScore||0)})]}),e.jsxs("div",{style:{padding:"1rem",borderRadius:"10px",background:"var(--bg-secondary)"},children:[e.jsx("div",{style:{fontSize:"0.7rem",color:"var(--text-muted)",textTransform:"uppercase",fontWeight:600},children:"Flagged Rate"}),e.jsxs("div",{style:{fontSize:"1.8rem",fontWeight:800,color:"#8b5cf6"},children:[k.analytics.totalSessions?Math.round(k.analytics.flaggedSessions/k.analytics.totalSessions*100):0,"%"]})]})]})]}),e.jsxs("div",{style:{padding:"1rem",borderRadius:"12px",background:"rgba(59,130,246,0.1)",border:"1px solid rgba(59,130,246,0.3)",color:"var(--text-secondary)",fontSize:"0.85rem",marginTop:"1rem"},children:[e.jsx("strong",{style:{color:"#3b82f6"},children:"ðŸ’¡ HOW TO USE THIS TAB:"}),e.jsxs("ul",{style:{margin:"0.5rem 0 0 0",paddingLeft:"1.5rem",lineHeight:"1.6"},children:[e.jsxs("li",{children:[e.jsx("strong",{children:"Total Sessions:"})," Check if students are taking proctored exams"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Flagged Rate:"})," See what % of exams have violations (higher = more cheating)"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Top Violation Type:"})," If CAMERABLOCKED is high, fix camera setup. If TABSWITCHES is high, remind students to stay in exam."]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Severity Distribution:"})," See how many exams need review vs. rejection"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Action:"}),' Use "Student Stats" tab to review individual student violations and approve/reject their exams.']})]})]})]}):j==="proctoring"&&!k?e.jsxs("div",{style:{padding:"2rem",textAlign:"center",color:"var(--text-muted)"},children:[e.jsx(ht,{size:40,style:{margin:"0 auto 1rem",opacity:.5}}),e.jsx("p",{children:"Proctoring data loading..."})]}):j==="proctoring"?e.jsxs("div",{style:{padding:"2rem",textAlign:"center",color:"var(--text-muted)"},children:[e.jsx(ht,{size:40,style:{margin:"0 auto 1rem",opacity:.5}}),e.jsx("p",{children:"No proctoring data available yet. Run exams with proctoring enabled to see analytics."})]}):null,j==="student-stats"&&u&&u.students?e.jsxs("div",{children:[e.jsxs("div",{style:{padding:"1rem",borderRadius:"12px",background:"rgba(59,130,246,0.08)",border:"1px solid rgba(59,130,246,0.3)",marginBottom:"1.5rem"},children:[e.jsx("strong",{style:{color:"#3b82f6"},children:"ðŸ‘¥ STUDENT STATS TAB EXPLANATION:"}),e.jsxs("ul",{style:{margin:"0.5rem 0 0 0",paddingLeft:"1.5rem",fontSize:"0.85rem",color:"var(--text-secondary)",lineHeight:"1.6"},children:[e.jsxs("li",{children:[e.jsx("strong",{children:"Total Students"})," = How many students took proctored exams"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Clean Students"})," = Students with ZERO violations (no cheating signs)"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Flagged Students"})," = Students with violations detected (needs review)"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Repeat Violators"})," = Students with 2+ flagged exams (serious cases)"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Status Badges:"})," âœ… CLEAN = no violations | âš¡ CAUTION = 1 violation | âš ï¸ FLAGGED = multiple violations | ðŸš¨ REPEAT = 2+ violations"]})]})]}),e.jsx("div",{style:{marginBottom:"1.5rem"},children:e.jsx("input",{type:"text",placeholder:"ðŸ” Search student name or ID...",value:g,onChange:o=>S(o.target.value),style:{width:"100%",maxWidth:"400px",padding:"0.75rem 1rem",borderRadius:"10px",border:"2px solid var(--border-color)",background:"var(--card-bg)",color:"var(--text-primary)",fontSize:"0.9rem"}})}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(220px, 1fr))",gap:"1rem",marginBottom:"1.5rem"},children:[e.jsxs("div",{style:{padding:"1.25rem",borderRadius:"14px",background:"var(--card-bg)",boxShadow:"0 2px 8px rgba(0,0,0,0.06)",borderLeft:"4px solid #3b82f6"},children:[e.jsx("div",{style:{fontSize:"0.7rem",color:"var(--text-muted)",textTransform:"uppercase",fontWeight:600},children:"ðŸ‘¥ Total Students"}),e.jsx("div",{style:{fontSize:"2rem",fontWeight:800,color:"#3b82f6"},children:u.totalStudents||0}),e.jsx("div",{style:{fontSize:"0.7rem",color:"var(--text-muted)",marginTop:"0.5rem"},children:"Took proctored exams"})]}),e.jsxs("div",{style:{padding:"1.25rem",borderRadius:"14px",background:"var(--card-bg)",boxShadow:"0 2px 8px rgba(0,0,0,0.06)",borderLeft:"4px solid #10b981"},children:[e.jsx("div",{style:{fontSize:"0.7rem",color:"var(--text-muted)",textTransform:"uppercase",fontWeight:600},children:"âœ… Clean Students"}),e.jsx("div",{style:{fontSize:"2rem",fontWeight:800,color:"#10b981"},children:u.students.filter(o=>o.flagged_exams===0).length}),e.jsx("div",{style:{fontSize:"0.7rem",color:"var(--text-muted)",marginTop:"0.5rem"},children:"Zero violations"})]}),e.jsxs("div",{style:{padding:"1.25rem",borderRadius:"14px",background:"var(--card-bg)",boxShadow:"0 2px 8px rgba(0,0,0,0.06)",borderLeft:"4px solid #f59e0b"},children:[e.jsx("div",{style:{fontSize:"0.7rem",color:"var(--text-muted)",textTransform:"uppercase",fontWeight:600},children:"âš ï¸ Flagged Students"}),e.jsx("div",{style:{fontSize:"2rem",fontWeight:800,color:"#f59e0b"},children:u.students.filter(o=>o.flagged_exams>0).length}),e.jsx("div",{style:{fontSize:"0.7rem",color:"var(--text-muted)",marginTop:"0.5rem"},children:"Has violations"})]}),e.jsxs("div",{style:{padding:"1.25rem",borderRadius:"14px",background:"var(--card-bg)",boxShadow:"0 2px 8px rgba(0,0,0,0.06)",borderLeft:"4px solid #ef4444"},children:[e.jsx("div",{style:{fontSize:"0.7rem",color:"var(--text-muted)",textTransform:"uppercase",fontWeight:600},children:"ðŸš¨ Repeat Violators"}),e.jsx("div",{style:{fontSize:"2rem",fontWeight:800,color:"#ef4444"},children:u.students.filter(o=>o.flagged_exams>=2).length}),e.jsx("div",{style:{fontSize:"0.7rem",color:"var(--text-muted)",marginTop:"0.5rem"},children:"2+ flagged exams"})]})]}),u.topViolators&&u.topViolators.length>0&&e.jsxs("div",{className:"dashboard-panel",style:{marginBottom:"1.5rem"},children:[e.jsxs("h3",{className:"panel-title",children:[e.jsx(pe,{size:18})," ðŸš¨ Top 10 Violators"]}),e.jsxs("div",{style:{fontSize:"0.75rem",color:"var(--text-muted)",marginBottom:"1rem",padding:"0.75rem",borderRadius:"8px",background:"rgba(239,68,68,0.08)"},children:[e.jsx("strong",{children:'How to read violation numbers (e.g., "2011"):'}),' First digit = tab switches | Second digit = copy/paste attempts | Third digit = camera blocked | Fourth digit = phone detected. Example: "2011" = 2 tabs + 0 copy + 1 camera + 1 phone']}),u.topViolators.map((o,M)=>e.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",padding:"0.75rem",borderRadius:"8px",background:"var(--bg-secondary)",marginBottom:"0.5rem"},children:[e.jsxs("div",{style:{flex:1},children:[e.jsxs("div",{style:{fontWeight:600,fontSize:"0.95rem"},children:[M+1,". ",o.student_name]}),e.jsxs("div",{style:{fontSize:"0.7rem",color:"var(--text-muted)"},children:[o.total_exams," exams | Avg Score: ",o.avg_score,"/100"]})]}),e.jsxs("div",{style:{display:"flex",gap:"1rem",alignItems:"center"},children:[e.jsxs("span",{style:{fontWeight:700,color:"#ef4444"},children:[o.flagged_exams," flagged"]}),e.jsx("span",{style:{padding:"0.3rem 0.8rem",borderRadius:"20px",fontSize:"0.7rem",fontWeight:700,background:o.status.includes("CLEAN")?"rgba(16,185,129,0.2)":o.status.includes("REPEAT")?"rgba(245,158,11,0.2)":"rgba(239,68,68,0.2)",color:o.status.includes("CLEAN")?"#10b981":o.status.includes("REPEAT")?"#f59e0b":"#ef4444"},children:o.status})]})]},M))]}),e.jsxs("div",{className:"dashboard-panel",children:[e.jsxs("h3",{className:"panel-title",children:[e.jsx(re,{size:18})," All Students (",g?u.students.filter(o=>o.student_name.toLowerCase().includes(g.toLowerCase())||o.student_id.toLowerCase().includes(g.toLowerCase())).length:u.students.length,")"]}),e.jsx("div",{style:{overflowX:"auto"},children:e.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:"0.8rem"},children:[e.jsx("thead",{children:e.jsxs("tr",{style:{borderBottom:"2px solid var(--border-color)"},children:[e.jsx("th",{style:{textAlign:"left",padding:"0.6rem"},children:"Student Name"}),e.jsx("th",{style:{textAlign:"center",padding:"0.6rem"},children:"Exams"}),e.jsx("th",{style:{textAlign:"center",padding:"0.6rem"},children:"Flagged"}),e.jsx("th",{style:{textAlign:"center",padding:"0.6rem"},children:"Pass Rate"}),e.jsx("th",{style:{textAlign:"center",padding:"0.6rem"},children:"Avg Score"}),e.jsx("th",{style:{textAlign:"center",padding:"0.6rem"},children:"Violations"}),e.jsx("th",{style:{textAlign:"center",padding:"0.6rem"},children:"Status"})]})}),e.jsx("tbody",{children:u.students.filter(o=>!g||o.student_name.toLowerCase().includes(g.toLowerCase())||o.student_id.toLowerCase().includes(g.toLowerCase())).map((o,M)=>e.jsxs("tr",{style:{borderBottom:"1px solid var(--border-color)"},children:[e.jsxs("td",{style:{padding:"0.6rem",fontWeight:600},children:[e.jsx("div",{children:o.student_name}),e.jsx("div",{style:{fontSize:"0.7rem",color:"var(--text-muted)"},children:o.student_id})]}),e.jsx("td",{style:{padding:"0.6rem",textAlign:"center",fontWeight:600},children:o.total_exams}),e.jsx("td",{style:{padding:"0.6rem",textAlign:"center",fontWeight:600,color:o.flagged_exams>0?"#ef4444":"#10b981"},children:o.flagged_exams}),e.jsx("td",{style:{padding:"0.6rem",textAlign:"center"},children:e.jsxs("span",{style:{padding:"0.15rem 0.5rem",borderRadius:"6px",fontSize:"0.7rem",fontWeight:600,background:o.pass_rate>=80?"rgba(16,185,129,0.12)":o.pass_rate>=50?"rgba(251,191,36,0.12)":"rgba(239,68,68,0.12)",color:o.pass_rate>=80?"#10b981":o.pass_rate>=50?"#f59e0b":"#ef4444"},children:[o.pass_rate,"%"]})}),e.jsx("td",{style:{padding:"0.6rem",textAlign:"center",fontWeight:700,color:o.avg_score>=60?"#ef4444":o.avg_score>=30?"#f59e0b":"#10b981"},children:o.avg_score}),e.jsx("td",{style:{padding:"0.6rem",textAlign:"center",fontWeight:600},children:o.total_violations}),e.jsx("td",{style:{padding:"0.6rem",textAlign:"center"},children:e.jsx("span",{style:{padding:"0.3rem 0.8rem",borderRadius:"6px",fontSize:"0.7rem",fontWeight:700,background:o.status.includes("CLEAN")?"rgba(16,185,129,0.15)":o.status.includes("REPEAT")?"rgba(245,158,11,0.15)":o.status.includes("DEFINITE")?"rgba(239,68,68,0.15)":"rgba(59,130,246,0.15)",color:o.status.includes("CLEAN")?"#10b981":o.status.includes("REPEAT")?"#f59e0b":o.status.includes("DEFINITE")?"#ef4444":"#3b82f6"},children:o.status})})]},M))})]})})]}),e.jsxs("div",{style:{padding:"1rem",borderRadius:"12px",background:"rgba(59,130,246,0.1)",border:"1px solid rgba(59,130,246,0.3)",color:"var(--text-secondary)",fontSize:"0.85rem",marginTop:"1rem"},children:[e.jsx("strong",{style:{color:"#3b82f6"},children:"ðŸ’¡ Understanding Student Data:"}),e.jsxs("ul",{style:{margin:"0.5rem 0 0 0",paddingLeft:"1.5rem",lineHeight:"1.6"},children:[e.jsxs("li",{children:[e.jsx("strong",{children:"Violations Code:"})," 4-digit number (e.g., 2011) = Tabs | Copy | Camera | Phone counts"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Status Meanings:"})," âœ… CLEAN (0 violations) | âš¡ CAUTION (1 violation) | âš ï¸ FLAGGED (multiple violations) | ðŸš¨ REPEAT VIOLATOR (2+ flagged exams)"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Avg Score:"})," 0-30 = low violations | 30-60 = medium | 60+ = serious violations"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Action:"})," Review âš ï¸ and ðŸš¨ students. Approve clean exams, reject serious violations."]})]})]})]}):j==="student-stats"&&!u?e.jsxs("div",{style:{padding:"2rem",textAlign:"center",color:"var(--text-muted)"},children:[e.jsx(re,{size:40,style:{margin:"0 auto 1rem",opacity:.5}}),e.jsx("p",{children:"Student statistics loading..."})]}):j==="student-stats"?e.jsxs("div",{style:{padding:"2rem",textAlign:"center",color:"var(--text-muted)"},children:[e.jsx(re,{size:40,style:{margin:"0 auto 1rem",opacity:.5}}),e.jsx("p",{children:"No student proctoring data available yet. Students need to complete exams with proctoring enabled."})]}):null,j==="export"&&e.jsx("div",{children:e.jsxs("div",{className:"dashboard-panel",style:{textAlign:"center",padding:"3rem 2rem"},children:[e.jsx(Ue,{size:56,color:"var(--primary)",style:{marginBottom:"1rem"}}),e.jsx("h3",{style:{margin:"0 0 0.5rem",fontSize:"1.5rem"},children:t("export_platform_analytics")}),e.jsx("p",{style:{color:"var(--text-muted)",marginBottom:"2rem",maxWidth:"600px",margin:"0 auto 2rem"},children:t("export_platform_description")}),e.jsxs("div",{style:{display:"flex",gap:"1.5rem",justifyContent:"center",flexWrap:"wrap"},children:[e.jsxs("button",{onClick:()=>A("csv"),disabled:E,style:{padding:"1rem 2.5rem",borderRadius:"14px",border:"none",cursor:"pointer",background:"linear-gradient(135deg, #059669, #10b981)",color:"#fff",fontWeight:700,fontSize:"1rem",opacity:E?.6:1,display:"flex",alignItems:"center",gap:"0.5rem",boxShadow:"0 4px 15px rgba(16,185,129,0.3)"},children:[e.jsx($e,{size:20})," ",t("download_csv")]}),e.jsxs("button",{onClick:()=>A("json"),disabled:E,style:{padding:"1rem 2.5rem",borderRadius:"14px",border:"none",cursor:"pointer",background:"linear-gradient(135deg, #1e40af, #3b82f6)",color:"#fff",fontWeight:700,fontSize:"1rem",opacity:E?.6:1,display:"flex",alignItems:"center",gap:"0.5rem",boxShadow:"0 4px 15px rgba(59,130,246,0.3)"},children:[e.jsx(Re,{size:20})," ",t("download_json")]})]})]})})]})}const si="http://localhost:3000";function ri(){const{user:t}=As(),[j,W]=i.useState([]),[N,y]=i.useState(null),[b,x]=i.useState(!0),[k,f]=i.useState(""),u=localStorage.getItem("authToken");if(i.useEffect(()=>{I.get(`${si}/api/submissions?limit=200`,{headers:{Authorization:`Bearer ${u}`}}).then(d=>{const n=Array.isArray(d.data)?d.data:d.data?.data||d.data?.submissions||[];W(n)}).catch(()=>W([])).finally(()=>x(!1))},[]),N)return e.jsxs("div",{style:{height:"100%",display:"flex",flexDirection:"column",gap:16},children:[e.jsx("button",{onClick:()=>y(null),style:{alignSelf:"flex-start",padding:"8px 18px",cursor:"pointer",background:"var(--primary)",color:"#fff",border:"none",borderRadius:8,fontWeight:600,display:"flex",alignItems:"center",gap:6},children:"â† Back to submissions"}),e.jsx(rr,{submissionId:N.id,submission:N,user:t})]});if(b)return e.jsx("div",{style:{padding:40,textAlign:"center",opacity:.6},children:"Loading submissionsâ€¦"});const c=j.filter(d=>{const n=k.toLowerCase();return!n||(d.problem_title||d.itemTitle||d.title||"").toLowerCase().includes(n)||(d.student_name||d.studentName||d.username||"").toLowerCase().includes(n)});return e.jsxs("div",{style:{padding:"0 4px"},children:[e.jsxs("div",{style:{marginBottom:20},children:[e.jsx("h2",{style:{margin:"0 0 4px",fontSize:22,fontWeight:700},children:"Code Reviews"}),e.jsx("p",{style:{margin:0,opacity:.55,fontSize:13},children:"View and post code review comments across the platform"})]}),e.jsxs("div",{style:{marginBottom:16,position:"relative",maxWidth:420},children:[e.jsx("input",{value:k,onChange:d=>f(d.target.value),placeholder:"Search by problem or student nameâ€¦",style:{width:"100%",padding:"10px 14px 10px 38px",borderRadius:8,border:"1px solid var(--border, #334155)",background:"var(--card-bg, #1e293b)",color:"inherit",fontSize:13,outline:"none",boxSizing:"border-box"}}),e.jsx(Se,{size:15,style:{position:"absolute",left:12,top:"50%",transform:"translateY(-50%)",opacity:.4,pointerEvents:"none"}})]}),e.jsxs("p",{style:{marginBottom:14,opacity:.5,fontSize:12},children:["Showing ",c.length," of ",j.length," submission(s) â€” click one to view/post reviews"]}),c.length?e.jsx("div",{style:{display:"flex",flexDirection:"column",gap:8},children:c.map(d=>{const n=d.problem_title||d.itemTitle||d.title||`Submission #${d.id}`,E=d.student_name||d.studentName||d.username||"Unknown",D=d.score!=null?d.score:"â€”",g=d.language||"Code",S=d.submitted_at||d.submittedAt||d.created_at;return e.jsxs("div",{onClick:()=>y(d),style:{padding:"14px 18px",borderRadius:10,background:"var(--card-bg, #1e293b)",border:"1px solid var(--border, #334155)",cursor:"pointer",display:"flex",justifyContent:"space-between",alignItems:"center",transition:"border-color 0.15s"},onMouseEnter:A=>A.currentTarget.style.borderColor="var(--primary, #4f46e5)",onMouseLeave:A=>A.currentTarget.style.borderColor="var(--border, #334155)",children:[e.jsxs("div",{style:{minWidth:0},children:[e.jsx("div",{style:{fontWeight:600,fontSize:14,marginBottom:4,whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},children:n}),e.jsxs("div",{style:{fontSize:12,opacity:.55,display:"flex",gap:10,flexWrap:"wrap"},children:[e.jsxs("span",{children:["ðŸ‘¤ ",E]}),e.jsxs("span",{children:["ðŸ’» ",g]}),e.jsxs("span",{children:["ðŸ† Score: ",D]}),S&&e.jsxs("span",{children:["ðŸ“… ",new Date(S).toLocaleDateString()]})]})]}),e.jsx(Tt,{size:18,style:{opacity:.4,flexShrink:0,marginLeft:12}})]},d.id)})}):e.jsxs("div",{style:{padding:"48px 0",textAlign:"center",opacity:.5},children:[e.jsx(Vt,{size:40,style:{marginBottom:12}}),e.jsx("p",{style:{margin:0},children:"No submissions found."})]})]})}export{mi as default};
