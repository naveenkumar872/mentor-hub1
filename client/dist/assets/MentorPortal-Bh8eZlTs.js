import{r as n,j as e,k as et,f as tt,h as q}from"./vendor-react-DZU2lOjX.js";import{s as ge,D as st,a as rt,E as at,A as it,G as lt,C as nt}from"./Portal-B5LUEaqQ.js";import{A as Ee,T as ot,S as dt}from"./LiveMonitoring-CDtMJqc6.js";import{T as te,X as oe,x as re,f as ve,e as J,c as z,at as Fe,v as ct,a8 as mt,o as pt,p as xt,au as Ue,av as gt,an as Te,h as ht,s as Qe,ag as ut,am as Se,a6 as ke,g as we,ah as Ie,B as qe,l as de,aw as bt,ac as Oe,I as X,ad as Ce,ae as ft,M as yt,ab as K,J as ue,ax as Le,U as Ne,S as Ve,ay as ze,a9 as be,al as ne,F as We,j as jt,az as Be,af as vt,z as St}from"./vendor-misc-D7KlG0WG.js";import{T as kt,u as Ye,a as He}from"./index-Dce4qVRW.js";/* empty css                             */import{R as Me,A as wt,X as Ct,Y as Nt,T as _e,a as zt,P as At,c as Tt,d as It}from"./vendor-charts-DyrUJrah.js";function Lt({user:s}){const[r,T]=n.useState([]),[C,g]=n.useState([]),[L,p]=n.useState(!1),[S,N]=n.useState(new Set),[k,o]=n.useState(0);n.useEffect(()=>(ge.joinMonitoring(s.id,"mentor"),p(!0),ge.onMonitoringConnected(c=>{console.log("âœ… Joined live monitoring:",c)}),ge.onLiveUpdate(c=>{T(v=>[c,...v.slice(0,49)]),N(v=>{const i=new Set(v);return c.type==="submission_started"?(i.add(c.studentId),console.log(`ðŸ“Š Student ${c.studentName} started - Total working: ${i.size}`)):c.type==="submission_completed"&&(i.delete(c.studentId),console.log(`âœ… Student ${c.studentName} completed - Total working: ${i.size}`)),i})}),ge.onLiveAlert(c=>{g(v=>[c,...v.slice(0,29)]),o(v=>v+1)}),()=>{ge.disconnect(),p(!1)}),[s.id]);const d=c=>{g(v=>v.filter((i,y)=>y!==c))},b=c=>{switch(c){case"submission_started":return e.jsx(re,{className:"w-4 h-4 text-blue-500"});case"submission_completed":return e.jsx(J,{className:"w-4 h-4 text-green-500"});case"progress_update":return e.jsx(ve,{className:"w-4 h-4 text-yellow-500"});case"test_failed":return e.jsx(te,{className:"w-4 h-4 text-orange-500"});default:return e.jsx(re,{className:"w-4 h-4 text-gray-500"})}},A=c=>new Date(c).toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit",second:"2-digit"});return e.jsxs("div",{className:"live-monitoring-container",children:[e.jsx("h2",{className:"text-2xl font-bold mb-6",children:"ðŸ“Š Live Student Monitoring"}),e.jsxs("div",{className:"status-bar",children:[e.jsxs("div",{className:`status-item ${L?"active":"inactive"}`,children:[e.jsx("div",{className:"status-dot"}),e.jsx("span",{children:L?"Live Monitoring Active":"Not Monitoring"})]}),e.jsxs("div",{className:"status-item",children:[e.jsx("span",{className:"font-semibold text-blue-600",children:S.size}),e.jsx("span",{className:"ml-2",children:"Students Working"})]}),e.jsxs("div",{className:"status-item",children:[e.jsx("span",{className:"font-semibold text-red-600",children:k}),e.jsx("span",{className:"ml-2",children:"Alerts"})]})]}),e.jsxs("div",{className:"flex gap-6 mt-6",children:[e.jsxs("div",{className:"flex-1 max-w-md",children:[e.jsxs("h3",{className:"text-lg font-semibold mb-4 flex items-center gap-2",children:[e.jsx(te,{size:20,className:"text-red-500"}),"Proctoring Alerts"]}),e.jsx("div",{className:"alerts-list",children:C.length===0?e.jsx("div",{className:"empty-state",children:"No alerts"}):C.map((c,v)=>e.jsxs("div",{className:`alert-item severity-${c.severity}`,children:[e.jsxs("div",{className:"alert-header",children:[e.jsx("span",{className:"font-semibold",children:c.studentName||`Student ${c.studentId}`}),e.jsx("button",{className:"dismiss-btn",onClick:()=>d(v),title:"Dismiss",children:e.jsx(oe,{size:16})})]}),e.jsxs("div",{className:"alert-body",children:[e.jsx("div",{className:"violation-type",children:c.violationType.replace(/_/g," ").toUpperCase()}),e.jsx("div",{className:"severity-badge",children:c.severity.toUpperCase()})]}),e.jsx("div",{className:"alert-time",children:A(c.timestamp)}),c.requiresAction&&e.jsx("div",{className:"requires-action",children:"âš ï¸ Requires immediate action"})]},v))})]}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("h3",{className:"text-lg font-semibold mb-4 flex items-center gap-2",children:[e.jsx(re,{size:20,className:"text-blue-500"}),"Live Activity Feed"]}),e.jsx("div",{className:"updates-list",children:r.length===0?e.jsx("div",{className:"empty-state",children:"Waiting for activity..."}):r.map((c,v)=>e.jsxs("div",{className:`update-item type-${c.type}`,children:[e.jsx("div",{className:"update-icon",children:b(c.type)}),e.jsx("div",{className:"update-content",children:e.jsxs("div",{className:"update-title",children:[c.type==="submission_started"&&e.jsxs("span",{children:[e.jsx("strong",{children:c.studentName||`Student ${c.studentId}`})," started ",c.problemTitle,c.isProctored&&e.jsx("span",{className:"badge-proctored",children:"Proctored"})]}),c.type==="submission_completed"&&e.jsxs("span",{children:[e.jsx("strong",{children:c.studentName||`Student ${c.studentId}`})," completed ",c.problemTitle,e.jsx("span",{className:`badge-status status-${c.status}`,children:c.status.toUpperCase()}),c.score!==void 0&&e.jsxs("span",{className:"badge-score",children:["Score: ",c.score,"%"]})]}),c.type==="progress_update"&&e.jsxs("span",{children:[e.jsx("strong",{children:c.studentName||`Student ${c.studentId}`})," - ",c.problemId,e.jsxs("span",{className:"badge-progress",children:[c.progress,"% complete"]})]}),c.type==="test_failed"&&e.jsxs("span",{children:[e.jsx("strong",{children:c.studentName||`Student ${c.studentId}`})," - Test failed: ",c.testname]})]})}),e.jsx("div",{className:"update-time",children:A(c.timestamp)})]},v))})]})]})]})}const je="http://localhost:3000/api",Rt={background:"var(--bg-card)",border:"1px solid var(--border-color)",borderRadius:"16px",padding:"1.5rem",transition:"all 0.3s ease"},De={width:"100%",padding:"0.7rem 1rem",borderRadius:"10px",border:"1px solid var(--border-color)",background:"var(--bg-card)",color:"var(--text)",fontSize:"0.85rem",outline:"none",boxSizing:"border-box"},Ae={padding:"0.5rem 1rem",borderRadius:"8px",border:"none",background:"linear-gradient(135deg, #3b82f6, #8b5cf6)",color:"white",fontWeight:600,cursor:"pointer",fontSize:"0.8rem",display:"flex",alignItems:"center",gap:"0.4rem"},Pe={...Ae,background:"rgba(59,130,246,0.1)",color:"#3b82f6",border:"1px solid rgba(59,130,246,0.3)"},he={suggestion:{color:"#3b82f6",icon:mt,label:"Suggestion"},issue:{color:"#ef4444",icon:ct,label:"Issue"},praise:{color:"#10b981",icon:J,label:"Praise"},question:{color:"#f59e0b",icon:Fe,label:"Question"}};function $t({submissionId:s,code:r,mentorId:T,studentId:C,readOnly:g=!1}){const[L,p]=n.useState([]),[S,N]=n.useState(null),[k,o]=n.useState({comment:"",feedbackType:"suggestion"}),[d,b]=n.useState(null),[A,c]=n.useState(new Set),[v,i]=n.useState(""),[y,a]=n.useState(!1),h=n.useCallback(async()=>{if(s){a(!0);try{const f=await z.get(`${je}/feedback/submission/${s}`);p(f.data.data||[]);const B=new Set;(f.data.data||[]).forEach(M=>B.add(M.line_number)),c(B)}catch(f){console.error(f)}a(!1)}},[s]);n.useEffect(()=>{h()},[h]);const _=async f=>{if(k.comment.trim())try{await z.post(`${je}/feedback`,{submissionId:s,mentorId:T,studentId:C,lineNumber:f,comment:k.comment,feedbackType:k.feedbackType}),N(null),o({comment:"",feedbackType:"suggestion"}),h()}catch(B){console.error(B)}},m=async f=>{try{await z.put(`${je}/feedback/${f}`,{comment:k.comment,feedbackType:k.feedbackType}),b(null),o({comment:"",feedbackType:"suggestion"}),h()}catch(B){console.error(B)}},I=async f=>{try{await z.delete(`${je}/feedback/${f}`),h()}catch(B){console.error(B)}},x=f=>{b(f.id),o({comment:f.comment,feedbackType:f.feedback_type})},W=(r||"").split(`
`),P={};L.filter(f=>!v||f.feedback_type===v).forEach(f=>{P[f.line_number]||(P[f.line_number]=[]),P[f.line_number].push(f)});const ae=f=>{c(B=>{const M=new Set(B);return M.has(f)?M.delete(f):M.add(f),M})},F=L.length,O=L.reduce((f,B)=>(f[B.feedback_type]=(f[B.feedback_type]||0)+1,f),{});return y&&L.length===0?e.jsx("div",{style:{textAlign:"center",padding:"2rem"},children:e.jsx("div",{className:"loading-spinner"})}):e.jsxs("div",{className:"animate-fadeIn",children:[e.jsxs("div",{style:{display:"flex",gap:"0.75rem",marginBottom:"1rem",flexWrap:"wrap",alignItems:"center"},children:[e.jsx("div",{style:{display:"flex",gap:"0.5rem"},children:Object.entries(he).map(([f,B])=>{const M=B.icon,V=O[f]||0;return e.jsxs("button",{onClick:()=>i(v===f?"":f),style:{padding:"0.3rem 0.7rem",borderRadius:"20px",border:`1px solid ${v===f?B.color:"var(--border-color)"}`,background:v===f?`${B.color}15`:"transparent",color:v===f?B.color:"var(--text-muted)",cursor:"pointer",fontSize:"0.7rem",fontWeight:600,display:"flex",alignItems:"center",gap:"0.3rem"},children:[e.jsx(M,{size:12})," ",B.label," (",V,")"]},f)})}),e.jsxs("span",{style:{fontSize:"0.75rem",color:"var(--text-muted)",marginLeft:"auto"},children:[F," total comments"]})]}),e.jsx("div",{style:{...Rt,padding:0,overflow:"hidden",fontFamily:"'Fira Code', 'Cascadia Code', 'Consolas', monospace",fontSize:"0.8rem"},children:W.map((f,B)=>{const M=B+1,V=P[M]||[],U=V.length>0,l=A.has(M);return e.jsxs("div",{children:[e.jsxs("div",{style:{display:"flex",borderBottom:"1px solid rgba(255,255,255,0.03)",background:U?"rgba(59,130,246,0.04)":"transparent",position:"relative"},onMouseEnter:u=>{U||(u.currentTarget.style.background="rgba(255,255,255,0.02)")},onMouseLeave:u=>{U||(u.currentTarget.style.background="transparent")},children:[e.jsx("div",{style:{width:"50px",padding:"0.2rem 0.5rem",textAlign:"right",color:"var(--text-muted)",userSelect:"none",borderRight:`2px solid ${U?"#3b82f6":"transparent"}`,fontSize:"0.7rem",lineHeight:"1.6",flexShrink:0},children:M}),e.jsx("pre",{style:{margin:0,padding:"0.2rem 0.75rem",flex:1,lineHeight:"1.6",overflow:"hidden",whiteSpace:"pre",color:"var(--text)"},children:f||" "}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.3rem",paddingRight:"0.5rem",flexShrink:0},children:[U&&e.jsxs("button",{onClick:()=>ae(M),style:{background:"transparent",border:"none",color:"#3b82f6",cursor:"pointer",padding:"0.15rem",display:"flex",alignItems:"center",gap:"0.2rem",fontSize:"0.65rem"},children:[e.jsx(Fe,{size:12})," ",V.length,l?e.jsx(pt,{size:10}):e.jsx(xt,{size:10})]}),!g&&e.jsx("button",{onClick:()=>{N(S===M?null:M),o({comment:"",feedbackType:"suggestion"})},style:{background:"transparent",border:"none",color:"var(--text-muted)",cursor:"pointer",padding:"0.15rem",opacity:.5},onMouseEnter:u=>u.currentTarget.style.opacity=1,onMouseLeave:u=>u.currentTarget.style.opacity=.5,children:e.jsx("span",{style:{fontSize:"1rem",lineHeight:1},children:"+"})})]})]}),U&&l&&V.map(u=>{const $=he[u.feedback_type]||he.suggestion,Q=$.icon,ie=d===u.id;return e.jsx("div",{style:{marginLeft:"52px",padding:"0.6rem 1rem",borderLeft:`3px solid ${$.color}`,background:`${$.color}08`,borderBottom:"1px solid var(--border-color)"},children:ie?e.jsxs("div",{children:[e.jsx("div",{style:{display:"flex",gap:"0.5rem",marginBottom:"0.5rem"},children:Object.entries(he).map(([H,E])=>e.jsx("button",{onClick:()=>o(Z=>({...Z,feedbackType:H})),style:{padding:"0.2rem 0.5rem",borderRadius:"12px",border:`1px solid ${k.feedbackType===H?E.color:"var(--border-color)"}`,background:k.feedbackType===H?`${E.color}20`:"transparent",color:k.feedbackType===H?E.color:"var(--text-muted)",cursor:"pointer",fontSize:"0.65rem",fontWeight:600},children:E.label},H))}),e.jsx("textarea",{value:k.comment,onChange:H=>o(E=>({...E,comment:H.target.value})),style:{...De,fontSize:"0.8rem",minHeight:"60px",resize:"vertical"}}),e.jsxs("div",{style:{display:"flex",gap:"0.5rem",marginTop:"0.5rem",justifyContent:"flex-end"},children:[e.jsx("button",{onClick:()=>{b(null),o({comment:"",feedbackType:"suggestion"})},style:{...Pe,padding:"0.3rem 0.8rem",fontSize:"0.7rem"},children:"Cancel"}),e.jsxs("button",{onClick:()=>m(u.id),style:{...Ae,padding:"0.3rem 0.8rem",fontSize:"0.7rem"},children:[e.jsx(Ue,{size:12})," Save"]})]})]}):e.jsxs("div",{children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.4rem",marginBottom:"0.3rem"},children:[e.jsx(Q,{size:12,color:$.color}),e.jsx("span",{style:{fontSize:"0.65rem",fontWeight:600,color:$.color,textTransform:"uppercase",letterSpacing:"0.05em"},children:$.label}),e.jsxs("span",{style:{fontSize:"0.65rem",color:"var(--text-muted)",marginLeft:"auto"},children:[u.mentor_name||u.mentor_id," â€¢ ",new Date(u.created_at).toLocaleDateString()]})]}),e.jsx("p",{style:{margin:0,fontSize:"0.8rem",color:"var(--text)",lineHeight:1.5,fontFamily:"inherit",whiteSpace:"pre-wrap"},children:u.comment}),!g&&e.jsxs("div",{style:{display:"flex",gap:"0.4rem",marginTop:"0.4rem"},children:[e.jsxs("button",{onClick:()=>x(u),style:{background:"transparent",border:"none",color:"#3b82f6",cursor:"pointer",fontSize:"0.7rem",display:"flex",alignItems:"center",gap:"0.2rem"},children:[e.jsx(gt,{size:10})," Edit"]}),e.jsxs("button",{onClick:()=>I(u.id),style:{background:"transparent",border:"none",color:"#ef4444",cursor:"pointer",fontSize:"0.7rem",display:"flex",alignItems:"center",gap:"0.2rem"},children:[e.jsx(Te,{size:10})," Delete"]})]})]})},u.id)}),S===M&&e.jsxs("div",{style:{marginLeft:"52px",padding:"0.75rem 1rem",background:"rgba(59,130,246,0.06)",borderLeft:"3px solid #3b82f6",borderBottom:"1px solid var(--border-color)"},children:[e.jsx("div",{style:{display:"flex",gap:"0.5rem",marginBottom:"0.5rem"},children:Object.entries(he).map(([u,$])=>e.jsx("button",{onClick:()=>o(Q=>({...Q,feedbackType:u})),style:{padding:"0.2rem 0.5rem",borderRadius:"12px",border:`1px solid ${k.feedbackType===u?$.color:"var(--border-color)"}`,background:k.feedbackType===u?`${$.color}20`:"transparent",color:k.feedbackType===u?$.color:"var(--text-muted)",cursor:"pointer",fontSize:"0.65rem",fontWeight:600},children:$.label},u))}),e.jsx("textarea",{value:k.comment,onChange:u=>o($=>({...$,comment:u.target.value})),placeholder:`Add feedback for line ${M}...`,style:{...De,fontSize:"0.8rem",minHeight:"60px",resize:"vertical"},autoFocus:!0}),e.jsxs("div",{style:{display:"flex",gap:"0.5rem",marginTop:"0.5rem",justifyContent:"flex-end"},children:[e.jsx("button",{onClick:()=>N(null),style:{...Pe,padding:"0.3rem 0.8rem",fontSize:"0.7rem"},children:"Cancel"}),e.jsxs("button",{onClick:()=>_(M),style:{...Ae,padding:"0.3rem 0.8rem",fontSize:"0.7rem"},children:[e.jsx(ht,{size:12})," Add"]})]})]})]},M)})})]})}const Wt=()=>{const{theme:s}=n.useContext(kt),{user:r}=Ye(),[T,C]=n.useState({}),[g,L]=n.useState(new Date),[p,S]=n.useState(!0),N=localStorage.getItem("authToken"),k=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],o=["January","February","March","April","May","June","July","August","September","October","November","December"];n.useEffect(()=>{d()},[g]);const d=async()=>{try{const a=await fetch(`/api/users/${r?.id}/availability`,{headers:{Authorization:`Bearer ${N}`}});if(a.ok){const h=await a.json();C(h.slots||{})}}catch(a){console.error("Error loading availability:",a)}finally{S(!1)}},b=a=>{const h=a.toISOString().split("T")[0];C(_=>({..._,[h]:!_[h]}))},A=async()=>{try{(await fetch(`/api/users/${r?.id}/availability`,{method:"PUT",headers:{Authorization:`Bearer ${N}`,"Content-Type":"application/json"},body:JSON.stringify({slots:T})})).ok&&alert("Availability updated!")}catch(a){console.error("Error saving availability:",a)}},c=a=>new Date(a.getFullYear(),a.getMonth()+1,0).getDate(),v=a=>new Date(a.getFullYear(),a.getMonth(),1).getDay(),y=(()=>{const a=c(g),h=v(g),_=[];for(let m=0;m<h;m++)_.push(null);for(let m=1;m<=a;m++)_.push(new Date(g.getFullYear(),g.getMonth(),m));return _})();return e.jsxs("div",{className:`availability-calendar ${s}`,children:[e.jsxs("div",{className:"calendar-header",children:[e.jsxs("h2",{children:[e.jsx(Qe,{size:24}),"Set Availability"]}),e.jsx("p",{children:"Mark your available slots for mentoring sessions"})]}),e.jsxs("div",{className:"calendar-nav",children:[e.jsx("button",{onClick:()=>L(new Date(g.getFullYear(),g.getMonth()-1)),children:"â† Previous"}),e.jsxs("h3",{children:[o[g.getMonth()]," ",g.getFullYear()]}),e.jsx("button",{onClick:()=>L(new Date(g.getFullYear(),g.getMonth()+1)),children:"Next â†’"})]}),e.jsxs("div",{className:"calendar-grid",children:[e.jsx("div",{className:"weekdays",children:k.map(a=>e.jsx("div",{className:"weekday",children:a},a))}),e.jsx("div",{className:"dates",children:y.map((a,h)=>e.jsx("div",{className:`date-cell ${a?"active":"empty"} ${a&&T[a.toISOString().split("T")[0]]?"available":""}`,onClick:()=>a&&b(a),children:a?.getDate()},h))})]}),e.jsxs("div",{className:"calendar-legend",children:[e.jsxs("div",{className:"legend-item",children:[e.jsx("div",{className:"legend-box empty"}),e.jsx("span",{children:"Unavailable"})]}),e.jsxs("div",{className:"legend-item",children:[e.jsx("div",{className:"legend-box available"}),e.jsx("span",{children:"Available"})]})]}),e.jsxs("button",{className:"save-btn",onClick:A,children:[e.jsx(Ue,{size:16}),"Save Availability"]})]})},R="http://localhost:3000/api",le=["#3b82f6","#8b5cf6","#06b6d4","#10b981","#f59e0b"];function es(){const{user:s}=Ye(),{t:r}=He(),T=et(),[C,g]=n.useState(""),[L,p]=n.useState(""),[S,N]=n.useState(0);n.useEffect(()=>{const o=s?.id||s?.userId;if(!o)return;const d=async()=>{try{const A=await z.get(`${R}/messages/unread/${o}`);N(A.data.unreadCount||0)}catch{}};d();const b=setInterval(d,15e3);return()=>clearInterval(b)},[s]),n.useEffect(()=>{switch(T.pathname.split("/").pop()){case"upload-tasks":g(r("upload_ml_tasks")),p(r("create_ml_tasks_subtitle"));break;case"upload-problems":g(r("upload_problems")),p(r("create_problems_subtitle"));break;case"aptitude-tests":g(r("aptitude_tests")),p("Manage and assign aptitude tests to students");break;case"global-tests":g(r("global_complete_tests")),p("Manage and assign comprehensive tests to students");break;case"skill-tests":g("Skill Tests"),p("Manage and assign skill assessments to students");break;case"leaderboard":g(r("leaderboard")),p(r("student_rankings"));break;case"all-submissions":g(r("all_submissions")),p(r("review_student_work"));break;case"live-monitoring":g(r("live_student_monitoring")),p(r("realtime_activity_subtitle"));break;case"analytics":g(r("analytics")),p(r("analytics_dashboard_subtitle"));break;case"messaging":g("Direct Messaging"),p("Chat with your students");break;case"code-reviews":g("Code Reviews"),p("Review and comment on student code submissions");break;case"availability":g("Availability Calendar"),p("Set your availability for mentoring sessions");break;case"reports":g("Export Reports"),p("Download performance and analytics reports");break;default:g(r("dashboard")),p(r("welcome_back_name",{name:s?.name||""}))}},[T,s,r]);const k=[{path:"/mentor",label:r("dashboard"),icon:e.jsx(ut,{size:20})},{label:"Content Management",icon:e.jsx(ke,{size:20}),defaultExpanded:!1,children:[{path:"/mentor/upload-tasks",label:r("upload_ml_tasks"),icon:e.jsx(Se,{size:20})},{path:"/mentor/upload-problems",label:r("upload_problems"),icon:e.jsx(ke,{size:20})},{path:"/mentor/aptitude-tests",label:r("aptitude_tests"),icon:e.jsx(we,{size:20})},{path:"/mentor/global-tests",label:r("global_complete_tests"),icon:e.jsx(Ie,{size:20})},{path:"/mentor/skill-tests",label:"Skill Tests",icon:e.jsx(qe,{size:20})}]},{label:"Monitoring",icon:e.jsx(re,{size:20}),defaultExpanded:!1,children:[{path:"/mentor/leaderboard",label:r("leaderboard"),icon:e.jsx(de,{size:20})},{path:"/mentor/all-submissions",label:r("all_submissions"),icon:e.jsx(bt,{size:20})},{path:"/mentor/analytics",label:r("analytics"),icon:e.jsx(Oe,{size:20})},{path:"/mentor/live-monitoring",label:r("live_monitoring"),icon:e.jsx(re,{size:20})},{path:"/mentor/code-reviews",label:"Code Reviews",icon:e.jsx(X,{size:20})}]},{label:"Tools",icon:e.jsx(ft,{size:20}),defaultExpanded:!1,children:[{path:"/mentor/availability",label:"Availability Calendar",icon:e.jsx(Qe,{size:20})},{path:"/mentor/reports",label:"Export Reports",icon:e.jsx(Ce,{size:20})}]},{path:"/mentor/messaging",label:"Messaging",icon:e.jsx(yt,{size:20}),badge:S}];return e.jsx(st,{navItems:k,title:C,subtitle:L,children:e.jsxs(tt,{children:[e.jsx(q,{path:"/",element:e.jsx(Bt,{user:s})}),e.jsx(q,{path:"/upload-tasks",element:e.jsx(Mt,{user:s})}),e.jsx(q,{path:"/upload-problems",element:e.jsx(_t,{user:s})}),e.jsx(q,{path:"/aptitude-tests",element:e.jsx(Ut,{user:s})}),e.jsx(q,{path:"/global-tests",element:e.jsx(Qt,{user:s})}),e.jsx(q,{path:"/skill-tests",element:e.jsx(qt,{user:s})}),e.jsx(q,{path:"/leaderboard",element:e.jsx(Dt,{user:s})}),e.jsx(q,{path:"/all-submissions",element:e.jsx(Pt,{user:s})}),e.jsx(q,{path:"/analytics",element:e.jsx(Ft,{user:s})}),e.jsx(q,{path:"/live-monitoring",element:e.jsx(Lt,{user:s})}),e.jsx(q,{path:"/messaging",element:e.jsx(rt,{currentUser:s})}),e.jsx(q,{path:"/code-reviews",element:e.jsx(Vt,{user:s})}),e.jsx(q,{path:"/availability",element:e.jsx(Wt,{})}),e.jsx(q,{path:"/reports",element:e.jsx(at,{})})]})})}function Bt({user:s}){const[r,T]=n.useState(null),[C,g]=n.useState(!0);n.useEffect(()=>{z.get(`${R}/analytics/mentor/${s.id}`).then(p=>{T(p.data),g(!1)}).catch(p=>g(!1))},[s.id]);const L=p=>{if(!p)return"Never";const S=new Date(p),k=new Date-S,o=Math.floor(k/6e4),d=Math.floor(o/60),b=Math.floor(d/24);return o<1?"Just now":o<60?`${o}m ago`:d<24?`${d}h ago`:b<7?`${b}d ago`:S.toLocaleDateString("en-US",{month:"short",day:"numeric"})};return C?e.jsx("div",{className:"loading-spinner"}):r?e.jsxs("div",{className:"dashboard-container animate-fadeIn",children:[e.jsxs("div",{className:"dashboard-stats-grid",style:{gridTemplateColumns:"repeat(6, 1fr)"},children:[e.jsx("div",{className:"dashboard-stat-card stat-card-blue",children:e.jsxs("div",{className:"stat-card-inner",children:[e.jsx("div",{className:"stat-icon-box",style:{background:"linear-gradient(135deg, #1e40af, #3b82f6)"},children:e.jsx(K,{size:22,color:"#fff"})}),e.jsxs("div",{className:"stat-content",children:[e.jsx("div",{className:"stat-number",children:r.totalStudents}),e.jsx("div",{className:"stat-label-text",children:"Students"})]})]})}),e.jsx("div",{className:"dashboard-stat-card stat-card-purple",children:e.jsxs("div",{className:"stat-card-inner",children:[e.jsx("div",{className:"stat-icon-box",style:{background:"linear-gradient(135deg, #6d28d9, #8b5cf6)"},children:e.jsx(ue,{size:22,color:"#fff"})}),e.jsxs("div",{className:"stat-content",children:[e.jsx("div",{className:"stat-number",children:r.taskSubmissions||0}),e.jsx("div",{className:"stat-label-text",children:"Task Subs"})]})]})}),e.jsx("div",{className:"dashboard-stat-card stat-card-emerald",children:e.jsxs("div",{className:"stat-card-inner",children:[e.jsx("div",{className:"stat-icon-box",style:{background:"linear-gradient(135deg, #059669, #10b981)"},children:e.jsx(X,{size:22,color:"#fff"})}),e.jsxs("div",{className:"stat-content",children:[e.jsx("div",{className:"stat-number",children:r.codeSubmissions||0}),e.jsx("div",{className:"stat-label-text",children:"Code Subs"})]})]})}),e.jsx("div",{className:"dashboard-stat-card stat-card-pink",children:e.jsxs("div",{className:"stat-card-inner",children:[e.jsx("div",{className:"stat-icon-box",style:{background:"linear-gradient(135deg, #be185d, #ec4899)"},children:e.jsx(qe,{size:22,color:"#fff"})}),e.jsxs("div",{className:"stat-content",children:[e.jsx("div",{className:"stat-number",children:r.aptitudeSubmissions||0}),e.jsx("div",{className:"stat-label-text",children:"Aptitude"})]})]})}),e.jsx("div",{className:"dashboard-stat-card stat-card-green",children:e.jsxs("div",{className:"stat-card-inner",children:[e.jsx("div",{className:"stat-icon-box",style:{background:"linear-gradient(135deg, #047857, #10b981)"},children:e.jsx(J,{size:22,color:"#fff"})}),e.jsxs("div",{className:"stat-content",children:[e.jsxs("div",{className:"stat-number",children:[r.avgScore,"%"]}),e.jsx("div",{className:"stat-label-text",children:"Avg Score"})]})]})}),e.jsx("div",{className:"dashboard-stat-card stat-card-orange",children:e.jsxs("div",{className:"stat-card-inner",children:[e.jsx("div",{className:"stat-icon-box",style:{background:"linear-gradient(135deg, #c2410c, #f97316)"},children:e.jsx(Oe,{size:22,color:"#fff"})}),e.jsxs("div",{className:"stat-content",children:[e.jsx("div",{className:"stat-number",children:r.totalTasks+r.totalProblems}),e.jsx("div",{className:"stat-label-text",children:"Content"})]})]})})]}),e.jsxs("div",{className:"mentor-charts-grid",children:[e.jsxs("div",{className:"dashboard-panel mentor-chart-large",children:[e.jsx("div",{className:"chart-header",children:e.jsxs("div",{children:[e.jsxs("h3",{className:"panel-title",style:{marginBottom:"0.25rem"},children:[e.jsx(Le,{size:18,color:"#8b5cf6"})," Group Submission Trends"]}),e.jsx("p",{style:{fontSize:"0.8rem",color:"var(--text-muted)",margin:0},children:"Last 7 days mentee activity"})]})}),e.jsx("div",{style:{width:"100%",height:"280px",marginTop:"1rem"},children:e.jsx(Me,{children:e.jsxs(wt,{data:r.submissionTrends,children:[e.jsx("defs",{children:e.jsxs("linearGradient",{id:"colorCountMentor",x1:"0",y1:"0",x2:"0",y2:"1",children:[e.jsx("stop",{offset:"5%",stopColor:"#8b5cf6",stopOpacity:.4}),e.jsx("stop",{offset:"95%",stopColor:"#8b5cf6",stopOpacity:0})]})}),e.jsx(Ct,{dataKey:"date",stroke:"var(--text-muted)",fontSize:12,axisLine:!1,tickLine:!1}),e.jsx(Nt,{stroke:"var(--text-muted)",fontSize:12,axisLine:!1,tickLine:!1}),e.jsx(_e,{contentStyle:{background:"var(--bg-card)",border:"1px solid var(--border-color)",borderRadius:"10px",boxShadow:"0 10px 30px rgba(0,0,0,0.2)"},itemStyle:{color:"#8b5cf6"},labelStyle:{color:"var(--text)"}}),e.jsx(zt,{type:"monotone",dataKey:"count",stroke:"#8b5cf6",strokeWidth:3,fillOpacity:1,fill:"url(#colorCountMentor)"})]})})})]}),e.jsxs("div",{className:"dashboard-panel mentor-chart-small",children:[e.jsx("div",{className:"chart-header",children:e.jsxs("div",{children:[e.jsxs("h3",{className:"panel-title",style:{marginBottom:"0.25rem"},children:[e.jsx(X,{size:18,color:"#3b82f6"})," Language Usage"]}),e.jsx("p",{style:{fontSize:"0.8rem",color:"var(--text-muted)",margin:0},children:"Mentee preference"})]})}),e.jsxs("div",{style:{width:"100%",height:"280px",marginTop:"1rem"},children:[e.jsx(Me,{children:e.jsxs(At,{children:[e.jsx(Tt,{data:r.languageStats,cx:"50%",cy:"50%",innerRadius:65,outerRadius:90,paddingAngle:4,dataKey:"value",stroke:"none",children:r.languageStats.map((p,S)=>e.jsx(It,{fill:le[S%le.length]},`cell-${S}`))}),e.jsx(_e,{contentStyle:{background:"var(--bg-card)",border:"1px solid var(--border-color)",borderRadius:"10px"},itemStyle:{color:"var(--text)"}})]})}),e.jsx("div",{className:"language-legend",children:r.languageStats.slice(0,4).map((p,S)=>e.jsxs("div",{className:"legend-item",children:[e.jsx("span",{className:"legend-dot",style:{background:le[S]}}),e.jsx("span",{className:"legend-text",children:p.name})]},p.name))})]})]})]}),e.jsxs("div",{className:"mentor-bottom-grid",children:[e.jsxs("div",{className:"dashboard-panel",children:[e.jsxs("div",{className:"panel-header",children:[e.jsxs("h3",{className:"panel-title",style:{margin:0},children:[e.jsx(K,{size:18,color:"#3b82f6"})," My Students"]}),e.jsx("span",{className:"student-count-badge",children:r.allocatedStudents?.length||0})]}),e.jsx("div",{className:"students-list",children:r.allocatedStudents&&r.allocatedStudents.length>0?r.allocatedStudents.map((p,S)=>e.jsxs("div",{className:"student-item",children:[e.jsx("div",{className:"student-avatar",style:{background:`linear-gradient(135deg, ${le[S%le.length]}, ${le[(S+1)%le.length]})`},children:p.name.charAt(0).toUpperCase()}),e.jsxs("div",{className:"student-info",children:[e.jsx("div",{className:"student-name",children:p.name}),e.jsxs("div",{className:"student-meta",children:[e.jsxs("span",{children:[e.jsx(Ne,{size:12})," ",p.tasksCompleted," tasks"]}),e.jsxs("span",{children:[e.jsx(X,{size:12})," ",p.problemsCompleted," problems"]})]})]}),e.jsxs("div",{className:"student-score-badge",style:{background:p.avgScore>=70?"rgba(16, 185, 129, 0.15)":p.avgScore>=40?"rgba(251, 191, 36, 0.15)":"rgba(239, 68, 68, 0.15)",color:p.avgScore>=70?"#10b981":p.avgScore>=40?"#fbbf24":"#ef4444"},children:[p.avgScore,"%"]})]},p.id)):e.jsxs("div",{className:"empty-state-small",children:[e.jsx(K,{size:32,color:"var(--text-muted)"}),"No students allocated"]})})]}),e.jsxs("div",{className:"dashboard-panel",children:[e.jsx("div",{className:"panel-header",children:e.jsxs("h3",{className:"panel-title",style:{margin:0},children:[e.jsx(re,{size:18,color:"#8b5cf6"})," Recent Activity"]})}),e.jsx("div",{className:"submissions-list",children:r.recentActivity&&r.recentActivity.length>0?r.recentActivity.map((p,S)=>e.jsxs("div",{className:"submission-item",children:[e.jsx("div",{className:`activity-status-dot ${p.status}`}),e.jsxs("div",{className:"submission-info",children:[e.jsx("div",{className:"submission-title",children:p.studentName}),e.jsxs("div",{className:"submission-meta",children:[e.jsx(ve,{size:12})," ",L(p.time)]})]}),e.jsxs("span",{className:`submission-status ${p.status}`,children:[p.score,"%"]})]},p.id)):e.jsxs("div",{className:"empty-state-small",children:[e.jsx(re,{size:32,color:"var(--text-muted)"}),"No recent activity"]})})]}),e.jsxs("div",{className:"dashboard-panel",children:[e.jsx("div",{className:"panel-header",children:e.jsxs("h3",{className:"panel-title",style:{margin:0},children:[e.jsx(de,{size:18,color:"#fbbf24"})," Top Performers"]})}),e.jsx("div",{className:"leaderboard-list",children:r.menteePerformance&&r.menteePerformance.length>0?r.menteePerformance.map((p,S)=>e.jsxs("div",{className:"leaderboard-item",children:[e.jsx("div",{className:`rank-badge rank-${S+1}`,children:S+1}),e.jsxs("div",{className:"leaderboard-info",children:[e.jsx("div",{className:"leaderboard-name",children:p.name}),e.jsxs("div",{className:"leaderboard-stats",children:[p.count," submissions"]})]}),e.jsxs("div",{className:`leaderboard-score rank-${S+1}-score`,children:[p.score,"%"]})]},S)):e.jsxs("div",{className:"empty-state-small",children:[e.jsx(de,{size:32,color:"var(--text-muted)"}),"No performers yet"]})})]})]})]}):e.jsx("div",{children:"Error loading stats"})}function Mt({user:s}){const[r,T]=n.useState([]),[C,g]=n.useState([]),[L,p]=n.useState(!0),[S,N]=n.useState(!1),[k,o]=n.useState(!1),d=n.useRef(null),[b,A]=n.useState({title:"",type:"machine_learning",difficulty:"medium",description:"",requirements:"",deadline:""}),[c,v]=n.useState(!1),[i,y]=n.useState([]),[a,h]=n.useState([]),[_,m]=n.useState(null),[I,x]=n.useState(""),W=l=>{A({title:l.title||"",type:l.type||"machine_learning",difficulty:l.difficulty||"medium",description:l.description||"",requirements:l.requirements||"",deadline:b.deadline}),N(!1)},P=async()=>{try{const[l,u]=await Promise.all([z.get(`${R}/tasks?mentorId=${s.id}`),z.get(`${R}/mentors/${s.id}/students`)]);T(Array.isArray(l.data)?l.data:l.data?.data||[]),g(u.data),p(!1)}catch{p(!1)}};n.useEffect(()=>{P()},[s.id]);const ae=async()=>{try{const l=await z.get(`${R}/mentors/${s.id}/students`);y(Array.isArray(l.data)?l.data:[])}catch(l){console.error(l)}},F=async l=>{m(l),await ae();try{const u=await z.get(`${R}/tests/${l}/allocated-students`);h(u.data.studentIds||[])}catch(u){console.error(u),h([])}v(!0)},O=l=>{h(u=>u.includes(l)?u.filter($=>$!==l):[...u,l])},f=async()=>{try{await z.post(`${R}/tests/${_}/allocate-students`,{studentIds:a}),alert("Students assigned successfully!"),v(!1)}catch(l){alert("Error assigning students: "+(l.response?.data?.error||l.message))}},B=async l=>{const u=l.target.files[0];if(u){o(!0);try{const Q=(await u.text()).split(`
`).map(E=>E.trim()).filter(Boolean);if(Q.length<2){alert("CSV must have header + at least one row");return}const ie=Q[0].split(",").map(E=>E.trim().toLowerCase().replace(/['"]/g,""));let H=0;for(let E=1;E<Q.length;E++){const Z=Q[E].match(/(".*?"|[^,]+)/g)?.map(ce=>ce.trim().replace(/^"|"$/g,""))||[],G={};ie.forEach((ce,fe)=>G[ce]=Z[fe]||""),G.title&&(await z.post(`${R}/tasks`,{title:G.title,type:G.type||"machine_learning",difficulty:G.difficulty||"medium",description:G.description||"",requirements:G.requirements||"",deadline:G.deadline||"",mentorId:s.id}),H++)}alert(`Created ${H} tasks from CSV!`),P()}catch($){alert("CSV upload failed: "+($.response?.data?.error||$.message))}finally{o(!1),l.target.value=""}}},M=async l=>{l.preventDefault();try{await z.post(`${R}/tasks`,{...b,mentorId:s.id}),A({title:"",type:"machine_learning",difficulty:"medium",description:"",requirements:"",deadline:""}),P()}catch{alert("Error creating task")}},V=async l=>{if(window.confirm("Are you sure you want to delete this task?"))try{await z.delete(`${R}/tasks/${l}`),P()}catch{alert("Error deleting task")}},U=l=>{const u=l.completedBy?.length||0;return u===0||u>=C.length&&C.length>0};return L?e.jsx("div",{className:"loading-spinner"}):e.jsxs("div",{className:"animate-fadeIn",children:[e.jsxs("div",{className:"card glass",style:{marginBottom:"2rem"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"24px"},children:[e.jsxs("h3",{style:{display:"flex",alignItems:"center",gap:"8px",margin:0},children:[e.jsx(Se,{size:20,className:"text-primary"})," Create New ML Task"]}),e.jsxs("div",{style:{display:"flex",gap:"0.5rem"},children:[e.jsx("input",{type:"file",accept:".csv",ref:d,style:{display:"none"},onChange:B}),e.jsxs("button",{type:"button",onClick:()=>d.current?.click(),disabled:k,style:{padding:"0.6rem 1.2rem",background:"linear-gradient(135deg, #10b981, #059669)",border:"none",borderRadius:"8px",color:"white",fontSize:"0.85rem",fontWeight:600,cursor:"pointer",display:"flex",alignItems:"center",gap:"0.5rem"},children:[e.jsx(Se,{size:16})," ",k?"Uploading...":"CSV Upload"]}),e.jsxs("button",{type:"button",onClick:()=>N(!0),style:{padding:"0.6rem 1.2rem",background:"linear-gradient(135deg, #8b5cf6, #6366f1)",border:"none",borderRadius:"8px",color:"white",fontSize:"0.85rem",fontWeight:600,cursor:"pointer",display:"flex",alignItems:"center",gap:"0.5rem"},children:[e.jsx(Ve,{size:16})," AI Generate"]})]})]}),e.jsxs("form",{onSubmit:M,children:[e.jsx("div",{className:"form-grid",children:e.jsxs("div",{className:"form-group",style:{gridColumn:"span 2"},children:[e.jsx("label",{children:"Task Title"}),e.jsx("input",{type:"text",placeholder:"e.g., Sentiment Analysis Project",value:b.title,onChange:l=>A({...b,title:l.target.value}),required:!0})]})}),e.jsxs("div",{className:"form-grid",children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Task Type"}),e.jsxs("select",{value:b.type,onChange:l=>A({...b,type:l.target.value}),children:[e.jsx("option",{value:"machine_learning",children:"Machine Learning"}),e.jsx("option",{value:"deep_learning",children:"Deep Learning"}),e.jsx("option",{value:"data_science",children:"Data Science"}),e.jsx("option",{value:"nlp",children:"NLP"}),e.jsx("option",{value:"computer_vision",children:"Computer Vision"})]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Difficulty"}),e.jsxs("select",{value:b.difficulty,onChange:l=>A({...b,difficulty:l.target.value}),children:[e.jsx("option",{value:"easy",children:"Easy"}),e.jsx("option",{value:"medium",children:"Medium"}),e.jsx("option",{value:"hard",children:"Hard"})]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Deadline (Optional)"}),e.jsx("input",{type:"date",value:b.deadline,onChange:l=>A({...b,deadline:l.target.value})})]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Task Description"}),e.jsx("textarea",{rows:"4",placeholder:"Describe the task in detail...",value:b.description,onChange:l=>A({...b,description:l.target.value}),required:!0})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Requirements (one per line)"}),e.jsx("textarea",{rows:"3",placeholder:`1. Data preprocessing
2. Model training
3. Evaluation`,value:b.requirements,onChange:l=>A({...b,requirements:l.target.value})})]}),e.jsxs("div",{className:"form-actions",children:[e.jsx("button",{type:"button",className:"btn-reset",onClick:()=>A({title:"",type:"machine_learning",difficulty:"medium",description:"",requirements:"",deadline:""}),children:"Reset"}),e.jsxs("button",{type:"submit",className:"btn-create-new",children:[e.jsx(ze,{size:16})," Create Task"]})]})]})]}),e.jsxs("div",{className:"card glass",children:[e.jsxs("h3",{style:{display:"flex",alignItems:"center",gap:"8px",marginBottom:"24px"},children:[e.jsx(de,{size:20,style:{color:"#f59e0b"}})," Task Leaderboard"]}),e.jsx("div",{className:"table-container",style:{border:"none"},children:e.jsxs("table",{children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Task Title"}),e.jsx("th",{children:"Type"}),e.jsx("th",{children:"Difficulty"}),e.jsx("th",{children:"Created"}),e.jsx("th",{children:"Completion"}),e.jsx("th",{children:"Status"}),e.jsx("th",{children:"Actions"})]})}),e.jsx("tbody",{children:r.map(l=>e.jsxs("tr",{children:[e.jsx("td",{style:{fontWeight:600},children:l.title}),e.jsx("td",{children:e.jsx("span",{style:{fontSize:"0.75rem",padding:"2px 8px",borderRadius:"4px",background:"rgba(139, 92, 246, 0.1)",color:"#8b5cf6"},children:l.type?.replace("_"," ").toUpperCase()||"ML"})}),e.jsx("td",{children:e.jsx("span",{className:`difficulty-badge ${l.difficulty?.toLowerCase()}`,children:l.difficulty})}),e.jsx("td",{style:{fontSize:"0.85rem",color:"var(--text-muted)"},children:new Date(l.createdAt).toLocaleDateString()}),e.jsx("td",{children:e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[e.jsx("div",{style:{width:"80px",height:"6px",background:"var(--border-color)",borderRadius:"3px",overflow:"hidden"},children:e.jsx("div",{style:{width:`${C.length>0?(l.completedBy?.length||0)/C.length*100:0}%`,height:"100%",background:"linear-gradient(90deg, #10b981, #06b6d4)"}})}),e.jsxs("span",{style:{fontSize:"0.8rem",color:"var(--text-muted)"},children:[l.completedBy?.length||0,"/",C.length]})]})}),e.jsx("td",{children:e.jsx("span",{className:`status-badge ${l.status}`,children:l.status})}),e.jsx("td",{children:e.jsxs("div",{style:{display:"flex",gap:"0.5rem"},children:[e.jsxs("button",{onClick:()=>F(l.id),className:"btn-create-new",style:{padding:"0.4rem 0.8rem",fontSize:"0.75rem",background:"rgba(139, 92, 246, 0.1)",color:"#8b5cf6",border:"1px solid rgba(139, 92, 246, 0.2)",display:"flex",alignItems:"center",gap:"0.3rem"},children:[e.jsx(K,{size:14})," Assign"]}),e.jsx("button",{onClick:()=>V(l.id),disabled:!U(l),style:{background:U(l)?"rgba(239, 68, 68, 0.1)":"rgba(148, 163, 184, 0.1)",border:"none",color:U(l)?"#ef4444":"#64748b",padding:"0.4rem 0.75rem",borderRadius:"6px",cursor:U(l)?"pointer":"not-allowed",fontSize:"0.8rem"},title:U(l)?"Delete task":"Cannot delete while students are in progress",children:e.jsx(Te,{size:14})})]})})]},l.id))})]})})]}),e.jsx(Ee,{context:"task",isOpen:S,onClose:()=>N(!1),onGenerate:W}),c&&e.jsx("div",{className:"modal-overlay",onClick:()=>{v(!1),x("")},children:e.jsxs("div",{className:"modal-content",onClick:l=>l.stopPropagation(),style:{maxWidth:"750px",maxHeight:"85vh",overflow:"hidden",display:"flex",flexDirection:"column"},children:[e.jsxs("div",{className:"modal-header",style:{padding:"1.5rem",borderBottom:"1px solid var(--border-color)"},children:[e.jsxs("div",{className:"modal-title-with-icon",children:[e.jsx("div",{style:{width:"40px",height:"40px",borderRadius:"10px",background:"linear-gradient(135deg, #3b82f6, #8b5cf6)",display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsx(K,{size:20,color:"white"})}),e.jsxs("div",{style:{textAlign:"left"},children:[e.jsx("h3",{style:{margin:0,fontSize:"1.25rem"},children:"Assign Students to Task"}),e.jsx("p",{style:{margin:0,fontSize:"0.8rem",color:"var(--text-muted)"},children:"Select students for this task"})]})]}),e.jsx("button",{onClick:()=>{v(!1),x("")},className:"modal-close",children:e.jsx(oe,{size:20})})]}),e.jsxs("div",{style:{padding:"1rem 1.5rem",background:"var(--bg-secondary)",borderBottom:"1px solid var(--border-color)",display:"flex",gap:"1rem",alignItems:"center"},children:[e.jsxs("div",{style:{position:"relative",flex:1},children:[e.jsx(be,{size:18,style:{position:"absolute",left:"12px",top:"50%",transform:"translateY(-50%)",color:"var(--text-muted)"}}),e.jsx("input",{type:"text",placeholder:"Search by name or batch...",value:I,onChange:l=>x(l.target.value),style:{width:"100%",padding:"0.7rem 1rem 0.7rem 2.5rem",borderRadius:"10px",background:"var(--bg-card)",border:"1px solid var(--border-color)",color:"var(--text-main)",fontSize:"0.9rem"}})]}),e.jsx("button",{onClick:()=>{const l=i.filter($=>($.name||$.username||"").toLowerCase().includes(I.toLowerCase())||($.batch||"").toLowerCase().includes(I.toLowerCase())),u=l.every($=>a.includes($.id));h(u?$=>$.filter(Q=>!l.map(ie=>ie.id).includes(Q)):$=>[...new Set([...$,...l.map(Q=>Q.id)])])},style:{padding:"0.7rem 1.2rem",borderRadius:"10px",background:"var(--bg-card)",border:"1px solid var(--border-color)",color:"var(--text-main)",fontSize:"0.85rem",fontWeight:600,cursor:"pointer",whiteSpace:"nowrap"},children:i.filter(l=>(l.name||l.username||"").toLowerCase().includes(I.toLowerCase())||(l.batch||"").toLowerCase().includes(I.toLowerCase())).every(l=>a.includes(l.id))?"Deselect All":"Select All"})]}),e.jsx("div",{className:"modal-body",style:{overflowY:"auto",padding:"1.5rem",background:"var(--bg-primary)"},children:e.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(280px, 1fr))",gap:"1rem"},children:i.filter(l=>(l.name||l.username||"").toLowerCase().includes(I.toLowerCase())||(l.batch||"").toLowerCase().includes(I.toLowerCase())).length===0?e.jsxs("div",{style:{gridColumn:"1 / -1",textAlign:"center",padding:"3rem",opacity:.5},children:[e.jsx(K,{size:48,style:{marginBottom:"1rem",opacity:.2}}),e.jsx("p",{children:"No students found matching your search."})]}):i.filter(l=>(l.name||l.username||"").toLowerCase().includes(I.toLowerCase())||(l.batch||"").toLowerCase().includes(I.toLowerCase())).map(l=>e.jsxs("div",{onClick:()=>O(l.id),style:{padding:"1rem",borderRadius:"1rem",background:a.includes(l.id)?"var(--primary-alpha)":"var(--bg-card)",border:`1.5px solid ${a.includes(l.id)?"var(--primary)":"var(--border-color)"}`,cursor:"pointer",display:"flex",alignItems:"center",gap:"1rem",transition:"all 0.2s",boxShadow:a.includes(l.id)?"0 4px 12px var(--primary-alpha)":"none",textAlign:"left"},children:[e.jsx("div",{style:{width:"40px",height:"40px",borderRadius:"50%",background:a.includes(l.id)?"var(--primary)":"var(--bg-secondary)",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"1rem",fontWeight:700,color:"white"},children:(l.name||l.username||"S").charAt(0).toUpperCase()}),e.jsxs("div",{style:{flex:1,minWidth:0},children:[e.jsx("div",{style:{fontWeight:600,fontSize:"0.95rem",color:"var(--text-main)",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:l.name||l.username}),e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--text-muted)",display:"flex",alignItems:"center",gap:"4px",marginTop:"4px"},children:e.jsx("span",{style:{padding:"2px 6px",borderRadius:"4px",background:"var(--bg-secondary)",border:"1px solid var(--border-color)"},children:l.batch||"No Batch"})})]}),a.includes(l.id)&&e.jsx(J,{size:18,color:"var(--primary)"})]},l.id))})}),e.jsxs("div",{className:"modal-footer",style:{padding:"1.2rem 1.5rem",borderTop:"1px solid var(--border-color)",display:"flex",justifyContent:"space-between",alignItems:"center",background:"var(--bg-secondary)"},children:[e.jsxs("div",{style:{fontSize:"0.95rem",color:"var(--text-main)",fontWeight:500},children:[e.jsx("span",{style:{color:"var(--primary)",fontWeight:800,fontSize:"1.1rem"},children:a.length})," students selected"]}),e.jsxs("div",{style:{display:"flex",gap:"1rem"},children:[e.jsx("button",{className:"btn-reset",onClick:()=>{v(!1),x("")},children:"Cancel"}),e.jsx("button",{className:"btn-create-new",onClick:f,style:{background:"var(--primary)",padding:"0.7rem 2rem",borderRadius:"10px",boxShadow:"0 4px 15px var(--primary-alpha)"},children:"Confirm Assignment"})]})]})]})})]})}function _t({user:s}){const[r,T]=n.useState([]),[C,g]=n.useState([]),[L,p]=n.useState(!0),[S,N]=n.useState(!1),[k,o]=n.useState(!1),[d,b]=n.useState("coding"),[A,c]=n.useState(!1),v=n.useRef(null),[i,y]=n.useState(null),[a,h]=n.useState({title:"",type:"Coding",language:"Python",difficulty:"Medium",description:"",testInput:"",expectedOutput:"",deadline:"",status:"live",maxAttempts:0,sqlSchema:"",expectedQueryResult:"",enableProctoring:!1,enableVideoAudio:!1,disableCopyPaste:!1,trackTabSwitches:!1,maxTabSwitches:3,enableFaceDetection:!1,detectMultipleFaces:!1,trackFaceLookaway:!1}),[_,m]=n.useState(!1),[I,x]=n.useState([]),[W,P]=n.useState([]),[ae,F]=n.useState(null),[O,f]=n.useState(""),B=a.type==="SQL"||a.language==="SQL",M=t=>{const w=t.type==="SQL"||t.language==="SQL";h({title:t.title||"",type:t.type||"Coding",language:t.language||"Python",difficulty:t.difficulty||"Medium",description:t.description||"",testInput:w?"":t.sampleInput||"",expectedOutput:w?"":t.expectedOutput||"",sqlSchema:w&&(t.sqlSchema||t.schema)||"",expectedQueryResult:w&&(t.expectedQueryResult||t.expectedResult)||"",deadline:a.deadline,status:t.status||"live",maxAttempts:a.maxAttempts,enableProctoring:a.enableProctoring,enableVideoAudio:a.enableVideoAudio,disableCopyPaste:a.disableCopyPaste,trackTabSwitches:a.trackTabSwitches,maxTabSwitches:a.maxTabSwitches,enableFaceDetection:a.enableFaceDetection,detectMultipleFaces:a.detectMultipleFaces,trackFaceLookaway:a.trackFaceLookaway}),o(!1),N(!0)},V=async()=>{try{const[t,w]=await Promise.all([z.get(`${R}/problems?mentorId=${s.id}`),z.get(`${R}/mentors/${s.id}/students`)]);T(Array.isArray(t.data)?t.data:t.data?.data||[]),g(w.data),p(!1)}catch{p(!1)}};n.useEffect(()=>{V()},[s.id]);const U=async()=>{try{const t=await z.get(`${R}/mentors/${s.id}/students`);x(Array.isArray(t.data)?t.data:[])}catch(t){console.error(t)}},l=async t=>{F(t),await U();try{const w=await z.get(`${R}/tests/${t}/allocated-students`);P(w.data.studentIds||[])}catch(w){console.error(w),P([])}m(!0)},u=t=>{P(w=>w.includes(t)?w.filter(D=>D!==t):[...w,t])},$=async()=>{try{await z.post(`${R}/problems/${ae}/allocate-students`,{studentIds:W}),alert("Students assigned successfully!"),m(!1)}catch(t){alert("Error assigning students: "+(t.response?.data?.error||t.message))}},Q=async t=>{const w=t.target.files[0];if(w){c(!0);try{const ee=(await w.text()).split(`
`).filter(Y=>Y.trim()).map(Y=>Y.trim());if(ee.length<2){alert("CSV must have header + at least one row");return}const ye=Y=>{const me=[];let j="",se=!1;for(let pe=0;pe<Y.length;pe++){const xe=Y[pe];xe==='"'?se=!se:xe===","&&!se?(me.push(j.trim()),j=""):j+=xe}return me.push(j.trim()),me},Ge=ye(ee[0]).map(Y=>Y.toLowerCase());let $e=0;for(let Y=1;Y<ee.length;Y++){if(!ee[Y].trim())continue;const me=ye(ee[Y]),j={};if(Ge.forEach((Ke,Ze)=>j[Ke]=me[Ze]||""),!j.title||!j.description)continue;const se=(j.type||"").toUpperCase()==="SQL"||(j.language||"").toUpperCase()==="SQL",pe=()=>j.testinput||j.test_input||j.testinput||j.sample_input||j.sampleinput||j["sample input"]||j["test input"]||"",xe=()=>j.expectedoutput||j.expected_output||j.expectedresult||j.expected_result||j["expected output"]||j["expected result"]||"",Je=()=>j.sqlschema||j.sql_schema||j.schema||j["sql schema"]||"",Xe=()=>j.expectedqueryresult||j.expected_query_result||j.expectedresult||j.expected_result||j["expected query result"]||"";await z.post(`${R}/problems`,{title:j.title,type:se?"SQL":j.type||"Coding",language:se?"SQL":j.language||"Python",difficulty:(j.difficulty||"Medium").charAt(0).toUpperCase()+(j.difficulty||"Medium").slice(1).toLowerCase(),description:j.description||"",testInput:pe(),expectedOutput:xe(),sqlSchema:se?Je():"",expectedQueryResult:se?Xe():"",maxAttempts:parseInt(j.max_attempts||j.maxattempts||j.attempts)||0,deadline:j.deadline||"",status:j.status||"live",mentorId:s.id}),$e++}alert(`Created ${$e} problems from CSV!`),V()}catch(D){alert("CSV upload failed: "+(D.response?.data?.error||D.message))}finally{c(!1),t.target.value=""}}},ie=async t=>{t.preventDefault();try{await z.post(`${R}/problems`,{...a,mentorId:s.id}),N(!1),h({title:"",type:"Coding",language:"Python",difficulty:"Medium",description:"",testInput:"",expectedOutput:"",deadline:"",status:"live",maxAttempts:0,enableProctoring:!1,enableVideoAudio:!1,disableCopyPaste:!1,trackTabSwitches:!1,maxTabSwitches:3,enableFaceDetection:!1,detectMultipleFaces:!1,trackFaceLookaway:!1}),V()}catch{alert("Error creating problem")}},H=async t=>{if(window.confirm("Are you sure you want to delete this problem?"))try{await z.delete(`${R}/problems/${t}`),V()}catch{alert("Error deleting problem")}},E=async(t,w)=>{try{await z.put(`${R}/problems/${t}`,{maxAttempts:w}),V()}catch(D){console.error("Update max attempts error:",D.response?.data||D.message),alert("Error updating max attempts: "+(D.response?.data?.error||D.message))}},Z=t=>{const w=t.completedBy?.length||0;return w===0||w>=C.length&&C.length>0};if(L)return e.jsx("div",{className:"loading-spinner"});const G=r.filter(t=>t.language!=="SQL"&&t.type!=="SQL"),ce=r.filter(t=>t.language==="SQL"||t.type==="SQL"),fe=d==="coding"?G:ce;return e.jsxs("div",{className:"animate-fadeIn",children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"2rem"},children:[e.jsxs("div",{children:[e.jsx("h2",{style:{fontSize:"1.75rem",fontWeight:800,margin:0},children:"Coding Problems"}),e.jsx("p",{style:{color:"var(--text-muted)",margin:"0.25rem 0 0 0"},children:"Manage your problem library (C, C++, Python, Java, SQL)"})]}),e.jsxs("div",{style:{display:"flex",gap:"0.75rem",flexWrap:"wrap"},children:[e.jsx("input",{type:"file",accept:".csv",ref:v,style:{display:"none"},onChange:Q}),e.jsxs("button",{onClick:()=>v.current?.click(),disabled:A,style:{padding:"0.75rem 1.25rem",background:"linear-gradient(135deg, #10b981, #059669)",border:"none",borderRadius:"8px",color:"white",fontSize:"0.9rem",fontWeight:600,cursor:"pointer",display:"flex",alignItems:"center",gap:"0.5rem"},children:[e.jsx(Se,{size:18})," ",A?"Uploading...":"CSV Upload"]}),e.jsxs("button",{onClick:()=>o(!0),style:{padding:"0.75rem 1.25rem",background:"linear-gradient(135deg, #8b5cf6, #6366f1)",border:"none",borderRadius:"8px",color:"white",fontSize:"0.9rem",fontWeight:600,cursor:"pointer",display:"flex",alignItems:"center",gap:"0.5rem"},children:[e.jsx(Ve,{size:18})," AI Generate"]}),e.jsxs("button",{onClick:()=>N(!0),className:"btn-create-new",style:{padding:"0.75rem 1.5rem",display:"flex",alignItems:"center",gap:"0.5rem"},children:[e.jsx(ze,{size:20})," Create Manually"]})]})]}),e.jsxs("div",{style:{display:"flex",gap:"1rem",marginBottom:"1.5rem",padding:"0.5rem",background:"var(--bg-card)",borderRadius:"12px",width:"fit-content"},children:[e.jsxs("button",{onClick:()=>b("coding"),style:{padding:"0.75rem 1.5rem",borderRadius:"8px",border:"none",cursor:"pointer",fontWeight:600,fontSize:"0.9rem",display:"flex",alignItems:"center",gap:"0.5rem",transition:"all 0.2s ease",background:d==="coding"?"var(--primary)":"transparent",color:d==="coding"?"white":"var(--text-muted)"},children:[e.jsx(X,{size:18}),"Coding Problems",e.jsx("span",{style:{background:d==="coding"?"rgba(255,255,255,0.2)":"var(--bg-dark)",padding:"2px 8px",borderRadius:"12px",fontSize:"0.75rem"},children:G.length})]}),e.jsxs("button",{onClick:()=>b("sql"),style:{padding:"0.75rem 1.5rem",borderRadius:"8px",border:"none",cursor:"pointer",fontWeight:600,fontSize:"0.9rem",display:"flex",alignItems:"center",gap:"0.5rem",transition:"all 0.2s ease",background:d==="sql"?"linear-gradient(135deg, #06b6d4, #0891b2)":"transparent",color:d==="sql"?"white":"var(--text-muted)"},children:[e.jsx(ue,{size:18}),"SQL Problems",e.jsx("span",{style:{background:d==="sql"?"rgba(255,255,255,0.2)":"var(--bg-dark)",padding:"2px 8px",borderRadius:"12px",fontSize:"0.75rem"},children:ce.length})]})]}),e.jsxs("div",{className:"card glass",children:[e.jsxs("h3",{style:{display:"flex",alignItems:"center",gap:"8px",marginBottom:"24px"},children:[e.jsx(de,{size:20,style:{color:"#f59e0b"}})," Problem Leaderboard"]}),e.jsx("div",{className:"table-container",style:{border:"none"},children:e.jsxs("table",{children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Problem Title"}),e.jsx("th",{children:"Type"}),e.jsx("th",{children:"Language"}),e.jsx("th",{children:"Difficulty"}),e.jsx("th",{children:"Attempts"}),e.jsx("th",{children:"Created"}),e.jsx("th",{children:"Completion"}),e.jsx("th",{children:"Status"}),e.jsx("th",{children:"Actions"})]})}),e.jsx("tbody",{children:fe.length===0?e.jsx("tr",{children:e.jsxs("td",{colSpan:"7",style:{textAlign:"center",padding:"2rem",color:"var(--text-muted)"},children:["No ",d==="sql"?"SQL":"coding"," problems found. Create one to get started!"]})}):fe.map(t=>e.jsxs("tr",{children:[e.jsx("td",{style:{fontWeight:600},children:e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[t.title,t.proctoring?.enabled&&e.jsxs("span",{style:{fontSize:"0.6rem",padding:"2px 6px",borderRadius:"4px",background:"rgba(239, 68, 68, 0.15)",color:"#ef4444",fontWeight:700,display:"flex",alignItems:"center",gap:"3px"},children:[e.jsx(ne,{size:10})," Proctored"]})]})}),e.jsx("td",{children:e.jsx("span",{style:{fontSize:"0.75rem",padding:"2px 8px",borderRadius:"4px",background:"rgba(59, 130, 246, 0.1)",color:"#3b82f6"},children:t.type?.toUpperCase()})}),e.jsx("td",{children:e.jsx("span",{style:{fontWeight:500},children:t.language})}),e.jsx("td",{children:e.jsx("span",{className:`difficulty-badge ${t.difficulty?.toLowerCase()}`,children:t.difficulty})}),e.jsxs("td",{style:{fontSize:"0.85rem",color:(t.maxAttempts||t.max_attempts)>0?"#8b5cf6":"var(--text-muted)",cursor:"pointer"},onClick:()=>{const w=prompt("Set max attempts (0 = unlimited):",t.maxAttempts||t.max_attempts||0);w!==null&&E(t.id,parseInt(w)||0)},title:"Click to edit max attempts",children:[(t.maxAttempts||t.max_attempts)>0?`${t.maxAttempts||t.max_attempts}`:"âˆž"," âœï¸"]}),e.jsx("td",{style:{fontSize:"0.85rem",color:"var(--text-muted)"},children:new Date(t.createdAt).toLocaleDateString()}),e.jsx("td",{children:e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[e.jsx("div",{style:{width:"80px",height:"6px",background:"var(--border-color)",borderRadius:"3px",overflow:"hidden"},children:e.jsx("div",{style:{width:`${C.length>0?(t.completedBy?.length||0)/C.length*100:0}%`,height:"100%",background:"linear-gradient(90deg, #3b82f6, #8b5cf6)"}})}),e.jsxs("span",{style:{fontSize:"0.8rem",color:"var(--text-muted)"},children:[t.completedBy?.length||0,"/",C.length]})]})}),e.jsx("td",{children:e.jsx("span",{className:`status-badge ${t.status}`,children:t.status})}),e.jsx("td",{children:e.jsxs("div",{style:{display:"flex",gap:"0.5rem"},children:[e.jsxs("button",{onClick:()=>y(t),disabled:t.language==="SQL"||t.type==="SQL",style:{background:t.language==="SQL"||t.type==="SQL"?"rgba(100, 116, 139, 0.1)":"rgba(16, 185, 129, 0.1)",border:"none",color:t.language==="SQL"||t.type==="SQL"?"#64748b":"#10b981",padding:"0.4rem 0.75rem",borderRadius:"6px",cursor:t.language==="SQL"||t.type==="SQL"?"not-allowed":"pointer",fontSize:"0.8rem",display:"flex",alignItems:"center",gap:"4px",opacity:t.language==="SQL"||t.type==="SQL"?.5:1},title:t.language==="SQL"||t.type==="SQL"?"Test cases not available for SQL problems":"Manage Test Cases",children:[e.jsx(Ie,{size:14})," Tests"]}),e.jsxs("button",{onClick:()=>l(t.id),className:"btn-create-new",style:{padding:"0.4rem 0.8rem",fontSize:"0.75rem",background:"rgba(139, 92, 246, 0.1)",color:"#8b5cf6",border:"1px solid rgba(139, 92, 246, 0.2)",display:"flex",alignItems:"center",gap:"0.3rem"},children:[e.jsx(K,{size:14})," Assign"]}),e.jsx("button",{onClick:()=>H(t.id),disabled:!Z(t),style:{background:Z(t)?"rgba(239, 68, 68, 0.1)":"rgba(148, 163, 184, 0.1)",border:"none",color:Z(t)?"#ef4444":"#64748b",padding:"0.4rem 0.75rem",borderRadius:"6px",cursor:Z(t)?"pointer":"not-allowed",fontSize:"0.8rem"},title:Z(t)?"Delete problem":"Cannot delete while students are in progress",children:e.jsx(Te,{size:14})})]})})]},t.id))})]})})]}),_&&e.jsx("div",{className:"modal-overlay",onClick:()=>{m(!1),f("")},children:e.jsxs("div",{className:"modal-content",onClick:t=>t.stopPropagation(),style:{width:"90%",maxWidth:"950px",maxHeight:"90vh",overflow:"hidden",display:"flex",flexDirection:"column",boxShadow:"0 20px 60px rgba(0, 0, 0, 0.3)"},children:[e.jsxs("div",{className:"modal-header",style:{padding:"2rem 1.5rem",borderBottom:"2px solid var(--border-color)",background:"linear-gradient(135deg, rgba(59, 130, 246, 0.05), rgba(139, 92, 246, 0.05))",flexShrink:0},children:[e.jsxs("div",{className:"modal-title-with-icon",style:{display:"flex",alignItems:"flex-start",gap:"1rem"},children:[e.jsx("div",{style:{width:"50px",height:"50px",borderRadius:"12px",background:"linear-gradient(135deg, #3b82f6, #8b5cf6)",display:"flex",alignItems:"center",justifyContent:"center",flexShrink:0,boxShadow:"0 8px 16px rgba(59, 130, 246, 0.3)"},children:e.jsx(K,{size:24,color:"white"})}),e.jsxs("div",{style:{textAlign:"left",flex:1},children:[e.jsx("h3",{style:{margin:0,fontSize:"1.5rem",fontWeight:700,color:"var(--text-main)"},children:"Assign Students"}),e.jsx("p",{style:{margin:"0.5rem 0 0 0",fontSize:"0.9rem",color:"var(--text-muted)"},children:"Select students to complete this problem"})]})]}),e.jsx("button",{onClick:()=>{m(!1),f("")},className:"modal-close",style:{position:"absolute",right:"1.5rem",top:"1.5rem"},children:e.jsx(oe,{size:22})})]}),e.jsxs("div",{style:{padding:"1.2rem 1.5rem",background:"var(--bg-secondary)",borderBottom:"1px solid var(--border-color)",display:"flex",gap:"0.8rem",alignItems:"center",flexShrink:0},children:[e.jsxs("div",{style:{position:"relative",flex:1},children:[e.jsx(be,{size:19,style:{position:"absolute",left:"12px",top:"50%",transform:"translateY(-50%)",color:"var(--primary)",fontWeight:500}}),e.jsx("input",{type:"text",placeholder:"Search students by name, email or batch...",value:O,onChange:t=>f(t.target.value),style:{width:"100%",padding:"0.8rem 1rem 0.8rem 2.8rem",borderRadius:"10px",background:"var(--bg-card)",border:"1.5px solid var(--border-color)",color:"var(--text-main)",fontSize:"0.95rem",transition:"all 0.2s",outline:"none"},onFocus:t=>t.target.style.borderColor="var(--primary)",onBlur:t=>t.target.style.borderColor="var(--border-color)"})]}),e.jsx("button",{onClick:()=>{const t=I.filter(D=>(D.name||D.username||"").toLowerCase().includes(O.toLowerCase())||(D.batch||"").toLowerCase().includes(O.toLowerCase())),w=t.every(D=>W.includes(D.id));P(w?D=>D.filter(ee=>!t.map(ye=>ye.id).includes(ee)):D=>[...new Set([...D,...t.map(ee=>ee.id)])])},style:{padding:"0.8rem 1.4rem",borderRadius:"10px",background:"var(--bg-card)",border:"1.5px solid var(--primary)",color:"var(--primary)",fontSize:"0.9rem",fontWeight:700,cursor:"pointer",whiteSpace:"nowrap",transition:"all 0.2s"},onMouseEnter:t=>{t.target.style.background="var(--primary)",t.target.style.color="white"},onMouseLeave:t=>{t.target.style.background="var(--bg-card)",t.target.style.color="var(--primary)"},children:I.filter(t=>(t.name||t.username||"").toLowerCase().includes(O.toLowerCase())||(t.batch||"").toLowerCase().includes(O.toLowerCase())).every(t=>W.includes(t.id))?"âœ“ Deselect All":"+ Select All"})]}),e.jsx("div",{style:{flex:1,overflowY:"auto",padding:"1.5rem",background:"var(--bg-primary)",minHeight:0},children:e.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(300px, 1fr))",gap:"1.2rem"},children:I.filter(t=>(t.name||t.username||"").toLowerCase().includes(O.toLowerCase())||(t.batch||"").toLowerCase().includes(O.toLowerCase())).length===0?e.jsxs("div",{style:{gridColumn:"1 / -1",textAlign:"center",padding:"4rem 2rem",opacity:.6},children:[e.jsx("div",{style:{fontSize:"3rem",marginBottom:"1rem"},children:"ðŸ”"}),e.jsx("p",{style:{fontSize:"1rem",color:"var(--text-muted)",margin:0},children:"No students found"}),e.jsx("p",{style:{fontSize:"0.85rem",color:"var(--text-muted)",margin:"0.5rem 0 0 0"},children:"Try adjusting your search criteria"})]}):I.filter(t=>(t.name||t.username||"").toLowerCase().includes(O.toLowerCase())||(t.batch||"").toLowerCase().includes(O.toLowerCase())).map(t=>e.jsxs("div",{onClick:()=>u(t.id),style:{padding:"1.2rem",borderRadius:"12px",background:W.includes(t.id)?"linear-gradient(135deg, var(--primary-alpha), rgba(139, 92, 246, 0.08))":"var(--bg-card)",border:`2px solid ${W.includes(t.id)?"var(--primary)":"var(--border-color)"}`,cursor:"pointer",display:"flex",alignItems:"center",gap:"1rem",transition:"all 0.25s ease",boxShadow:W.includes(t.id)?"0 8px 20px rgba(59, 130, 246, 0.15)":"0 2px 8px rgba(0, 0, 0, 0.05)",textAlign:"left",position:"relative",overflow:"hidden"},onMouseEnter:w=>{W.includes(t.id)||(w.currentTarget.style.borderColor="var(--primary)",w.currentTarget.style.background="var(--bg-secondary)")},onMouseLeave:w=>{W.includes(t.id)||(w.currentTarget.style.borderColor="var(--border-color)",w.currentTarget.style.background="var(--bg-card)")},children:[W.includes(t.id)&&e.jsx("div",{style:{position:"absolute",left:0,top:0,width:"4px",height:"100%",background:"linear-gradient(180deg, var(--primary), #6366f1)"}}),e.jsx("div",{style:{width:"48px",height:"48px",borderRadius:"10px",background:W.includes(t.id)?"linear-gradient(135deg, var(--primary), #6366f1)":"linear-gradient(135deg, #8b5cf6, #3b82f6)",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"1.2rem",fontWeight:700,color:"white",flexShrink:0,boxShadow:"0 4px 12px rgba(59, 130, 246, 0.2)"},children:(t.name||t.username||"S").charAt(0).toUpperCase()}),e.jsxs("div",{style:{flex:1,minWidth:0},children:[e.jsx("div",{style:{fontWeight:700,fontSize:"1rem",color:"var(--text-main)",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",marginBottom:"0.3rem"},children:t.name||t.username}),e.jsxs("div",{style:{fontSize:"0.8rem",color:"var(--text-muted)",display:"flex",alignItems:"center",gap:"0.5rem",marginBottom:"0.4rem"},children:[e.jsx("span",{style:{opacity:.7},children:"ðŸ“§"}),e.jsx("span",{style:{whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},children:t.email||"N/A"})]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem",flexWrap:"wrap"},children:[e.jsxs("span",{style:{padding:"3px 8px",borderRadius:"6px",background:"var(--bg-secondary)",border:"1px solid var(--border-color)",fontSize:"0.75rem",fontWeight:600,color:"var(--text-muted)"},children:["ðŸ¢ ",t.batch||"No Batch"]}),t.status&&e.jsx("span",{style:{padding:"3px 8px",borderRadius:"6px",background:t.status==="active"?"rgba(16, 185, 129, 0.1)":"rgba(239, 68, 68, 0.1)",color:t.status==="active"?"#10b981":"#ef4444",fontSize:"0.75rem",fontWeight:600},children:t.status==="active"?"ðŸŸ¢ Active":"ðŸ”´ Inactive"})]})]}),W.includes(t.id)&&e.jsx("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",w:"24px"},children:e.jsx(J,{size:22,color:"var(--primary)",strokeWidth:2.5})})]},t.id))})}),e.jsxs("div",{className:"modal-footer",style:{padding:"1.5rem",borderTop:"2px solid var(--border-color)",display:"flex",justifyContent:"space-between",alignItems:"center",background:"var(--bg-secondary)",flexWrap:"wrap",gap:"1rem",flexShrink:0},children:[e.jsxs("div",{style:{fontSize:"1rem",color:"var(--text-main)",fontWeight:600},children:[e.jsx("span",{style:{color:"var(--primary)",fontWeight:900,fontSize:"1.3rem"},children:W.length}),e.jsxs("span",{style:{marginLeft:"0.5rem",color:"var(--text-muted)"},children:["student",W.length!==1?"s":""," selected"]})]}),e.jsxs("div",{style:{display:"flex",gap:"1rem",flexWrap:"wrap"},children:[e.jsx("button",{className:"btn-reset",onClick:()=>{m(!1),f("")},style:{padding:"0.8rem 2rem",fontSize:"0.95rem",fontWeight:600},children:"Cancel"}),e.jsx("button",{className:"btn-create-new",onClick:$,style:{background:"linear-gradient(135deg, var(--primary), #6366f1)",padding:"0.8rem 2.5rem",borderRadius:"10px",fontSize:"0.95rem",fontWeight:700,border:"none",color:"white",boxShadow:"0 6px 20px rgba(59, 130, 246, 0.35)",cursor:"pointer",transition:"all 0.3s"},onMouseEnter:t=>{t.target.style.boxShadow="0 10px 30px rgba(59, 130, 246, 0.5)",t.target.style.transform="translateY(-2px)"},onMouseLeave:t=>{t.target.style.boxShadow="0 6px 20px rgba(59, 130, 246, 0.35)",t.target.style.transform="translateY(0)"},children:"âœ“ Confirm Assignment"})]})]})]})}),S&&e.jsx("div",{className:"modal-overlay",onClick:()=>N(!1),children:e.jsxs("div",{className:"modal-content",onClick:t=>t.stopPropagation(),children:[e.jsxs("div",{className:"modal-header",children:[e.jsxs("div",{className:"modal-title-with-icon",children:[e.jsx("div",{style:{width:"40px",height:"40px",borderRadius:"10px",background:"linear-gradient(135deg, #3b82f6, #8b5cf6)",display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsx(ke,{size:20,color:"white"})}),e.jsx("h2",{children:"Create New Problem"})]}),e.jsx("button",{onClick:()=>N(!1),className:"modal-close",children:e.jsx(oe,{size:20})})]}),e.jsx("div",{className:"modal-body premium-form",children:e.jsxs("form",{onSubmit:ie,children:[e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1.5fr 1fr",gap:"1.5rem",marginBottom:"1.5rem"},children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Problem Title"}),e.jsx("input",{type:"text",placeholder:"Enter problem title",value:a.title,onChange:t=>h({...a,title:t.target.value}),required:!0})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Problem Type"}),e.jsxs("select",{value:a.type,onChange:t=>{const w=t.target.value;h({...a,type:w,language:w==="SQL"?"SQL":a.language==="SQL"?"Python":a.language})},children:[e.jsx("option",{value:"Coding",children:"Coding"}),e.jsx("option",{value:"SQL",children:"SQL"}),e.jsx("option",{value:"Algorithm",children:"Algorithm"})]})]})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr 1fr",gap:"1.5rem",marginBottom:"1.5rem"},children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Language"}),e.jsxs("select",{value:a.language,onChange:t=>{const w=t.target.value;h({...a,language:w,type:w==="SQL"?"SQL":a.type==="SQL"?"Coding":a.type})},children:[e.jsx("option",{value:"Python",children:"Python"}),e.jsx("option",{value:"JavaScript",children:"JavaScript"}),e.jsx("option",{value:"Java",children:"Java"}),e.jsx("option",{value:"C",children:"C"}),e.jsx("option",{value:"C++",children:"C++"}),e.jsx("option",{value:"SQL",children:"SQL"})]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Difficulty"}),e.jsxs("select",{value:a.difficulty,onChange:t=>h({...a,difficulty:t.target.value}),children:[e.jsx("option",{value:"Easy",children:"Easy"}),e.jsx("option",{value:"Medium",children:"Medium"}),e.jsx("option",{value:"Hard",children:"Hard"})]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Status"}),e.jsxs("select",{value:a.status,onChange:t=>h({...a,status:t.target.value}),children:[e.jsx("option",{value:"live",children:"Live"}),e.jsx("option",{value:"draft",children:"Draft"}),e.jsx("option",{value:"closed",children:"Closed"})]})]})]}),e.jsxs("div",{className:"form-group",style:{marginBottom:"1.5rem"},children:[e.jsx("label",{className:"form-label",children:"Problem Description"}),e.jsx("textarea",{rows:"5",placeholder:"Describe the problem...",value:a.description,onChange:t=>h({...a,description:t.target.value}),required:!0})]}),B?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"form-group",style:{marginBottom:"1.5rem"},children:[e.jsxs("label",{className:"form-label",style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[e.jsx(X,{size:14,color:"#06b6d4"})," Database Schema (CREATE TABLE statements)"]}),e.jsx("textarea",{rows:"6",placeholder:`CREATE TABLE employees (
  id INT PRIMARY KEY,
  name VARCHAR(100),
  department VARCHAR(50),
  salary DECIMAL(10,2)
);

INSERT INTO employees VALUES (1, 'John', 'IT', 50000);`,value:a.sqlSchema,onChange:t=>h({...a,sqlSchema:t.target.value}),style:{fontFamily:"monospace",fontSize:"0.85rem"}}),e.jsx("small",{style:{color:"var(--text-muted)",fontSize:"0.75rem"},children:"Include CREATE TABLE and INSERT statements to set up the test database"})]}),e.jsxs("div",{className:"form-group",style:{marginBottom:"1.5rem"},children:[e.jsxs("label",{className:"form-label",style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[e.jsx(J,{size:14,color:"#10b981"})," Expected Query Result"]}),e.jsx("textarea",{rows:"4",placeholder:`id | name | salary
1  | John | 50000
2  | Jane | 60000`,value:a.expectedQueryResult,onChange:t=>h({...a,expectedQueryResult:t.target.value}),style:{fontFamily:"monospace",fontSize:"0.85rem"}}),e.jsx("small",{style:{color:"var(--text-muted)",fontSize:"0.75rem"},children:"The expected output when the correct SQL query is executed"})]})]}):e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"1.5rem",marginBottom:"1.5rem"},children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Sample Input"}),e.jsx("input",{type:"text",placeholder:"e.g., [1, 2, 3]",value:a.testInput,onChange:t=>h({...a,testInput:t.target.value})})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Expected Output"}),e.jsx("input",{type:"text",placeholder:"e.g., 6",value:a.expectedOutput,onChange:t=>h({...a,expectedOutput:t.target.value})})]})]}),e.jsxs("div",{className:"form-group",style:{marginBottom:"1.5rem"},children:[e.jsx("label",{className:"form-label",children:"Deadline (Optional)"}),e.jsx("input",{type:"date",value:a.deadline,onChange:t=>h({...a,deadline:t.target.value})})]}),e.jsxs("div",{className:"form-group",style:{marginBottom:"1.5rem"},children:[e.jsx("label",{className:"form-label",children:"Max Attempts (0 = Unlimited)"}),e.jsx("input",{type:"number",min:"0",max:"100",value:a.maxAttempts,onChange:t=>h({...a,maxAttempts:parseInt(t.target.value)||0}),placeholder:"0 = unlimited attempts"}),e.jsx("small",{style:{color:"var(--text-muted)",fontSize:"0.75rem",marginTop:"0.25rem",display:"block"},children:"Set how many times a student can submit. 0 means unlimited."})]}),e.jsxs("div",{style:{padding:"1.25rem",background:"rgba(139, 92, 246, 0.05)",borderRadius:"12px",border:"1px solid rgba(139, 92, 246, 0.2)",marginBottom:"1.5rem"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem",marginBottom:"1rem"},children:[e.jsx(ne,{size:18,color:"#8b5cf6"}),e.jsx("span",{style:{fontWeight:600,color:"#8b5cf6"},children:"Proctoring Settings"})]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.75rem",marginBottom:"0.75rem"},children:[e.jsx("input",{type:"checkbox",id:"enableProctoring",checked:a.enableProctoring,onChange:t=>h({...a,enableProctoring:t.target.checked}),style:{width:"18px",height:"18px",accentColor:"#8b5cf6"}}),e.jsx("label",{htmlFor:"enableProctoring",style:{cursor:"pointer",fontSize:"0.9rem"},children:"Enable Proctoring Mode"})]}),a.enableProctoring&&e.jsxs("div",{style:{marginLeft:"1.5rem",display:"flex",flexDirection:"column",gap:"0.75rem"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.75rem"},children:[e.jsx("input",{type:"checkbox",id:"enableVideoAudio",checked:a.enableVideoAudio,onChange:t=>h({...a,enableVideoAudio:t.target.checked}),style:{width:"16px",height:"16px",accentColor:"#8b5cf6"}}),e.jsx("label",{htmlFor:"enableVideoAudio",style:{cursor:"pointer",fontSize:"0.85rem",color:"var(--text-muted)"},children:"ðŸ“¹ Enable Video & Audio Monitoring"})]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.75rem"},children:[e.jsx("input",{type:"checkbox",id:"disableCopyPaste",checked:a.disableCopyPaste,onChange:t=>h({...a,disableCopyPaste:t.target.checked}),style:{width:"16px",height:"16px",accentColor:"#8b5cf6"}}),e.jsx("label",{htmlFor:"disableCopyPaste",style:{cursor:"pointer",fontSize:"0.85rem",color:"var(--text-muted)"},children:"ðŸš« Disable Copy/Paste"})]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.75rem"},children:[e.jsx("input",{type:"checkbox",id:"trackTabSwitches",checked:a.trackTabSwitches,onChange:t=>h({...a,trackTabSwitches:t.target.checked}),style:{width:"16px",height:"16px",accentColor:"#8b5cf6"}}),e.jsx("label",{htmlFor:"trackTabSwitches",style:{cursor:"pointer",fontSize:"0.85rem",color:"var(--text-muted)"},children:"ðŸ‘ï¸ Track Tab Switches"})]}),a.trackTabSwitches&&e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.75rem",marginLeft:"1.5rem"},children:[e.jsx("label",{style:{fontSize:"0.85rem",color:"var(--text-muted)"},children:"Max Tab Switches:"}),e.jsx("input",{type:"number",min:"1",max:"10",value:a.maxTabSwitches,onChange:t=>h({...a,maxTabSwitches:parseInt(t.target.value)||3}),style:{width:"60px",padding:"0.25rem 0.5rem",borderRadius:"6px",border:"1px solid var(--border-color)",background:"var(--bg-card)",color:"white",textAlign:"center"}})]}),e.jsxs("div",{style:{marginTop:"0.75rem",paddingTop:"0.75rem",borderTop:"1px solid rgba(139, 92, 246, 0.2)"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.75rem",marginBottom:"0.75rem"},children:[e.jsx("input",{type:"checkbox",id:"enableFaceDetection",checked:a.enableFaceDetection,onChange:t=>h({...a,enableFaceDetection:t.target.checked}),style:{width:"16px",height:"16px",accentColor:"#ec4899"}}),e.jsx("label",{htmlFor:"enableFaceDetection",style:{cursor:"pointer",fontSize:"0.85rem",color:"var(--text-muted)"},children:"ðŸ‘ï¸ Enable Face Detection"})]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.75rem",marginBottom:"0.75rem"},children:[e.jsx("input",{type:"checkbox",id:"detectMultipleFaces",checked:a.detectMultipleFaces,onChange:t=>h({...a,detectMultipleFaces:t.target.checked}),style:{width:"16px",height:"16px",accentColor:"#ef4444"}}),e.jsx("label",{htmlFor:"detectMultipleFaces",style:{cursor:"pointer",fontSize:"0.85rem",color:"var(--text-muted)"},children:"ðŸ‘¥ Detect Multiple Faces (Cheating)"})]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.75rem"},children:[e.jsx("input",{type:"checkbox",id:"trackFaceLookaway",checked:a.trackFaceLookaway,onChange:t=>h({...a,trackFaceLookaway:t.target.checked}),style:{width:"16px",height:"16px",accentColor:"#3b82f6"}}),e.jsx("label",{htmlFor:"trackFaceLookaway",style:{cursor:"pointer",fontSize:"0.85rem",color:"var(--text-muted)"},children:"ðŸ‘€ Track Face Lookaway"})]})]})]})]}),e.jsxs("div",{className:"form-actions",children:[e.jsx("button",{type:"button",className:"btn-reset",onClick:()=>N(!1),children:"Cancel"}),e.jsxs("button",{type:"submit",className:"btn-create-new",children:[e.jsx(ze,{size:16})," Create Problem"]})]})]})})]})}),e.jsx(Ee,{context:"problem",isOpen:k,onClose:()=>o(!1),onGenerate:M}),i&&e.jsx(ot,{problemId:i.id,problemTitle:i.title,onClose:()=>y(null)})]})}function Dt({user:s}){const[r,T]=n.useState([]),[C,g]=n.useState(!0),[L,p]=n.useState(null);if(n.useEffect(()=>{z.get(`${R}/leaderboard?mentorId=${s.id}`).then(o=>{T(o.data),g(!1)}).catch(o=>g(!1))},[s.id]),C)return e.jsx("div",{className:"loading-spinner"});const S=o=>o===1?{color:"#fbbf24",transform:"scale(1.2)"}:o===2?{color:"#94a3b8",transform:"scale(1.1)"}:o===3?{color:"#b45309",transform:"scale(1.1)"}:{color:"var(--text-muted)"},N=o=>o===1?e.jsx(de,{size:24,fill:"#fbbf24",color:"#d97706"}):o===2?e.jsx(Be,{size:24,fill:"#e2e8f0",color:"#64748b"}):o===3?e.jsx(Be,{size:24,fill:"#fbbf24",color:"#b45309"}):e.jsxs("span",{style:{fontWeight:600,fontSize:"1.1rem",width:"24px",textAlign:"center",display:"inline-block"},children:["#",o]}),k=o=>o.violations?(o.violations.tabSwitches||0)+(o.violations.copyPaste||0)+(o.violations.cameraBlocked||0)+(o.violations.phoneDetection||0)+(o.violations.integrityViolations||0)+(o.violations.plagiarism||0):0;return e.jsxs("div",{className:"card animate-slideUp glass",style:{padding:"0 0 1rem 0",overflow:"hidden"},children:[e.jsxs("div",{style:{padding:"2rem 2rem 1rem",display:"flex",alignItems:"center",gap:"1rem"},children:[e.jsx(de,{size:28,className:"text-primary"}),e.jsxs("div",{children:[e.jsx("h3",{style:{margin:0,fontSize:"1.5rem"},children:"Student Leaderboard"}),e.jsx("p",{style:{margin:"4px 0 0",color:"var(--text-muted)",fontSize:"0.9rem"},children:"Rankings based on scores"})]})]}),e.jsx("div",{className:"table-container",style:{border:"none",borderRadius:0},children:e.jsxs("table",{style:{borderCollapse:"separate",borderSpacing:"0 8px",padding:"0 1rem"},children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{style:{paddingLeft:"2rem"},children:"Rank"}),e.jsx("th",{children:"Student"}),e.jsx("th",{children:"Total Score"}),e.jsx("th",{children:"Submissions"}),e.jsx("th",{children:"Violations"}),e.jsx("th",{style:{textAlign:"center"},children:"Status"}),e.jsx("th",{children:"Actions"})]})}),e.jsx("tbody",{children:r.map((o,d)=>{const A=k(o)>0||o.violations?.plagiarism>0;return e.jsxs("tr",{className:"leaderboard-row",style:{backgroundColor:d<3?"var(--bg-dark)":"transparent",transition:"transform 0.2s"},children:[e.jsx("td",{style:{paddingLeft:"2rem"},children:e.jsx("div",{style:{display:"flex",alignItems:"center",gap:"1rem",...S(d+1)},children:N(d+1)})}),e.jsx("td",{children:e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"1rem"},children:[e.jsx("div",{className:"avatar-circle",children:o.name.charAt(0).toUpperCase()}),e.jsx("div",{children:e.jsx("div",{style:{fontWeight:600,fontSize:"1rem"},children:o.name})})]})}),e.jsx("td",{children:e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem",fontWeight:700,fontSize:"1.1rem",color:"var(--primary)"},children:[o.avgScore," ",e.jsx("span",{style:{fontSize:"0.8rem",color:"var(--text-muted)",fontWeight:400},children:"pts"})]})}),e.jsx("td",{children:e.jsxs("div",{className:"status-badge live",style:{width:"fit-content"},children:[o.acceptedSubmissions||o.totalSubmissions," Submitted"]})}),e.jsx("td",{children:e.jsxs("div",{style:{display:"flex",gap:"0.5rem",flexWrap:"wrap"},children:[o.violations?.tabSwitches>0&&e.jsxs("span",{style:{fontSize:"0.65rem",padding:"2px 6px",borderRadius:"4px",background:"rgba(245, 158, 11, 0.15)",color:"#f59e0b",display:"flex",alignItems:"center",gap:"3px"},title:"Tab Switches",children:[e.jsx(ne,{size:10})," ",o.violations.tabSwitches]}),o.violations?.cameraBlocked>0&&e.jsxs("span",{style:{fontSize:"0.65rem",padding:"2px 6px",borderRadius:"4px",background:"rgba(239, 68, 68, 0.15)",color:"#ef4444",display:"flex",alignItems:"center",gap:"3px"},title:"Camera Blocked",children:["ðŸ“· ",o.violations.cameraBlocked]}),o.violations?.phoneDetection>0&&e.jsxs("span",{style:{fontSize:"0.65rem",padding:"2px 6px",borderRadius:"4px",background:"rgba(239, 68, 68, 0.15)",color:"#ef4444",display:"flex",alignItems:"center",gap:"3px"},title:"Phone Detected",children:["ðŸ“± ",o.violations.phoneDetection]}),o.violations?.copyPaste>0&&e.jsxs("span",{style:{fontSize:"0.65rem",padding:"2px 6px",borderRadius:"4px",background:"rgba(245, 158, 11, 0.15)",color:"#f59e0b",display:"flex",alignItems:"center",gap:"3px"},title:"Copy/Paste",children:["ðŸ“‹ ",o.violations.copyPaste]}),o.violations?.plagiarism>0&&e.jsxs("span",{style:{fontSize:"0.65rem",padding:"2px 6px",borderRadius:"4px",background:"rgba(239, 68, 68, 0.15)",color:"#ef4444",display:"flex",alignItems:"center",gap:"3px"},title:"Plagiarism",children:[e.jsx(te,{size:10})," ",o.violations.plagiarism]}),!A&&e.jsx("span",{style:{color:"#10b981"},children:e.jsx(J,{size:14})})]})}),e.jsx("td",{style:{textAlign:"center"},children:e.jsx("div",{style:{width:"100px",height:"6px",backgroundColor:"var(--border-color)",borderRadius:"10px",margin:"0 auto",overflow:"hidden"},children:e.jsx("div",{style:{width:`${Math.min(o.avgScore,100)}%`,height:"100%",backgroundColor:A?"#f59e0b":d===0?"#fbbf24":"var(--primary)"}})})}),e.jsx("td",{children:e.jsxs("button",{onClick:()=>p({id:o.studentId,name:o.name}),style:{display:"flex",alignItems:"center",gap:"0.4rem",padding:"0.5rem 0.85rem",background:"linear-gradient(135deg, #8b5cf6, #7c3aed)",border:"none",borderRadius:"8px",color:"white",fontSize:"0.75rem",fontWeight:600,cursor:"pointer",transition:"all 0.2s ease",boxShadow:"0 2px 8px rgba(139, 92, 246, 0.3)"},title:"Generate comprehensive report",children:[e.jsx(ue,{size:14}),"Report"]})})]},o.studentId)})})]})}),L&&e.jsx(dt,{studentId:L.id,studentName:L.name,onClose:()=>p(null),requestedBy:s?.name||"Mentor",requestedByRole:"mentor"})]})}function Pt({user:s}){const[r,T]=n.useState([]),[C,g]=n.useState([]),[L,p]=n.useState([]),[S,N]=n.useState(!0),[k,o]=n.useState(null),[d,b]=n.useState("all"),[A,c]=n.useState(null),[v,i]=n.useState(null),[y,a]=n.useState(""),h=()=>{Promise.all([z.get(`${R}/submissions?mentorId=${s.id}`),z.get(`${R}/aptitude-submissions?mentorId=${s.id}`),z.get(`${R}/global-test-submissions?mentorId=${s.id}`)]).then(([x,W,P])=>{const ae=Array.isArray(x.data)?x.data:x.data?.data||[];T(ae.map(F=>({...F,subType:"code"}))),g((W.data||[]).map(F=>({...F,subType:"aptitude",itemTitle:F.testTitle}))),p((P.data||[]).map(F=>({...F,subType:"global",itemTitle:F.testTitle,score:F.overallPercentage}))),N(!1)}).catch(x=>N(!1))};n.useEffect(()=>{h()},[s.id]);const _=[...r,...C,...L].sort((x,W)=>new Date(W.submittedAt)-new Date(x.submittedAt)),I=(d==="all"?_:d==="code"?r:d==="aptitude"?C:L).filter(W=>(W.studentName||"").toLowerCase().includes(y.toLowerCase())||(W.itemTitle||W.testTitle||"").toLowerCase().includes(y.toLowerCase())||W.status.toLowerCase().includes(y.toLowerCase()));return S?e.jsx("div",{className:"loading-spinner"}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-end",marginBottom:"1.5rem"},children:[e.jsxs("div",{style:{display:"flex",gap:"0.5rem"},children:[e.jsxs("button",{onClick:()=>b("all"),style:{padding:"0.6rem 1.2rem",background:d==="all"?"var(--primary)":"rgba(59, 130, 246, 0.1)",border:d==="all"?"none":"1px solid var(--border-color)",borderRadius:"8px",color:d==="all"?"white":"var(--text-muted)",cursor:"pointer",fontWeight:500},children:["All (",_.length,")"]}),e.jsxs("button",{onClick:()=>b("code"),style:{padding:"0.6rem 1.2rem",background:d==="code"?"var(--primary)":"rgba(59, 130, 246, 0.1)",border:d==="code"?"none":"1px solid var(--border-color)",borderRadius:"8px",color:d==="code"?"white":"var(--text-muted)",cursor:"pointer",fontWeight:500},children:["ðŸ’» Code (",r.length,")"]}),e.jsxs("button",{onClick:()=>b("aptitude"),style:{padding:"0.6rem 1.2rem",background:d==="aptitude"?"#8b5cf6":"rgba(139, 92, 246, 0.1)",border:d==="aptitude"?"none":"1px solid var(--border-color)",borderRadius:"8px",color:d==="aptitude"?"white":"var(--text-muted)",cursor:"pointer",fontWeight:500},children:["ðŸ“ Aptitude (",C.length,")"]}),e.jsxs("button",{onClick:()=>b("global"),style:{padding:"0.6rem 1.2rem",background:d==="global"?"#3b82f6":"rgba(59, 130, 246, 0.1)",border:d==="global"?"none":"1px solid var(--border-color)",borderRadius:"8px",color:d==="global"?"white":"var(--text-muted)",cursor:"pointer",fontWeight:500},children:["ðŸŒ Global (",L.length,")"]})]}),e.jsxs("div",{style:{position:"relative"},children:[e.jsx(be,{size:18,style:{position:"absolute",left:"12px",top:"50%",transform:"translateY(-50%)",color:"var(--text-muted)"}}),e.jsx("input",{type:"text",placeholder:"Search student, problem or status...",style:{padding:"0.6rem 1rem 0.6rem 2.5rem",background:"var(--bg-card)",border:"1px solid var(--border-color)",borderRadius:"8px",color:"white",width:"280px"},value:y,onChange:x=>a(x.target.value)})]})]}),e.jsx("div",{className:"table-container card glass",children:e.jsxs("table",{children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Student"}),e.jsx("th",{children:"Type"}),e.jsx("th",{children:"Problem / Test"}),e.jsx("th",{children:"Language"}),e.jsx("th",{children:"Score"}),e.jsx("th",{children:"Status"}),e.jsx("th",{children:"Submitted At"}),e.jsx("th",{children:"Actions"})]})}),e.jsx("tbody",{children:I.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:"8",style:{textAlign:"center",padding:"3rem"},children:"No submissions found"})}):I.map(x=>e.jsxs("tr",{children:[e.jsx("td",{children:e.jsx("div",{style:{fontWeight:600},children:x.studentName})}),e.jsx("td",{children:e.jsx("span",{style:{fontSize:"0.75rem",padding:"2px 8px",borderRadius:"4px",background:x.subType==="aptitude"?"rgba(139, 92, 246, 0.1)":"rgba(59, 130, 246, 0.1)",color:x.subType==="aptitude"?"#8b5cf6":"#3b82f6"},children:x.subType==="aptitude"?"ðŸ“ Aptitude":x.subType==="global"?"ðŸŒ Global":"ðŸ’» Code"})}),e.jsx("td",{children:e.jsx("div",{style:{color:"var(--primary)",fontWeight:500},children:x.itemTitle||x.testTitle})}),e.jsx("td",{children:e.jsx("span",{style:{fontSize:"0.75rem",padding:"2px 8px",borderRadius:"4px",background:"rgba(59, 130, 246, 0.1)",color:"var(--primary)"},children:x.subType==="aptitude"?"N/A":x.subType==="global"?"Mixed":x.language?.toUpperCase()||"N/A"})}),e.jsxs("td",{style:{fontWeight:700,fontSize:"1.1rem"},children:[x.score,"%"]}),e.jsx("td",{children:e.jsxs("div",{style:{display:"flex",flexWrap:"wrap",gap:"0.25rem",alignItems:"center"},children:[e.jsx("span",{className:`status-badge ${x.status}`,children:x.status}),x.plagiarism?.detected&&e.jsxs("span",{className:"status-badge plagiarized",style:{display:"flex",alignItems:"center",gap:"3px"},children:[e.jsx(te,{size:11})," Plag"]}),(x.integrity?.integrityViolation||x.tabSwitches>0)&&e.jsxs("span",{style:{fontSize:"0.65rem",padding:"2px 6px",borderRadius:"4px",background:"rgba(245, 158, 11, 0.15)",color:"#f59e0b",border:"1px solid rgba(245, 158, 11, 0.3)",display:"flex",alignItems:"center",gap:"3px"},children:[e.jsx(te,{size:10})," ",x.integrity?.tabSwitches||x.tabSwitches||0," Tab"]}),x.cameraBlockedCount>0&&e.jsxs("span",{style:{fontSize:"0.65rem",padding:"2px 6px",borderRadius:"4px",background:"rgba(239, 68, 68, 0.15)",color:"#ef4444",border:"1px solid rgba(239, 68, 68, 0.3)",display:"flex",alignItems:"center",gap:"3px"},children:["ðŸ“· ",x.cameraBlockedCount," Cam"]}),x.phoneDetectionCount>0&&e.jsxs("span",{style:{fontSize:"0.65rem",padding:"2px 6px",borderRadius:"4px",background:"rgba(239, 68, 68, 0.15)",color:"#ef4444",border:"1px solid rgba(239, 68, 68, 0.3)",display:"flex",alignItems:"center",gap:"3px"},children:["ðŸ“± ",x.phoneDetectionCount," Phone"]})]})}),e.jsx("td",{style:{fontSize:"0.85rem",color:"var(--text-muted)"},children:new Date(x.submittedAt).toLocaleString()}),e.jsx("td",{children:x.subType==="aptitude"?e.jsxs("button",{onClick:()=>c(x),style:{background:"rgba(139, 92, 246, 0.1)",border:"none",color:"#8b5cf6",padding:"0.4rem 0.75rem",borderRadius:"6px",cursor:"pointer",fontSize:"0.8rem",display:"flex",alignItems:"center",gap:"4px"},children:[e.jsx(ne,{size:14})," Results"]}):x.subType==="global"?e.jsxs("button",{onClick:()=>i(x.id),style:{background:"rgba(59, 130, 246, 0.1)",border:"none",color:"#3b82f6",padding:"0.4rem 0.75rem",borderRadius:"6px",cursor:"pointer",fontSize:"0.8rem",display:"flex",alignItems:"center",gap:"4px"},children:[e.jsx(ne,{size:14})," Full Report"]}):e.jsxs("button",{onClick:()=>o(x),style:{background:"rgba(59, 130, 246, 0.1)",border:"none",color:"#3b82f6",padding:"0.4rem 0.75rem",borderRadius:"6px",cursor:"pointer",fontSize:"0.8rem",display:"flex",alignItems:"center",gap:"4px"},children:[e.jsx(ne,{size:14})," Report"]})})]},x.id))})]})}),k&&e.jsx(Et,{submission:k,onClose:()=>o(null)}),A&&e.jsx(it,{submission:A,onClose:()=>c(null)}),v&&e.jsx(lt,{submissionId:v,onClose:()=>i(null),isStudentView:!1})]})}function Et({submission:s,onClose:r}){return e.jsx("div",{className:"modal-overlay",onClick:r,children:e.jsxs("div",{className:"modal-content",onClick:T=>T.stopPropagation(),style:{maxWidth:"900px"},children:[e.jsxs("div",{className:"modal-header",children:[e.jsxs("div",{className:"modal-title-with-icon",children:[e.jsx("div",{style:{width:"40px",height:"40px",borderRadius:"10px",background:s.status==="accepted"?"linear-gradient(135deg, #10b981, #06b6d4)":"linear-gradient(135deg, #ef4444, #f59e0b)",display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsx(ue,{size:20,color:"white"})}),e.jsx("h2",{children:"Detailed Submission Report"})]}),e.jsx("button",{onClick:r,className:"modal-close",children:e.jsx(oe,{size:20})})]}),e.jsxs("div",{className:"modal-body",style:{maxHeight:"70vh",overflowY:"auto"},children:[e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(4, 1fr)",gap:"1rem",marginBottom:"2rem",padding:"1.5rem",background:"rgba(59, 130, 246, 0.05)",borderRadius:"1rem",border:"1px solid rgba(59, 130, 246, 0.1)"},children:[e.jsxs("div",{children:[e.jsx("span",{style:{color:"var(--text-muted)",fontSize:"0.8rem"},children:"Student Name"}),e.jsx("p",{style:{margin:"0.25rem 0 0",fontWeight:600,fontSize:"1.1rem"},children:s.studentName})]}),e.jsxs("div",{children:[e.jsx("span",{style:{color:"var(--text-muted)",fontSize:"0.8rem"},children:"Submitted At"}),e.jsx("p",{style:{margin:"0.25rem 0 0",fontWeight:600},children:new Date(s.submittedAt).toLocaleString()})]}),e.jsxs("div",{children:[e.jsx("span",{style:{color:"var(--text-muted)",fontSize:"0.8rem"},children:"Language"}),e.jsx("p",{style:{margin:"0.25rem 0 0",fontWeight:600},children:s.language})]}),e.jsxs("div",{children:[e.jsx("span",{style:{color:"var(--text-muted)",fontSize:"0.8rem"},children:"Submission Type"}),e.jsx("p",{style:{margin:"0.25rem 0 0",fontWeight:600},children:s.submissionType==="file"?"File Upload":"Code Editor"})]})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",gap:"3rem",marginBottom:"2rem",padding:"2rem",background:s.status==="accepted"?"rgba(16, 185, 129, 0.05)":"rgba(239, 68, 68, 0.05)",borderRadius:"1rem",border:`1px solid ${s.status==="accepted"?"rgba(16, 185, 129, 0.2)":"rgba(239, 68, 68, 0.2)"}`},children:[e.jsxs("div",{style:{textAlign:"center"},children:[e.jsx("div",{style:{fontSize:"3rem",fontWeight:800,color:s.status==="accepted"?"#10b981":"#ef4444"},children:s.score}),e.jsx("div",{style:{color:"var(--text-muted)"},children:"AI Evaluation Score"})]}),e.jsxs("div",{style:{padding:"1rem 2rem",borderRadius:"1rem",background:s.status==="accepted"?"rgba(16, 185, 129, 0.1)":"rgba(239, 68, 68, 0.1)",color:s.status==="accepted"?"#10b981":"#ef4444",fontWeight:700,fontSize:"1.25rem",display:"flex",alignItems:"center",gap:"0.5rem"},children:[s.status==="accepted"?e.jsx(J,{size:24}):e.jsx(oe,{size:24}),s.status?.toUpperCase()]})]}),s.plagiarism?.detected&&e.jsxs("div",{className:"plagiarism-banner",style:{marginBottom:"1.5rem"},children:[e.jsx(te,{size:24,color:"#ef4444"}),e.jsxs("div",{children:[e.jsx("strong",{style:{color:"#ef4444"},children:"Plagiarism Detected"}),e.jsxs("p",{style:{margin:"0.25rem 0 0",color:"var(--text-muted)"},children:["This code matches a submission from ",s.plagiarism.copiedFromName]})]})]}),(s.tabSwitches>0||s.copyPasteAttempts>0||s.cameraBlockedCount>0||s.phoneDetectionCount>0)&&e.jsxs("div",{style:{marginBottom:"1.5rem",padding:"1.5rem",background:"rgba(239, 68, 68, 0.05)",borderRadius:"1rem",border:"1px solid rgba(239, 68, 68, 0.2)"},children:[e.jsxs("h4",{style:{margin:"0 0 1rem",display:"flex",alignItems:"center",gap:"0.5rem",color:"#f59e0b"},children:[e.jsx(te,{size:18})," Proctoring Violations"]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(2, 1fr)",gap:"1rem"},children:[s.tabSwitches>0&&e.jsxs("div",{style:{padding:"0.75rem",background:"rgba(245, 158, 11, 0.1)",borderRadius:"0.5rem",display:"flex",alignItems:"center",gap:"0.75rem"},children:[e.jsx(ne,{size:18,color:"#f59e0b"}),e.jsxs("div",{children:[e.jsxs("div",{style:{fontWeight:600,color:"#f59e0b"},children:[s.tabSwitches," Tab Switches"]}),e.jsxs("div",{style:{fontSize:"0.75rem",color:"var(--text-muted)"},children:["Penalty: -",Math.min(s.tabSwitches*5,25)," pts"]})]})]}),s.copyPasteAttempts>0&&e.jsxs("div",{style:{padding:"0.75rem",background:"rgba(245, 158, 11, 0.1)",borderRadius:"0.5rem",display:"flex",alignItems:"center",gap:"0.75rem"},children:[e.jsx("span",{style:{fontSize:"1.1rem"},children:"ðŸ“‹"}),e.jsxs("div",{children:[e.jsxs("div",{style:{fontWeight:600,color:"#f59e0b"},children:[s.copyPasteAttempts," Copy/Paste"]}),e.jsxs("div",{style:{fontSize:"0.75rem",color:"var(--text-muted)"},children:["Penalty: -",Math.min(s.copyPasteAttempts*3,15)," pts"]})]})]}),s.cameraBlockedCount>0&&e.jsxs("div",{style:{padding:"0.75rem",background:"rgba(239, 68, 68, 0.1)",borderRadius:"0.5rem",display:"flex",alignItems:"center",gap:"0.75rem"},children:[e.jsx("span",{style:{fontSize:"1.1rem"},children:"ðŸ“·"}),e.jsxs("div",{children:[e.jsxs("div",{style:{fontWeight:600,color:"#ef4444"},children:[s.cameraBlockedCount," Camera Blocked"]}),e.jsxs("div",{style:{fontSize:"0.75rem",color:"var(--text-muted)"},children:["Penalty: -",Math.min(s.cameraBlockedCount*10,30)," pts"]})]})]}),s.phoneDetectionCount>0&&e.jsxs("div",{style:{padding:"0.75rem",background:"rgba(239, 68, 68, 0.1)",borderRadius:"0.5rem",display:"flex",alignItems:"center",gap:"0.75rem"},children:[e.jsx("span",{style:{fontSize:"1.1rem"},children:"ðŸ“±"}),e.jsxs("div",{children:[e.jsxs("div",{style:{fontWeight:600,color:"#ef4444"},children:[s.phoneDetectionCount," Phone Detected"]}),e.jsxs("div",{style:{fontSize:"0.75rem",color:"var(--text-muted)"},children:["Penalty: -",Math.min(s.phoneDetectionCount*15,45)," pts"]})]})]})]}),s.proctoringVideo&&e.jsxs("div",{style:{marginTop:"1rem",padding:"0.75rem",background:"rgba(59, 130, 246, 0.1)",borderRadius:"0.5rem",display:"flex",alignItems:"center",gap:"0.5rem"},children:[e.jsx("span",{style:{fontSize:"1rem"},children:"ðŸŽ¥"}),e.jsxs("span",{style:{fontSize:"0.85rem",color:"#3b82f6"},children:["Proctoring video recorded: ",s.proctoringVideo]})]})]}),e.jsxs("div",{style:{marginBottom:"1.5rem"},children:[e.jsxs("h4",{style:{margin:"0 0 0.75rem",display:"flex",alignItems:"center",gap:"0.5rem"},children:[e.jsx(J,{size:18,color:"#3b82f6"})," AI Feedback"]}),e.jsx("p",{style:{color:"var(--text-muted)",lineHeight:"1.6",background:"var(--bg-tertiary)",padding:"1rem",borderRadius:"0.5rem",border:"1px solid var(--border-color)"},children:s.feedback||"No feedback provided."})]}),s.aiExplanation&&e.jsxs("div",{style:{marginBottom:"1.5rem"},children:[e.jsxs("h4",{style:{margin:"0 0 0.75rem",display:"flex",alignItems:"center",gap:"0.5rem"},children:[e.jsx(re,{size:18,color:"#8b5cf6"})," AI Explanation (Why this score?)"]}),e.jsx("p",{style:{color:"var(--text-muted)",lineHeight:"1.6",background:"rgba(139, 92, 246, 0.05)",padding:"1rem",borderRadius:"0.5rem",border:"1px solid rgba(139, 92, 246, 0.1)"},children:s.aiExplanation})]}),s.analysis&&e.jsxs("div",{style:{marginBottom:"1.5rem"},children:[e.jsxs("h4",{style:{margin:"0 0 1rem",display:"flex",alignItems:"center",gap:"0.5rem"},children:[e.jsx(Le,{size:18,color:"var(--primary)"}),"Detailed Analysis"]}),e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"0.75rem"},children:[s.analysis.correctness!==void 0&&e.jsxs("div",{style:{background:"var(--bg-tertiary)",padding:"1rem 1.25rem",borderRadius:"0.75rem",display:"flex",alignItems:"center",gap:"1rem",border:"1px solid rgba(59, 130, 246, 0.2)"},children:[e.jsx("div",{style:{width:"42px",height:"42px",borderRadius:"10px",background:"rgba(59, 130, 246, 0.15)",display:"flex",alignItems:"center",justifyContent:"center",flexShrink:0},children:e.jsx(J,{size:22,color:"#3b82f6"})}),e.jsxs("div",{style:{flex:1},children:[e.jsx("span",{style:{color:"var(--text-muted)",fontSize:"0.8rem",display:"block",marginBottom:"0.25rem"},children:"Correctness"}),e.jsx("p",{style:{margin:0,fontWeight:700,fontSize:"1.1rem",color:"#3b82f6"},children:s.analysis.correctness})]})]}),s.analysis.efficiency!==void 0&&e.jsxs("div",{style:{background:"var(--bg-tertiary)",padding:"1rem 1.25rem",borderRadius:"0.75rem",display:"flex",alignItems:"center",gap:"1rem",border:"1px solid rgba(16, 185, 129, 0.2)"},children:[e.jsx("div",{style:{width:"42px",height:"42px",borderRadius:"10px",background:"rgba(16, 185, 129, 0.15)",display:"flex",alignItems:"center",justifyContent:"center",flexShrink:0},children:e.jsx(vt,{size:22,color:"#10b981"})}),e.jsxs("div",{style:{flex:1},children:[e.jsx("span",{style:{color:"var(--text-muted)",fontSize:"0.8rem",display:"block",marginBottom:"0.25rem"},children:"Efficiency"}),e.jsx("p",{style:{margin:0,fontWeight:700,fontSize:"1.1rem",color:"#10b981"},children:s.analysis.efficiency})]})]}),s.analysis.codeStyle!==void 0&&e.jsxs("div",{style:{background:"var(--bg-tertiary)",padding:"1rem 1.25rem",borderRadius:"0.75rem",display:"flex",alignItems:"center",gap:"1rem",border:"1px solid rgba(139, 92, 246, 0.2)"},children:[e.jsx("div",{style:{width:"42px",height:"42px",borderRadius:"10px",background:"rgba(139, 92, 246, 0.15)",display:"flex",alignItems:"center",justifyContent:"center",flexShrink:0},children:e.jsx(X,{size:22,color:"#8b5cf6"})}),e.jsxs("div",{style:{flex:1},children:[e.jsx("span",{style:{color:"var(--text-muted)",fontSize:"0.8rem",display:"block",marginBottom:"0.25rem"},children:"Code Style"}),e.jsx("p",{style:{margin:0,fontWeight:700,fontSize:"1.1rem",color:"#8b5cf6"},children:s.analysis.codeStyle})]})]}),s.analysis.bestPractices!==void 0&&e.jsxs("div",{style:{background:"var(--bg-tertiary)",padding:"1rem 1.25rem",borderRadius:"0.75rem",display:"flex",alignItems:"center",gap:"1rem",border:"1px solid rgba(245, 158, 11, 0.2)"},children:[e.jsx("div",{style:{width:"42px",height:"42px",borderRadius:"10px",background:"rgba(245, 158, 11, 0.15)",display:"flex",alignItems:"center",justifyContent:"center",flexShrink:0},children:e.jsx(St,{size:22,color:"#f59e0b"})}),e.jsxs("div",{style:{flex:1},children:[e.jsx("span",{style:{color:"var(--text-muted)",fontSize:"0.8rem",display:"block",marginBottom:"0.25rem"},children:"Best Practices"}),e.jsx("p",{style:{margin:0,fontWeight:700,fontSize:"1.1rem",color:"#f59e0b"},children:s.analysis.bestPractices})]})]})]})]}),e.jsxs("div",{children:[e.jsx("h4",{style:{margin:"0 0 0.75rem"},children:"Submitted Code"}),e.jsx("pre",{style:{background:"#020617",padding:"1.5rem",borderRadius:"0.5rem",overflow:"auto",maxHeight:"300px",fontSize:"0.85rem",fontFamily:"monospace",color:"#e2e8f0",border:"1px solid #334155"},children:s.code})]}),e.jsxs("div",{style:{marginTop:"1.5rem"},children:[e.jsx("h4",{style:{margin:"0 0 0.75rem"},children:"ðŸ’¬ Code Feedback"}),e.jsx($t,{submissionId:s.id,code:s.code,mentorId:s.mentorId,studentId:s.studentId})]})]})]})})}function Ft({user:s}){const{t:r}=He(),[T,C]=n.useState("plagiarism"),[g,L]=n.useState(null),[p,S]=n.useState(null),[N,k]=n.useState(null),[o,d]=n.useState(!0),[b,A]=n.useState(!1);n.useEffect(()=>{d(!0),Promise.all([z.get(`${R}/analytics/plagiarism?mentorId=${s.id}`),z.get(`${R}/analytics/time-to-solve?mentorId=${s.id}`),z.get(`${R}/analytics/topics?mentorId=${s.id}`)]).then(([i,y,a])=>{L(i.data),S(y.data),k(a.data),d(!1)}).catch(i=>{console.error(i),d(!1)})},[s.id]);const c=async i=>{A(!0);try{if(i==="csv"){const y=await z.get(`${R}/analytics/export/csv?mentorId=${s.id}`,{responseType:"blob"}),a=window.URL.createObjectURL(new Blob([y.data])),h=document.createElement("a");h.href=a,h.download=`analytics_${new Date().toISOString().split("T")[0]}.csv`,h.click()}else{const y=await z.get(`${R}/analytics/export/json?mentorId=${s.id}`),a=new Blob([JSON.stringify(y.data,null,2)],{type:"application/json"}),h=window.URL.createObjectURL(a),_=document.createElement("a");_.href=h,_.download=`analytics_${new Date().toISOString().split("T")[0]}.json`,_.click()}}catch(y){console.error(y)}A(!1)};if(o)return e.jsx("div",{className:"loading-spinner"});const v=[{id:"plagiarism",label:r("plagiarism_detection"),icon:e.jsx(We,{size:16})},{id:"time-to-solve",label:r("time_to_solve"),icon:e.jsx(ve,{size:16})},{id:"topics",label:r("topic_analysis"),icon:e.jsx(Ne,{size:16})},{id:"export",label:r("export_report"),icon:e.jsx(Ce,{size:16})}];return e.jsxs("div",{className:"animate-fadeIn",children:[e.jsx("div",{style:{display:"flex",gap:"0.5rem",marginBottom:"1.5rem",flexWrap:"wrap"},children:v.map(i=>e.jsxs("button",{onClick:()=>C(i.id),style:{display:"flex",alignItems:"center",gap:"0.5rem",padding:"0.6rem 1.2rem",borderRadius:"10px",border:"none",cursor:"pointer",fontWeight:600,fontSize:"0.85rem",background:T===i.id?"var(--primary)":"var(--card-bg)",color:T===i.id?"#fff":"var(--text-secondary)",boxShadow:T===i.id?"0 4px 15px rgba(59,130,246,0.3)":"0 1px 3px rgba(0,0,0,0.1)",transition:"all 0.2s"},children:[i.icon," ",i.label]},i.id))}),T==="plagiarism"&&g&&e.jsxs("div",{children:[e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(200px, 1fr))",gap:"1rem",marginBottom:"1.5rem"},children:[e.jsx("div",{className:"dashboard-stat-card stat-card-blue",children:e.jsxs("div",{className:"stat-card-inner",children:[e.jsx("div",{className:"stat-icon-box",style:{background:"linear-gradient(135deg, #1e40af, #3b82f6)"},children:e.jsx(Ie,{size:22,color:"#fff"})}),e.jsxs("div",{className:"stat-content",children:[e.jsx("div",{className:"stat-number",children:g.stats.totalSubmissions}),e.jsx("div",{className:"stat-label-text",children:r("total_submissions")})]})]})}),e.jsx("div",{className:"dashboard-stat-card",style:{borderLeft:"4px solid #ef4444"},children:e.jsxs("div",{className:"stat-card-inner",children:[e.jsx("div",{className:"stat-icon-box",style:{background:"linear-gradient(135deg, #b91c1c, #ef4444)"},children:e.jsx(te,{size:22,color:"#fff"})}),e.jsxs("div",{className:"stat-content",children:[e.jsx("div",{className:"stat-number",style:{color:"#ef4444"},children:g.stats.plagiarismCount}),e.jsx("div",{className:"stat-label-text",children:r("flagged")})]})]})}),e.jsx("div",{className:"dashboard-stat-card",style:{borderLeft:"4px solid #f59e0b"},children:e.jsxs("div",{className:"stat-card-inner",children:[e.jsx("div",{className:"stat-icon-box",style:{background:"linear-gradient(135deg, #b45309, #f59e0b)"},children:e.jsx(we,{size:22,color:"#fff"})}),e.jsxs("div",{className:"stat-content",children:[e.jsxs("div",{className:"stat-number",style:{color:"#f59e0b"},children:[g.stats.plagiarismRate,"%"]}),e.jsx("div",{className:"stat-label-text",children:r("plagiarism_rate")})]})]})})]}),g.repeatOffenders.length>0&&e.jsxs("div",{className:"dashboard-panel",style:{marginBottom:"1.5rem"},children:[e.jsxs("h3",{className:"panel-title",style:{color:"#ef4444"},children:[e.jsx(te,{size:18})," ",r("repeat_offenders")]}),e.jsx("div",{style:{display:"grid",gap:"0.5rem"},children:g.repeatOffenders.map((i,y)=>e.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",padding:"0.75rem",borderRadius:"10px",background:"rgba(239,68,68,0.05)",border:"1px solid rgba(239,68,68,0.15)"},children:[e.jsxs("div",{children:[e.jsx("div",{style:{fontWeight:600},children:i.name}),e.jsxs("div",{style:{fontSize:"0.75rem",color:"var(--text-muted)"},children:[r("copied_from"),": ",i.copiedFrom.join(", ")||"Unknown"]})]}),e.jsxs("span",{style:{background:"#ef4444",color:"#fff",padding:"0.25rem 0.75rem",borderRadius:"20px",fontWeight:700,fontSize:"0.8rem"},children:[i.count,"x"]})]},y))})]}),g.byProblem.length>0&&e.jsxs("div",{className:"dashboard-panel",style:{marginBottom:"1.5rem"},children:[e.jsxs("h3",{className:"panel-title",children:[e.jsx(ke,{size:18,color:"#f59e0b"})," ",r("most_copied_problems")]}),e.jsx("div",{style:{display:"grid",gap:"0.5rem"},children:g.byProblem.map((i,y)=>e.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",padding:"0.75rem",borderRadius:"8px",background:"var(--bg-secondary)"},children:[e.jsxs("div",{children:[e.jsx("div",{style:{fontWeight:600},children:i.title}),e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--text-muted)",textTransform:"capitalize"},children:i.difficulty})]}),e.jsxs("span",{style:{fontWeight:700,color:"#ef4444"},children:[i.flaggedCount," ",r("flags")]})]},y))})]}),e.jsxs("div",{className:"dashboard-panel",children:[e.jsxs("h3",{className:"panel-title",children:[e.jsx(We,{size:18,color:"#ef4444"})," ",r("flagged_submissions")]}),g.flaggedSubmissions.length>0?e.jsx("div",{style:{overflowX:"auto"},children:e.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:"0.8rem"},children:[e.jsx("thead",{children:e.jsxs("tr",{style:{borderBottom:"2px solid var(--border-color)"},children:[e.jsx("th",{style:{textAlign:"left",padding:"0.6rem"},children:r("student")}),e.jsx("th",{style:{textAlign:"left",padding:"0.6rem"},children:r("problem")}),e.jsx("th",{style:{textAlign:"center",padding:"0.6rem"},children:r("score")}),e.jsx("th",{style:{textAlign:"left",padding:"0.6rem"},children:r("copied_from")}),e.jsx("th",{style:{textAlign:"right",padding:"0.6rem"},children:r("date")})]})}),e.jsx("tbody",{children:g.flaggedSubmissions.slice(0,20).map((i,y)=>e.jsxs("tr",{style:{borderBottom:"1px solid var(--border-color)"},children:[e.jsx("td",{style:{padding:"0.6rem",fontWeight:600},children:i.studentName}),e.jsx("td",{style:{padding:"0.6rem"},children:i.problemTitle}),e.jsxs("td",{style:{padding:"0.6rem",textAlign:"center"},children:[i.score,"/100"]}),e.jsx("td",{style:{padding:"0.6rem",color:"#ef4444"},children:i.copiedFromName||i.copiedFrom}),e.jsx("td",{style:{padding:"0.6rem",textAlign:"right",fontSize:"0.75rem",color:"var(--text-muted)"},children:new Date(i.submittedAt).toLocaleDateString()})]},y))})]})}):e.jsx("div",{style:{textAlign:"center",color:"var(--text-muted)",padding:"2rem"},children:r("no_plagiarism_detected")})]})]}),T==="time-to-solve"&&p&&e.jsxs("div",{children:[e.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(220px, 1fr))",gap:"1rem",marginBottom:"1.5rem"},children:p.difficultySummary.map((i,y)=>{const h={easy:"#10b981",medium:"#f59e0b",hard:"#ef4444"}[i.difficulty]||"#3b82f6";return e.jsxs("div",{style:{padding:"1.25rem",borderRadius:"14px",background:"var(--card-bg)",borderLeft:`4px solid ${h}`,boxShadow:"0 2px 8px rgba(0,0,0,0.08)"},children:[e.jsx("div",{style:{fontWeight:700,fontSize:"1rem",textTransform:"capitalize",color:h,marginBottom:"0.75rem"},children:i.difficulty}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"0.75rem"},children:[e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:"0.65rem",color:"var(--text-muted)",textTransform:"uppercase"},children:r("avg_time")}),e.jsxs("div",{style:{fontSize:"1.3rem",fontWeight:800},children:[i.avgTimeMinutes,"m"]})]}),e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:"0.65rem",color:"var(--text-muted)",textTransform:"uppercase"},children:r("avg_attempts")}),e.jsx("div",{style:{fontSize:"1.3rem",fontWeight:800},children:i.avgAttempts})]}),e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:"0.65rem",color:"var(--text-muted)",textTransform:"uppercase"},children:r("solve_rate")}),e.jsxs("div",{style:{fontSize:"1.3rem",fontWeight:800,color:h},children:[i.avgSolveRate,"%"]})]}),e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:"0.65rem",color:"var(--text-muted)",textTransform:"uppercase"},children:r("problems")}),e.jsx("div",{style:{fontSize:"1.3rem",fontWeight:800},children:i.problems})]})]})]},y)})}),e.jsxs("div",{className:"dashboard-panel",children:[e.jsxs("h3",{className:"panel-title",children:[e.jsx(ve,{size:18,color:"#3b82f6"})," ",r("problem_difficulty_metrics")]}),e.jsx("div",{style:{overflowX:"auto"},children:e.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:"0.8rem"},children:[e.jsx("thead",{children:e.jsxs("tr",{style:{borderBottom:"2px solid var(--border-color)"},children:[e.jsx("th",{style:{textAlign:"left",padding:"0.6rem"},children:r("problem")}),e.jsx("th",{style:{textAlign:"center",padding:"0.6rem"},children:r("difficulty")}),e.jsx("th",{style:{textAlign:"center",padding:"0.6rem"},children:r("students")}),e.jsx("th",{style:{textAlign:"center",padding:"0.6rem"},children:r("avg_attempts")}),e.jsx("th",{style:{textAlign:"center",padding:"0.6rem"},children:r("avg_time")}),e.jsx("th",{style:{textAlign:"center",padding:"0.6rem"},children:r("solve_rate")})]})}),e.jsx("tbody",{children:p.problems.slice(0,30).map((i,y)=>e.jsxs("tr",{style:{borderBottom:"1px solid var(--border-color)"},children:[e.jsx("td",{style:{padding:"0.6rem",fontWeight:600},children:i.title}),e.jsx("td",{style:{padding:"0.6rem",textAlign:"center"},children:e.jsx("span",{style:{padding:"0.15rem 0.5rem",borderRadius:"6px",fontSize:"0.7rem",fontWeight:600,background:i.difficulty==="easy"?"rgba(16,185,129,0.12)":i.difficulty==="medium"?"rgba(251,191,36,0.12)":"rgba(239,68,68,0.12)",color:i.difficulty==="easy"?"#10b981":i.difficulty==="medium"?"#f59e0b":"#ef4444"},children:i.difficulty})}),e.jsx("td",{style:{padding:"0.6rem",textAlign:"center"},children:i.studentCount}),e.jsx("td",{style:{padding:"0.6rem",textAlign:"center",fontWeight:600},children:i.avgAttempts}),e.jsx("td",{style:{padding:"0.6rem",textAlign:"center"},children:i.avgTimeMinutes?`${i.avgTimeMinutes}m`:"-"}),e.jsx("td",{style:{padding:"0.6rem",textAlign:"center"},children:e.jsxs("span",{style:{fontWeight:700,color:i.solveRate>=70?"#10b981":i.solveRate>=40?"#f59e0b":"#ef4444"},children:[i.solveRate,"%"]})})]},y))})]})})]})]}),T==="topics"&&N&&e.jsxs("div",{children:[e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"1.5rem",marginBottom:"1.5rem"},children:[e.jsxs("div",{className:"dashboard-panel",children:[e.jsxs("h3",{className:"panel-title",children:[e.jsx(Ne,{size:18,color:"#3b82f6"})," ",r("by_problem_type")]}),N.byType.map((i,y)=>e.jsxs("div",{style:{marginBottom:"1rem"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:"4px"},children:[e.jsx("span",{style:{fontWeight:600,textTransform:"capitalize"},children:i.type}),e.jsxs("span",{style:{fontWeight:700,color:i.avgScore>=70?"#10b981":"#f59e0b"},children:[i.avgScore,"% avg"]})]}),e.jsx("div",{style:{height:"8px",borderRadius:"4px",background:"rgba(0,0,0,0.08)",overflow:"hidden"},children:e.jsx("div",{style:{height:"100%",width:`${i.passRate}%`,borderRadius:"4px",background:"linear-gradient(90deg, #3b82f6, #60a5fa)",transition:"width 0.5s"}})}),e.jsxs("div",{style:{fontSize:"0.7rem",color:"var(--text-muted)",marginTop:"2px"},children:[i.submissions," submissions â€¢ ",i.passRate,"% pass â€¢ ",i.uniqueStudents," students"]})]},y))]}),e.jsxs("div",{className:"dashboard-panel",children:[e.jsxs("h3",{className:"panel-title",children:[e.jsx(we,{size:18,color:"#f59e0b"})," ",r("by_difficulty")]}),N.byDifficulty.map((i,y)=>{const a={easy:"#10b981",medium:"#f59e0b",hard:"#ef4444"};return e.jsxs("div",{style:{marginBottom:"1rem"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:"4px"},children:[e.jsx("span",{style:{fontWeight:600,textTransform:"capitalize",color:a[i.difficulty]},children:i.difficulty}),e.jsxs("span",{style:{fontWeight:700},children:[i.avgScore,"%"]})]}),e.jsx("div",{style:{height:"8px",borderRadius:"4px",background:"rgba(0,0,0,0.08)",overflow:"hidden"},children:e.jsx("div",{style:{height:"100%",width:`${i.passRate}%`,borderRadius:"4px",background:a[i.difficulty],transition:"width 0.5s"}})}),e.jsxs("div",{style:{fontSize:"0.7rem",color:"var(--text-muted)",marginTop:"2px"},children:[i.submissions," submissions â€¢ ",i.passRate,"% pass"]})]},y)})]})]}),e.jsxs("div",{className:"dashboard-panel",style:{marginBottom:"1.5rem"},children:[e.jsxs("h3",{className:"panel-title",children:[e.jsx(X,{size:18,color:"#8b5cf6"})," ",r("performance_by_language")]}),e.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(180px, 1fr))",gap:"1rem"},children:N.byLanguage.map((i,y)=>e.jsxs("div",{style:{padding:"1rem",borderRadius:"12px",background:"var(--bg-secondary)",textAlign:"center",border:"1px solid var(--border-color)"},children:[e.jsx("div",{style:{fontWeight:700,fontSize:"1.1rem"},children:i.language}),e.jsxs("div",{style:{fontSize:"2rem",fontWeight:800,color:i.avgScore>=70?"#10b981":i.avgScore>=40?"#f59e0b":"#ef4444"},children:[i.avgScore,"%"]}),e.jsxs("div",{style:{fontSize:"0.75rem",color:"var(--text-muted)"},children:[i.submissions," subs â€¢ ",i.passRate,"% pass"]})]},y))})]}),N.heatmap.length>0&&e.jsxs("div",{className:"dashboard-panel",children:[e.jsxs("h3",{className:"panel-title",children:[e.jsx(Le,{size:18,color:"#06b6d4"})," ",r("type_difficulty_heatmap")]}),e.jsx("div",{style:{overflowX:"auto"},children:e.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:"0.8rem"},children:[e.jsx("thead",{children:e.jsxs("tr",{style:{borderBottom:"2px solid var(--border-color)"},children:[e.jsx("th",{style:{padding:"0.6rem",textAlign:"left"},children:r("type")}),e.jsx("th",{style:{padding:"0.6rem",textAlign:"center"},children:r("difficulty")}),e.jsx("th",{style:{padding:"0.6rem",textAlign:"center"},children:r("submissions")}),e.jsx("th",{style:{padding:"0.6rem",textAlign:"center"},children:r("avg_score")}),e.jsx("th",{style:{padding:"0.6rem",textAlign:"center"},children:r("pass_rate")})]})}),e.jsx("tbody",{children:N.heatmap.map((i,y)=>e.jsxs("tr",{style:{borderBottom:"1px solid var(--border-color)"},children:[e.jsx("td",{style:{padding:"0.6rem",fontWeight:600,textTransform:"capitalize"},children:i.type}),e.jsx("td",{style:{padding:"0.6rem",textAlign:"center",textTransform:"capitalize"},children:i.difficulty}),e.jsx("td",{style:{padding:"0.6rem",textAlign:"center"},children:i.submissions}),e.jsxs("td",{style:{padding:"0.6rem",textAlign:"center",fontWeight:700,color:i.avgScore>=70?"#10b981":i.avgScore>=40?"#f59e0b":"#ef4444"},children:[i.avgScore,"%"]}),e.jsxs("td",{style:{padding:"0.6rem",textAlign:"center"},children:[i.passRate,"%"]})]},y))})]})})]})]}),T==="export"&&e.jsx("div",{children:e.jsxs("div",{className:"dashboard-panel",style:{textAlign:"center",padding:"3rem 2rem"},children:[e.jsx(Ce,{size:48,color:"var(--primary)",style:{marginBottom:"1rem"}}),e.jsx("h3",{style:{margin:"0 0 0.5rem",fontSize:"1.3rem"},children:r("export_analytics")}),e.jsx("p",{style:{color:"var(--text-muted)",marginBottom:"2rem",maxWidth:"500px",margin:"0 auto 2rem"},children:r("export_description")}),e.jsxs("div",{style:{display:"flex",gap:"1rem",justifyContent:"center",flexWrap:"wrap"},children:[e.jsxs("button",{onClick:()=>c("csv"),disabled:b,style:{padding:"0.75rem 2rem",borderRadius:"12px",border:"none",cursor:"pointer",background:"linear-gradient(135deg, #059669, #10b981)",color:"#fff",fontWeight:700,fontSize:"0.9rem",opacity:b?.6:1,display:"flex",alignItems:"center",gap:"0.5rem"},children:[e.jsx(ue,{size:18})," ",r("download_csv")]}),e.jsxs("button",{onClick:()=>c("json"),disabled:b,style:{padding:"0.75rem 2rem",borderRadius:"12px",border:"none",cursor:"pointer",background:"linear-gradient(135deg, #1e40af, #3b82f6)",color:"#fff",fontWeight:700,fontSize:"0.9rem",opacity:b?.6:1,display:"flex",alignItems:"center",gap:"0.5rem"},children:[e.jsx(X,{size:18})," ",r("download_json")]})]})]})})]})}function Re({testType:s,user:r}){const[T,C]=n.useState([]),[g,L]=n.useState(!0),[p,S]=n.useState([]),[N,k]=n.useState(!1),[o,d]=n.useState([]),[b,A]=n.useState(null),[c,v]=n.useState("");n.useEffect(()=>{(async()=>{try{const I=s==="aptitude"?"/aptitude":s==="global"?"/global-tests":s==="skill"?"/skill-tests":"/aptitude",x=await z.get(`${R}${I}?status=live`);C(Array.isArray(x.data)?x.data:[])}catch(I){console.error(I),C([])}finally{L(!1)}})()},[s]);const i=async()=>{try{const m=await z.get(`${R}/mentors/${r.id}/students`);S(Array.isArray(m.data)?m.data:[])}catch(m){console.error("Error fetching students:",m)}},y=async m=>{await i(),A(m);try{const I=await z.get(`${R}/tests/${m}/allocated-students`);d(I.data.studentIds||[])}catch(I){console.error("Error loading allocations:",I),d([])}k(!0)},a=m=>{d(I=>I.includes(m)?I.filter(x=>x!==m):[...I,m])},h=async()=>{try{await z.post(`${R}/tests/${b}/allocate-students`,{studentIds:o}),alert("Students allocated successfully!"),k(!1),d([]),A(null)}catch(m){alert("Error saving allocations: "+(m.response?.data?.error||m.message))}};if(g)return e.jsx("div",{className:"loading-spinner"});const _=s==="aptitude"?"Aptitude Tests":s==="global"?"Global Tests":s==="skill"?"Skill Tests":"Tests";return e.jsxs("div",{children:[e.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(350px, 1fr))",gap:"1.5rem"},children:T.length===0?e.jsxs("div",{style:{textAlign:"center",padding:"2rem",color:"var(--text-muted)",gridColumn:"1 / -1"},children:["No ",_," found"]}):T.map(m=>e.jsxs("div",{style:{background:"var(--bg-secondary)",border:"1px solid var(--border-color)",borderRadius:"12px",padding:"1.5rem",display:"flex",flexDirection:"column"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:"0.75rem"},children:[e.jsx("span",{style:{fontSize:"0.65rem",padding:"3px 8px",borderRadius:"4px",background:"rgba(59, 130, 246, 0.15)",color:"#60a5fa",fontWeight:700},children:_.toUpperCase()}),e.jsx("span",{style:{fontSize:"0.65rem",padding:"3px 8px",borderRadius:"4px",background:m.status==="live"?"rgba(16, 185, 129, 0.15)":"rgba(239, 68, 68, 0.15)",color:m.status==="live"?"#10b981":"#ef4444",fontWeight:700},children:m.status==="live"?"LIVE":"ENDED"})]}),e.jsx("h3",{style:{margin:"0.5rem 0",fontSize:"1.1rem"},children:m.title}),e.jsx("p",{style:{fontSize:"0.85rem",color:"var(--text-muted)",marginBottom:"1rem",display:"-webkit-box",WebkitLineClamp:2,WebkitBoxOrient:"vertical",overflow:"hidden"},children:m.description||"No description"}),e.jsx("div",{style:{marginTop:"auto",paddingTop:"1rem",borderTop:"1px solid rgba(255,255,255,0.05)"},children:e.jsx("button",{onClick:()=>y(m.id),style:{width:"100%",padding:"0.75rem",background:"rgba(168, 85, 247, 0.1)",border:"1px solid rgba(168, 85, 247, 0.3)",color:"#d8b4fe",borderRadius:"8px",cursor:"pointer",fontWeight:600,fontSize:"0.9rem"},children:"ðŸ‘¥ Assign Students"})})]},m.id))}),N&&e.jsx("div",{className:"modal-overlay",onClick:()=>{k(!1),v("")},children:e.jsxs("div",{className:"modal-content",onClick:m=>m.stopPropagation(),style:{maxWidth:"750px",maxHeight:"85vh",overflow:"hidden",display:"flex",flexDirection:"column"},children:[e.jsxs("div",{className:"modal-header",style:{padding:"1.5rem",borderBottom:"1px solid var(--border-color)"},children:[e.jsxs("div",{className:"modal-title-with-icon",children:[e.jsx("div",{style:{width:"40px",height:"40px",borderRadius:"10px",background:"linear-gradient(135deg, #8b5cf6, #6366f1)",display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsx(K,{size:20,color:"white"})}),e.jsxs("div",{style:{textAlign:"left"},children:[e.jsx("h2",{style:{margin:0,fontSize:"1.25rem"},children:"Assign Students"}),e.jsx("p",{style:{margin:0,fontSize:"0.8rem",color:"var(--text-muted)"},children:"Select students for this test"})]})]}),e.jsx("button",{onClick:()=>{k(!1),v("")},className:"modal-close",children:e.jsx(oe,{size:20})})]}),e.jsxs("div",{style:{padding:"1rem 1.5rem",background:"var(--bg-secondary)",borderBottom:"1px solid var(--border-color)",display:"flex",gap:"1rem",alignItems:"center"},children:[e.jsxs("div",{style:{position:"relative",flex:1},children:[e.jsx(be,{size:18,style:{position:"absolute",left:"12px",top:"50%",transform:"translateY(-50%)",color:"var(--text-muted)"}}),e.jsx("input",{type:"text",placeholder:"Search by name or batch...",value:c,onChange:m=>v(m.target.value),style:{width:"100%",padding:"0.7rem 1rem 0.7rem 2.5rem",borderRadius:"10px",background:"var(--bg-card)",border:"1px solid var(--border-color)",color:"var(--text-main)",fontSize:"0.9rem"}})]}),e.jsx("button",{onClick:()=>{const m=p.filter(x=>(x.name||x.username||"").toLowerCase().includes(c.toLowerCase())||(x.batch||"").toLowerCase().includes(c.toLowerCase())),I=m.every(x=>o.includes(x.id));d(I?x=>x.filter(W=>!m.map(P=>P.id).includes(W)):x=>[...new Set([...x,...m.map(W=>W.id)])])},style:{padding:"0.7rem 1.2rem",borderRadius:"10px",background:"var(--bg-card)",border:"1px solid var(--border-color)",color:"var(--text-main)",fontSize:"0.85rem",fontWeight:600,cursor:"pointer",whiteSpace:"nowrap"},children:p.filter(m=>(m.name||m.username||"").toLowerCase().includes(c.toLowerCase())||(m.batch||"").toLowerCase().includes(c.toLowerCase())).every(m=>o.includes(m.id))?"Deselect All":"Select All"})]}),e.jsx("div",{className:"modal-body",style:{overflowY:"auto",padding:"1.5rem",background:"var(--bg-primary)"},children:e.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(280px, 1fr))",gap:"1rem"},children:p.filter(m=>(m.name||m.username||"").toLowerCase().includes(c.toLowerCase())||(m.batch||"").toLowerCase().includes(c.toLowerCase())).length===0?e.jsxs("div",{style:{gridColumn:"1 / -1",textAlign:"center",padding:"3rem",opacity:.5},children:[e.jsx(K,{size:48,style:{marginBottom:"1rem",opacity:.2}}),e.jsx("p",{children:"No students found matching your search."})]}):p.filter(m=>(m.name||m.username||"").toLowerCase().includes(c.toLowerCase())||(m.batch||"").toLowerCase().includes(c.toLowerCase())).map(m=>e.jsxs("div",{onClick:()=>a(m.id),style:{padding:"1rem",borderRadius:"1rem",background:o.includes(m.id)?"var(--primary-alpha)":"var(--bg-card)",border:`1.5px solid ${o.includes(m.id)?"var(--primary)":"var(--border-color)"}`,cursor:"pointer",display:"flex",alignItems:"center",gap:"1rem",transition:"all 0.2s",boxShadow:o.includes(m.id)?"0 4px 12px var(--primary-alpha)":"none",textAlign:"left"},children:[e.jsx("div",{style:{width:"40px",height:"40px",borderRadius:"50%",background:o.includes(m.id)?"var(--primary)":"var(--bg-secondary)",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"1rem",fontWeight:700,color:"white"},children:(m.name||m.username||"S").charAt(0).toUpperCase()}),e.jsxs("div",{style:{flex:1,minWidth:0},children:[e.jsx("div",{style:{fontWeight:600,fontSize:"0.95rem",color:"var(--text-main)",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:m.name||m.username}),e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--text-muted)",display:"flex",alignItems:"center",gap:"4px",marginTop:"4px"},children:e.jsx("span",{style:{padding:"2px 6px",borderRadius:"4px",background:"var(--bg-secondary)",border:"1px solid var(--border-color)"},children:m.batch||"No Batch"})})]}),o.includes(m.id)&&e.jsx(J,{size:18,color:"var(--primary)"})]},m.id))})}),e.jsxs("div",{className:"modal-footer",style:{padding:"1.2rem 1.5rem",borderTop:"1px solid var(--border-color)",display:"flex",justifyContent:"space-between",alignItems:"center",background:"var(--bg-secondary)"},children:[e.jsxs("div",{style:{fontSize:"0.95rem",color:"var(--text-main)",fontWeight:500},children:[e.jsx("span",{style:{color:"var(--primary)",fontWeight:800,fontSize:"1.1rem"},children:o.length})," students selected"]}),e.jsxs("div",{style:{display:"flex",gap:"1rem"},children:[e.jsx("button",{className:"btn-reset",onClick:()=>{k(!1),v("")},children:"Cancel"}),e.jsx("button",{className:"btn-create-new",onClick:h,style:{background:"var(--primary)",padding:"0.7rem 2rem",borderRadius:"10px",boxShadow:"0 4px 15px var(--primary-alpha)"},children:"Confirm Assignment"})]})]})]})})]})}function Ut({user:s}){return e.jsx(Re,{testType:"aptitude",user:s})}function Qt({user:s}){return e.jsx(Re,{testType:"global",user:s})}function qt({user:s}){return e.jsx(Re,{testType:"skill",user:s})}const Ot="http://localhost:3000";function Vt({user:s}){const[r,T]=n.useState([]),[C,g]=n.useState(null),[L,p]=n.useState(!0),[S,N]=n.useState(""),k=localStorage.getItem("authToken");if(n.useEffect(()=>{z.get(`${Ot}/api/submissions?mentorId=${s?.id}&limit=100`,{headers:{Authorization:`Bearer ${k}`}}).then(d=>{const b=Array.isArray(d.data)?d.data:d.data?.data||[];T(b)}).catch(()=>T([])).finally(()=>p(!1))},[s]),C)return e.jsxs("div",{style:{maxWidth:1100,margin:"0 auto"},children:[e.jsx("button",{onClick:()=>g(null),style:{marginBottom:16,padding:"7px 16px",cursor:"pointer",background:"var(--primary, #6366f1)",color:"#fff",border:"none",borderRadius:8,fontWeight:600,fontSize:"0.85rem",display:"flex",alignItems:"center",gap:6},children:"â† Back to submissions"}),e.jsx(nt,{submissionId:C.id,submission:C})]});if(L)return e.jsx("div",{style:{padding:40,textAlign:"center"},children:"Loading submissionsâ€¦"});const o=r.filter(d=>(d.itemTitle||"").toLowerCase().includes(S.toLowerCase())||(d.studentName||"").toLowerCase().includes(S.toLowerCase()));return r.length?e.jsxs("div",{style:{maxWidth:860,margin:"0 auto"},children:[e.jsxs("div",{style:{marginBottom:16,position:"relative"},children:[e.jsx(be,{size:16,style:{position:"absolute",left:12,top:"50%",transform:"translateY(-50%)",opacity:.4}}),e.jsx("input",{type:"text",placeholder:"Search by problem or student nameâ€¦",value:S,onChange:d=>N(d.target.value),style:{width:"100%",padding:"9px 12px 9px 36px",borderRadius:8,border:"1px solid var(--border-color, #334155)",background:"var(--bg-secondary, #1e293b)",color:"inherit",fontSize:"0.9rem",boxSizing:"border-box",outline:"none"}})]}),e.jsxs("p",{style:{marginBottom:12,opacity:.55,fontSize:"0.85rem"},children:[o.length," submission",o.length!==1?"s":""," â€” click one to open the code and add a review"]}),o.map(d=>{const b=d.status==="accepted"?"#4ade80":d.status==="rejected"?"#f87171":"#94a3b8",A=d.status==="accepted"?"rgba(34,197,94,0.12)":d.status==="rejected"?"rgba(239,68,68,0.12)":"rgba(148,163,184,0.12)";return e.jsxs("div",{onClick:()=>g(d),style:{padding:"13px 16px",marginBottom:8,borderRadius:10,background:"var(--card-bg, #1e293b)",border:"1px solid var(--border-color, #334155)",cursor:"pointer",display:"flex",alignItems:"center",gap:14,transition:"border-color 0.15s"},onMouseEnter:c=>c.currentTarget.style.borderColor="#6366f1",onMouseLeave:c=>c.currentTarget.style.borderColor="var(--border-color, #334155)",children:[e.jsx("div",{style:{width:38,height:38,borderRadius:"50%",background:"linear-gradient(135deg,#6366f1,#8b5cf6)",display:"flex",alignItems:"center",justifyContent:"center",color:"#fff",fontWeight:700,fontSize:"1rem",flexShrink:0},children:(d.studentName||"S")[0].toUpperCase()}),e.jsxs("div",{style:{flex:1,minWidth:0},children:[e.jsx("div",{style:{fontWeight:600,fontSize:"0.95rem",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:d.itemTitle||`Submission #${d.id}`}),e.jsxs("div",{style:{fontSize:"0.8rem",opacity:.6,marginTop:2},children:[d.studentName||"Student"," Â· ",d.language||"Code"," Â· ",new Date(d.submittedAt).toLocaleDateString()]})]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8,flexShrink:0},children:[d.score!=null&&e.jsxs("span",{style:{fontSize:"0.8rem",fontWeight:700,color:"#fbbf24"},children:[d.score,"%"]}),e.jsx("span",{style:{fontSize:"0.72rem",padding:"2px 9px",borderRadius:20,background:A,color:b,fontWeight:600},children:(d.status||"unknown").toUpperCase()}),e.jsx(jt,{size:16,style:{opacity:.4}})]})]},d.id)})]}):e.jsxs("div",{style:{padding:40,textAlign:"center",opacity:.7},children:[e.jsx(X,{size:48,style:{marginBottom:12}}),e.jsx("p",{children:"No submissions to review yet."})]})}export{es as default};
